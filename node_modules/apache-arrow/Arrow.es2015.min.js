// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['exports'], factory) :
    (factory(global.Arrow = global.Arrow || {}));
}(this, (function (exports) {var h;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ca(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var da=ca(this);function ea(a,b){if(b)a:{var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ba(c,a,{configurable:!0,writable:!0,value:b})}}
ea("Symbol",function(a){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(f||"")+"_"+e++,f)}function c(f,g){this.Gb=f;ba(this,"description",{configurable:!0,writable:!0,value:g})}if(a)return a;c.prototype.toString=function(){return this.Gb};var d="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",e=0;return b});
ea("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=da[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&ba(d.prototype,a,{configurable:!0,writable:!0,value:function(){return fa(aa(this))}})}return a});ea("Symbol.asyncIterator",function(a){return a?a:Symbol("Symbol.asyncIterator")});
function fa(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}function ha(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function f(g){g.done?d(g.value):Promise.resolve(g.value).then(b,c).then(f,e)}f(a.next())})}function l(a){return ha(a())}
function ia(a){var b=a[Symbol.asyncIterator];if(void 0!==b)a=b.call(a);else{b=ja;var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(c)a=c.call(a);else if("number"==typeof a.length)a={next:aa(a)};else throw Error(String(a)+" is not an iterable or ArrayLike");a=new b(a)}return a}
function ja(a){this[Symbol.asyncIterator]=function(){return this};this[Symbol.iterator]=function(){return a};this.next=function(b){return Promise.resolve(a.next(b))};void 0!==a["throw"]&&(this["throw"]=function(b){return Promise.resolve(a["throw"](b))});void 0!==a["return"]&&(this["return"]=function(b){return Promise.resolve(a["return"](b))})}function n(a,b){this.action=a;this.value=b}function ka(a,b,c,d){this.method=a;this.ca=b;this.resolve=c;this.reject=d}
function la(a){this.frame=a;this.next=null}function ma(){this.La=this.T=null}ma.prototype.first=function(){if(this.T)return this.T.frame;throw Error("no frames in executionQueue");};function na(a){a.T&&(a.T=a.T.next,a.T||(a.La=null))}ma.prototype.enqueue=function(a){a=new la(a);this.La?this.La.next=a:this.T=a;this.La=a};
function oa(a){this.Ab=a;this.P=null;this.J=new ma;this[Symbol.asyncIterator]=function(){return this};var b=this;this.Tb=function(c){var d=b.J.first();!0===c.done?(b.P=null,d.method="next",d.ca=c.value):(d.resolve({value:c.value,done:!1}),na(b.J));pa(b)};this.Sb=function(c){ra(b,c)};this.Ya=function(c){sa(b,c)}}function ta(a,b,c){return new Promise(function(d,e){var f=null===a.J.T;a.J.enqueue(new ka(b,c,d,e));f&&pa(a)})}oa.prototype.next=function(a){return ta(this,"next",a)};
oa.prototype.return=function(a){return ta(this,"return",new n(0,a))};oa.prototype.throw=function(a){return ta(this,"throw",a)};function pa(a){if(null!==a.J.T)try{if(a.P){if(!a.P)throw Error("no delegate to perform execution");var b=a.J.first();if(b.method in a.P)try{a.P[b.method](b.ca).then(a.Tb,a.Sb).catch(a.Ya)}catch(c){ra(a,c)}else a.P=null,pa(a)}else ua(a)}catch(c){sa(a,c)}}
function ua(a){var b=a.J.first();try{var c=a.Ab[b.method](b.ca);if(c.value instanceof n)switch(c.value.action){case 0:Promise.resolve(c.value.value).then(function(d){b.resolve({value:d,done:c.done});na(a.J);pa(a)},function(d){b.reject(d);na(a.J);pa(a)}).catch(a.Ya);break;case 1:a.P=ia(c.value.value);b.method="next";b.ca=void 0;pa(a);break;case 2:Promise.resolve(c.value.value).then(function(d){b.method="next";b.ca=d;pa(a)},function(d){b.method="throw";b.ca=d;pa(a)}).catch(a.Ya);break;default:throw Error("Unrecognized AsyncGeneratorWrapper$ActionEnum");
}else b.resolve(c),na(a.J),pa(a)}catch(d){b.reject(d),na(a.J),pa(a)}}function ra(a,b){var c=a.J.first();a.P=null;c.method="throw";c.ca=b;pa(a)}function sa(a,b){null!==a.J.T&&(a.J.first().reject(b),na(a.J));a.P&&"return"in a.P&&(a.P["return"](void 0),a.P=null);a.Ab["return"](void 0);pa(a)}const va=new TextDecoder("utf-8"),wa=a=>va.decode(a),xa=new TextEncoder;const q=a=>"function"===typeof a,t=a=>null!=a&&Object(a)===a,ya=a=>"_getDOMStream"in a&&"_getNodeStream"in a,za=a=>t(a)&&q(a.cancel)&&q(a.getReader)&&!ya(a),Aa=a=>t(a)&&q(a.read)&&q(a.pipe)&&"boolean"===typeof a.readable&&!ya(a);const Ba="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function Ca(a){const b=a[0]?[a[0]]:[];let c,d,e,f;for(let g,k,m=0,p=0,r=a.length;++m<r;)g=b[p],k=a[m],!g||!k||g.buffer!==k.buffer||k.byteOffset<g.byteOffset?k&&(b[++p]=k):({byteOffset:c,byteLength:e}=g,{byteOffset:d,byteLength:f}=k,c+e<d||d+f<c?k&&(b[++p]=k):b[p]=new Uint8Array(g.buffer,c,d-c+f));return b}
function Da(a,b,c=0,d=b.byteLength){const e=a.byteLength,f=new Uint8Array(a.buffer,a.byteOffset,e);b=new Uint8Array(b.buffer,b.byteOffset,Math.min(d,e));f.set(b,c);return a}
function Ea(a,b){a=Ca(a);const c=a.reduce((m,p)=>m+p.byteLength,0);let d,e,f=0,g=-1;const k=Math.min(b||Number.POSITIVE_INFINITY,c);for(const m=a.length;++g<m;){b=a[g];d=b.subarray(0,Math.min(b.length,k-f));if(k<=f+d.length){d.length<b.length?a[g]=b.subarray(d.length):d.length===b.length&&g++;e?Da(e,d,f):e=d;break}Da(e||(e=new Uint8Array(k)),d,f);f+=d.length}return[e||new Uint8Array(0),a.slice(g),c-(e?e.byteLength:0)]}
function u(a,b){b=t(b)&&"done"in b&&"value"in b?b.value:b;if(b instanceof a)return a===Uint8Array?new a(b.buffer,b.byteOffset,b.byteLength):b;if(!b)return new a(0);"string"===typeof b&&(b=xa.encode(b));return b instanceof ArrayBuffer||b instanceof Ba?new a(b):t(b)&&q(b.clear)&&q(b.bytes)&&q(b.position)&&q(b.setPosition)&&q(b.capacity)&&q(b.getBufferIdentifier)&&q(b.createLong)?u(a,b.S()):ArrayBuffer.isView(b)?0>=b.byteLength?new a(0):new a(b.buffer,b.byteOffset,b.byteLength/a.BYTES_PER_ELEMENT):a.from(b)}
const Fa=a=>{a.next();return a};function*Ga(a,b){function*c(d){yield d}b="string"===typeof b?c(b):ArrayBuffer.isView(b)?c(b):b instanceof ArrayBuffer?c(b):b instanceof Ba?c(b):t(b)&&q(b[Symbol.iterator])?b:c(b);yield*Fa(function*(d){let e=null;do e=d.next(yield u(a,e));while(!e.done)}(b[Symbol.iterator]()));return new a}
function Ha(a,b){return new oa(function*(){function c(f){return new oa(function*(){yield new n(1,Fa(function*(g){let k=null;do{let m;k=g.next(yield null==(m=k)?void 0:m.value)}while(!k.done)}(f[Symbol.iterator]())))}())}function d(f){return new oa(function*(){yield new n(0,yield new n(2,f))}())}if(t(b)&&q(b.then))return new n(0,yield new n(1,Ha(a,yield new n(2,b))));const e="string"===typeof b?d(b):ArrayBuffer.isView(b)?d(b):b instanceof ArrayBuffer?d(b):b instanceof Ba?d(b):t(b)&&q(b[Symbol.iterator])?
c(b):t(b)&&q(b[Symbol.asyncIterator])?b:d(b);yield new n(1,Fa(function(f){return new oa(function*(){let g=null;do g=yield new n(2,f.next(yield new n(0,u(a,g))));while(!g.done)}())}(e[Symbol.asyncIterator]())));return new n(0,new a)}())}function Ia(a,b,c){if(0!==a){c=c.slice(0,b);for(let d=-1,e=c.length;++d<e;)c[d]+=a}return c.subarray(0,b)}function Ja(a,b){let c=0;const d=a.length;if(d!==b.length)return!1;if(0<d){do if(a[c]!==b[c])return!1;while(++c<d)}return!0}var v={};v.compareArrayLike=Ja;
v.joinUint8Arrays=Ea;v.memcpy=Da;v.rebaseValueOffsets=Ia;v.toArrayBufferView=u;v.toArrayBufferViewAsyncIterator=Ha;v.toArrayBufferViewIterator=Ga;v.toBigInt64Array=a=>u(BigInt64Array,a);v.toBigUint64Array=a=>u(BigUint64Array,a);v.toFloat32Array=a=>u(Float32Array,a);v.toFloat32ArrayAsyncIterator=a=>Ha(Float32Array,a);v.toFloat32ArrayIterator=a=>Ga(Float32Array,a);v.toFloat64Array=a=>u(Float64Array,a);v.toFloat64ArrayAsyncIterator=a=>Ha(Float64Array,a);v.toFloat64ArrayIterator=a=>Ga(Float64Array,a);
v.toInt16Array=a=>u(Int16Array,a);v.toInt16ArrayAsyncIterator=a=>Ha(Int16Array,a);v.toInt16ArrayIterator=a=>Ga(Int16Array,a);v.toInt32Array=a=>u(Int32Array,a);v.toInt32ArrayAsyncIterator=a=>Ha(Int32Array,a);v.toInt32ArrayIterator=a=>Ga(Int32Array,a);v.toInt8Array=a=>u(Int8Array,a);v.toInt8ArrayAsyncIterator=a=>Ha(Int8Array,a);v.toInt8ArrayIterator=a=>Ga(Int8Array,a);v.toUint16Array=a=>u(Uint16Array,a);v.toUint16ArrayAsyncIterator=a=>Ha(Uint16Array,a);v.toUint16ArrayIterator=a=>Ga(Uint16Array,a);
v.toUint32Array=a=>u(Uint32Array,a);v.toUint32ArrayAsyncIterator=a=>Ha(Uint32Array,a);v.toUint32ArrayIterator=a=>Ga(Uint32Array,a);v.toUint8Array=a=>u(Uint8Array,a);v.toUint8ArrayAsyncIterator=a=>Ha(Uint8Array,a);v.toUint8ArrayIterator=a=>Ga(Uint8Array,a);v.toUint8ClampedArray=a=>u(Uint8ClampedArray,a);v.toUint8ClampedArrayAsyncIterator=a=>Ha(Uint8ClampedArray,a);v.toUint8ClampedArrayIterator=a=>Ga(Uint8ClampedArray,a);function Ka(){throw Error('"toDOMStream" not available in this environment');}function La(){throw Error('"toNodeStream" not available in this environment');}const Ma=a=>{a.next();return a};
function*Na(a){let b,c=!1,d=[],e,f,g,k=0;({Z:f,size:g}=yield null);a=Ga(Uint8Array,a)[Symbol.iterator]();try{do if({done:b,value:e}=Number.isNaN(g-k)?a.next():a.next(g-k),!b&&0<e.byteLength&&(d.push(e),k+=e.byteLength),b||g<=k){do{if("peek"===f)var m=Ea(d,g)[0];else[e,d,k]=Ea(d,g),m=e;({Z:f,size:g}=yield m)}while(g<k)}while(!b)}catch(p){(c=!0,"function"===typeof a.throw)&&a.throw(p)}finally{!1===c&&"function"===typeof a.return&&a.return(null)}return null}
function Oa(a){return new oa(function*(){let b,c=!1,d=[],e,f,g,k=0;({Z:f,size:g}=yield new n(0,null));const m=Ha(Uint8Array,a)[Symbol.asyncIterator]();try{do if({done:b,value:e}=Number.isNaN(g-k)?yield new n(2,m.next()):yield new n(2,m.next(g-k)),!b&&0<e.byteLength&&(d.push(e),k+=e.byteLength),b||g<=k){do{if("peek"===f)var p=Ea(d,g)[0];else[e,d,k]=Ea(d,g),p=e;({Z:f,size:g}=yield new n(0,p))}while(g<k)}while(!b)}catch(r){(c=!0,"function"===typeof m.throw)&&(yield new n(2,m.throw(r)))}finally{!1===
c&&"function"===typeof m.return&&(yield new n(2,m.return(new Uint8Array(0))))}return new n(0,null)}())}
function Pa(a){return new oa(function*(){let b=!1,c=!1,d=[],e,f,g,k=0;({Z:f,size:g}=yield new n(0,null));const m=new Qa(a);try{do if({done:b,value:e}=Number.isNaN(g-k)?yield new n(2,m.read()):yield new n(2,m.read(g-k)),!b&&0<e.byteLength&&(d.push(u(Uint8Array,e)),k+=e.byteLength),b||g<=k){do{if("peek"===f)var p=Ea(d,g)[0];else[e,d,k]=Ea(d,g),p=e;({Z:f,size:g}=yield new n(0,p))}while(g<k)}while(!b)}catch(r){c=!0,yield new n(2,m.cancel(r))}finally{!1===c?yield new n(2,m.cancel()):a.locked&&m.releaseLock()}return new n(0,
null)}())}
class Qa{constructor(a){this.source=a;this.U=null;this.U=this.source.getReader();this.U.closed.catch(()=>{})}get closed(){return this.U?this.U.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.U&&this.U.releaseLock();this.U=null}cancel(a){const b=this;return l(function*(){const c=b.U,d=b.source;c&&(yield c.cancel(a).catch(()=>{}));d&&d.locked&&b.releaseLock()})}read(a){const b=this;return l(function*(){if(0===a)return{done:null==b.U,value:new Uint8Array(0)};const c=yield b.U.read();!c.done&&
(c.value=u(Uint8Array,c));return c})}}const Ra=(a,b)=>{const c=e=>d([b,e]);let d;return[b,c,new Promise(e=>(d=e)&&a.once(b,c))]};
function Sa(a){return new oa(function*(){function b(qa,Fb){r=p=null;return new Promise((lj,mj)=>{for(const [Gb,nj]of qa)a.off(Gb,nj);try{const Gb=a.destroy;Gb&&Gb.call(a,Fb);Fb=void 0}catch(Gb){Fb=Gb||Fb}finally{null!=Fb?mj(Fb):lj()}})}const c=[];let d="error",e=!1,f=null,g,k,m=0,p=[],r;({Z:g,size:k}=yield new n(0,null));if(a.isTTY)return yield new n(0,new Uint8Array(0)),new n(0,null);try{c[0]=Ra(a,"end");c[1]=Ra(a,"error");do{c[2]=Ra(a,"readable");[d,f]=yield new n(2,Promise.race(c.map(qa=>qa[2])));
if("error"===d)break;(e="end"===d)||(Number.isFinite(k-m)?(r=u(Uint8Array,a.read(k-m)),r.byteLength<k-m&&(r=u(Uint8Array,a.read()))):r=u(Uint8Array,a.read()),0<r.byteLength&&(p.push(r),m+=r.byteLength));if(e||k<=m){do{if("peek"===g)var R=Ea(p,k)[0];else[r,p,m]=Ea(p,k),R=r;({Z:g,size:k}=yield new n(0,R))}while(k<m)}}while(!e)}finally{yield new n(2,b(c,"error"===d?f:null))}return new n(0,null)}())};var w,Ta=w||(w={});Ta[Ta.V1=0]="V1";Ta[Ta.V2=1]="V2";Ta[Ta.V3=2]="V3";Ta[Ta.V4=3]="V4";Ta[Ta.V5=4]="V5";var x,Ua=x||(x={});Ua[Ua.Sparse=0]="Sparse";Ua[Ua.Dense=1]="Dense";var y,Va=y||(y={});Va[Va.HALF=0]="HALF";Va[Va.SINGLE=1]="SINGLE";Va[Va.DOUBLE=2]="DOUBLE";var Wa,Xa=Wa||(Wa={});Xa[Xa.DAY=0]="DAY";Xa[Xa.MILLISECOND=1]="MILLISECOND";var z,Ya=z||(z={});Ya[Ya.SECOND=0]="SECOND";Ya[Ya.MILLISECOND=1]="MILLISECOND";Ya[Ya.MICROSECOND=2]="MICROSECOND";Ya[Ya.NANOSECOND=3]="NANOSECOND";
var Za,$a=Za||(Za={});$a[$a.YEAR_MONTH=0]="YEAR_MONTH";$a[$a.DAY_TIME=1]="DAY_TIME";$a[$a.MONTH_DAY_NANO=2]="MONTH_DAY_NANO";var A,ab=A||(A={});ab[ab.NONE=0]="NONE";ab[ab.Schema=1]="Schema";ab[ab.DictionaryBatch=2]="DictionaryBatch";ab[ab.RecordBatch=3]="RecordBatch";ab[ab.Tensor=4]="Tensor";ab[ab.SparseTensor=5]="SparseTensor";var B,C=B||(B={});C[C.NONE=0]="NONE";C[C.Null=1]="Null";C[C.Int=2]="Int";C[C.Float=3]="Float";C[C.Binary=4]="Binary";C[C.Utf8=5]="Utf8";C[C.Bool=6]="Bool";C[C.Decimal=7]="Decimal";
C[C.Date=8]="Date";C[C.Time=9]="Time";C[C.Timestamp=10]="Timestamp";C[C.Interval=11]="Interval";C[C.List=12]="List";C[C.Struct=13]="Struct";C[C.Union=14]="Union";C[C.FixedSizeBinary=15]="FixedSizeBinary";C[C.FixedSizeList=16]="FixedSizeList";C[C.Map=17]="Map";C[C.Duration=18]="Duration";C[C.Dictionary=-1]="Dictionary";C[C.Int8=-2]="Int8";C[C.Int16=-3]="Int16";C[C.Int32=-4]="Int32";C[C.Int64=-5]="Int64";C[C.Uint8=-6]="Uint8";C[C.Uint16=-7]="Uint16";C[C.Uint32=-8]="Uint32";C[C.Uint64=-9]="Uint64";
C[C.Float16=-10]="Float16";C[C.Float32=-11]="Float32";C[C.Float64=-12]="Float64";C[C.DateDay=-13]="DateDay";C[C.DateMillisecond=-14]="DateMillisecond";C[C.TimestampSecond=-15]="TimestampSecond";C[C.TimestampMillisecond=-16]="TimestampMillisecond";C[C.TimestampMicrosecond=-17]="TimestampMicrosecond";C[C.TimestampNanosecond=-18]="TimestampNanosecond";C[C.TimeSecond=-19]="TimeSecond";C[C.TimeMillisecond=-20]="TimeMillisecond";C[C.TimeMicrosecond=-21]="TimeMicrosecond";C[C.TimeNanosecond=-22]="TimeNanosecond";
C[C.DenseUnion=-23]="DenseUnion";C[C.SparseUnion=-24]="SparseUnion";C[C.IntervalDayTime=-25]="IntervalDayTime";C[C.IntervalYearMonth=-26]="IntervalYearMonth";C[C.DurationSecond=-27]="DurationSecond";C[C.DurationMillisecond=-28]="DurationMillisecond";C[C.DurationMicrosecond=-29]="DurationMicrosecond";C[C.DurationNanosecond=-30]="DurationNanosecond";var bb,cb=bb||(bb={});cb[cb.OFFSET=0]="OFFSET";cb[cb.DATA=1]="DATA";cb[cb.VALIDITY=2]="VALIDITY";cb[cb.TYPE=3]="TYPE";function db(a){if(null===a)return"null";if(void 0===a)return"undefined";switch(typeof a){case "number":return`${a}`;case "bigint":return`${a}`;case "string":return`"${a}"`}return"function"===typeof a[Symbol.toPrimitive]?a[Symbol.toPrimitive]("string"):ArrayBuffer.isView(a)?a instanceof BigInt64Array||a instanceof BigUint64Array?`[${[...a].map(b=>db(b))}]`:`[${a}]`:ArrayBuffer.isView(a)?`[${a}]`:JSON.stringify(a,(b,c)=>"bigint"===typeof c?`${c}`:c)}var eb={};eb.valueToString=db;const fb=Symbol.for("isArrowBigNum");function gb(a,...b){return 0===b.length?Object.setPrototypeOf(u(this.TypedArray,a),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(a,...b),this.constructor.prototype)}gb.prototype[fb]=!0;gb.prototype.toJSON=function(){return`"${hb(this)}"`};gb.prototype.valueOf=function(){return ib(this)};gb.prototype.toString=function(){return hb(this)};gb.prototype[Symbol.toPrimitive]=function(a="default"){switch(a){case "number":return ib(this);case "default":return jb(this)}return hb(this)};
function kb(...a){return gb.apply(this,a)}function lb(...a){return gb.apply(this,a)}function mb(...a){return gb.apply(this,a)}Object.setPrototypeOf(kb.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(lb.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(mb.prototype,Object.create(Uint32Array.prototype));Object.assign(kb.prototype,gb.prototype,{constructor:kb,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});
Object.assign(lb.prototype,gb.prototype,{constructor:lb,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(mb.prototype,gb.prototype,{constructor:mb,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});
function ib(a){const {buffer:b,byteOffset:c,length:d,signed:e}=a;a=new BigUint64Array(b,c,d);const f=e&&a.at(-1)&BigInt(1)<<BigInt(63);let g=f?BigInt(1):BigInt(0),k=BigInt(0);if(f){for(const m of a)g+=~m*(BigInt(1)<<BigInt(32)*k++);g*=BigInt(-1)}else for(const m of a)g+=m*(BigInt(1)<<BigInt(32)*k++);return g}
const hb=a=>{if(8===a.byteLength)return`${(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]}`;if(!a.signed)return nb(a);let b=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);if(0<=(new Int16Array([b.at(-1)]))[0])return nb(a);b=b.slice();a=1;for(let c=0;c<b.length;c++){const d=b[c];b[c]=~d+a;a&=0===d?1:0}return`-${nb(b)}`},jb=a=>8===a.byteLength?(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]:hb(a);
function nb(a){let b="";const c=new Uint32Array(2);a=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);const d=new Uint32Array((a=(new Uint16Array(a)).reverse()).buffer);let e;const f=a.length-1;do{for(c[0]=a[e=0];e<f;)a[e++]=c[1]=c[0]/10,c[0]=(c[0]-10*c[1]<<16)+a[e];a[e]=c[1]=c[0]/10;c[0]-=10*c[1];b=`${c[0]}${b}`}while(d[0]||d[1]||d[2]||d[3]);let g;return null!=(g=b)?g:"0"}
class ob{static new(a,b){switch(b){case !0:return new kb(a);case !1:return new lb(a)}switch(a.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new kb(a)}return 16===a.byteLength?new mb(a):new lb(a)}static ec(a){return new kb(a)}constructor(a,b){return ob.new(a,b)}}var pb={};pb.BN=ob;pb.bigNumToBigInt=jb;pb.bigNumToString=hb;pb.isArrowBigNumSymbol=fb;function qb(a){if("bigint"===typeof a&&(a<Number.MIN_SAFE_INTEGER||a>Number.MAX_SAFE_INTEGER))throw new TypeError(`${a} is not safe to convert to a number.`);return Number(a)};class D{static isNull(a){return(null==a?void 0:a.typeId)===B.Null}static isInt(a){return(null==a?void 0:a.typeId)===B.Int}static isFloat(a){return(null==a?void 0:a.typeId)===B.Float}static isBinary(a){return(null==a?void 0:a.typeId)===B.Binary}static isUtf8(a){return(null==a?void 0:a.typeId)===B.Utf8}static isBool(a){return(null==a?void 0:a.typeId)===B.Bool}static isDecimal(a){return(null==a?void 0:a.typeId)===B.Decimal}static isDate(a){return(null==a?void 0:a.typeId)===B.Date}static isTime(a){return(null==
a?void 0:a.typeId)===B.Time}static isTimestamp(a){return(null==a?void 0:a.typeId)===B.Timestamp}static isInterval(a){return(null==a?void 0:a.typeId)===B.Interval}static isDuration(a){return(null==a?void 0:a.typeId)===B.Duration}static isList(a){return(null==a?void 0:a.typeId)===B.List}static isStruct(a){return(null==a?void 0:a.typeId)===B.Struct}static isUnion(a){return(null==a?void 0:a.typeId)===B.Union}static isFixedSizeBinary(a){return(null==a?void 0:a.typeId)===B.FixedSizeBinary}static isFixedSizeList(a){return(null==
a?void 0:a.typeId)===B.FixedSizeList}static isMap(a){return(null==a?void 0:a.typeId)===B.Map}static isDictionary(a){return(null==a?void 0:a.typeId)===B.Dictionary}static isDenseUnion(a){return D.isUnion(a)&&a.mode===x.Dense}static isSparseUnion(a){return D.isUnion(a)&&a.mode===x.Sparse}get typeId(){return B.NONE}}var rb=Symbol.toStringTag,sb,tb=D.prototype;tb.children=null;tb.ArrayType=Array;sb=tb[Symbol.toStringTag]="DataType";D[rb]=sb;
class ub extends D{toString(){return"Null"}get typeId(){return B.Null}}ub[Symbol.toStringTag]=ub.prototype[Symbol.toStringTag]="Null";
class vb extends D{constructor(a,b){super();this.isSigned=a;this.bitWidth=b}get typeId(){return B.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}
var wb=Symbol.toStringTag,xb,yb=vb.prototype;yb.isSigned=null;yb.bitWidth=null;xb=yb[Symbol.toStringTag]="Int";vb[wb]=xb;class zb extends vb{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class Ab extends vb{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class Bb extends vb{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}class Cb extends vb{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}
class Db extends vb{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class Eb extends vb{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class Hb extends vb{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}class Ib extends vb{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}Object.defineProperty(zb.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(Ab.prototype,"ArrayType",{value:Int16Array});
Object.defineProperty(Bb.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Cb.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(Db.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(Eb.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Hb.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(Ib.prototype,"ArrayType",{value:BigUint64Array});
class Jb extends D{constructor(a){super();this.precision=a}get typeId(){return B.Float}get ArrayType(){switch(this.precision){case y.HALF:return Uint16Array;case y.SINGLE:return Float32Array;case y.DOUBLE:return Float64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`Float${this.precision<<5||16}`}}var Kb=Symbol.toStringTag,Lb,Mb=Jb.prototype;Mb.precision=null;Lb=Mb[Symbol.toStringTag]="Float";Jb[Kb]=Lb;class Nb extends Jb{constructor(){super(y.HALF)}}
class Ob extends Jb{constructor(){super(y.SINGLE)}}class Pb extends Jb{constructor(){super(y.DOUBLE)}}Object.defineProperty(Nb.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Ob.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(Pb.prototype,"ArrayType",{value:Float64Array});class Qb extends D{constructor(){super()}get typeId(){return B.Binary}toString(){return"Binary"}}var Rb=Symbol.toStringTag,Sb,Tb=Qb.prototype;Tb.ArrayType=Uint8Array;Sb=Tb[Symbol.toStringTag]="Binary";
Qb[Rb]=Sb;class Ub extends D{constructor(){super()}get typeId(){return B.Utf8}toString(){return"Utf8"}}var Vb=Symbol.toStringTag,Wb,Xb=Ub.prototype;Xb.ArrayType=Uint8Array;Wb=Xb[Symbol.toStringTag]="Utf8";Ub[Vb]=Wb;class Yb extends D{constructor(){super()}get typeId(){return B.Bool}toString(){return"Bool"}}var Zb=Symbol.toStringTag,$b,ac=Yb.prototype;ac.ArrayType=Uint8Array;$b=ac[Symbol.toStringTag]="Bool";Yb[Zb]=$b;
class bc extends D{constructor(a,b,c=128){super();this.scale=a;this.precision=b;this.bitWidth=c}get typeId(){return B.Decimal}toString(){return`Decimal[${this.precision}e${0<this.scale?"+":""}${this.scale}]`}}var cc=Symbol.toStringTag,dc,ec=bc.prototype;ec.scale=null;ec.precision=null;ec.ArrayType=Uint32Array;dc=ec[Symbol.toStringTag]="Decimal";bc[cc]=dc;class fc extends D{constructor(a){super();this.unit=a}get typeId(){return B.Date}toString(){return`Date${32*(this.unit+1)}<${Wa[this.unit]}>`}}
var gc=Symbol.toStringTag,hc,ic=fc.prototype;ic.unit=null;ic.ArrayType=Int32Array;hc=ic[Symbol.toStringTag]="Date";fc[gc]=hc;class jc extends fc{constructor(){super(Wa.DAY)}}class kc extends fc{constructor(){super(Wa.MILLISECOND)}}
class lc extends D{constructor(a,b){super();this.unit=a;this.bitWidth=b}get typeId(){return B.Time}toString(){return`Time${this.bitWidth}<${z[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}}var mc=Symbol.toStringTag,nc,oc=lc.prototype;oc.unit=null;oc.bitWidth=null;nc=oc[Symbol.toStringTag]="Time";lc[mc]=nc;class pc extends lc{constructor(){super(z.SECOND,32)}}
class qc extends lc{constructor(){super(z.MILLISECOND,32)}}class rc extends lc{constructor(){super(z.MICROSECOND,64)}}class sc extends lc{constructor(){super(z.NANOSECOND,64)}}class tc extends D{constructor(a,b){super();this.unit=a;this.timezone=b}get typeId(){return B.Timestamp}toString(){return`Timestamp<${z[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}var uc=Symbol.toStringTag,vc,wc=tc.prototype;wc.unit=null;wc.timezone=null;wc.ArrayType=Int32Array;vc=wc[Symbol.toStringTag]="Timestamp";
tc[uc]=vc;class xc extends tc{constructor(a){super(z.SECOND,a)}}class yc extends tc{constructor(a){super(z.MILLISECOND,a)}}class zc extends tc{constructor(a){super(z.MICROSECOND,a)}}class Ac extends tc{constructor(a){super(z.NANOSECOND,a)}}class Bc extends D{constructor(a){super();this.unit=a}get typeId(){return B.Interval}toString(){return`Interval<${Za[this.unit]}>`}}var Cc=Symbol.toStringTag,Dc,Ec=Bc.prototype;Ec.unit=null;Ec.ArrayType=Int32Array;Dc=Ec[Symbol.toStringTag]="Interval";Bc[Cc]=Dc;
class Fc extends Bc{constructor(){super(Za.DAY_TIME)}}class Gc extends Bc{constructor(){super(Za.YEAR_MONTH)}}class Hc extends D{constructor(a){super();this.unit=a}get typeId(){return B.Duration}toString(){return`Duration<${z[this.unit]}>`}}var Ic=Symbol.toStringTag,Jc,Kc=Hc.prototype;Kc.unit=null;Kc.ArrayType=BigInt64Array;Jc=Kc[Symbol.toStringTag]="Duration";Hc[Ic]=Jc;class Lc extends Hc{constructor(){super(z.SECOND)}}class Mc extends Hc{constructor(){super(z.MILLISECOND)}}
class Nc extends Hc{constructor(){super(z.MICROSECOND)}}class Oc extends Hc{constructor(){super(z.NANOSECOND)}}class Pc extends D{constructor(a){super();this.children=[a]}get typeId(){return B.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}var Qc=Symbol.toStringTag,Rc,Sc=Pc.prototype;Sc.children=null;Rc=Sc[Symbol.toStringTag]="List";Pc[Qc]=Rc;
class Tc extends D{constructor(a){super();this.children=a}get typeId(){return B.Struct}toString(){return`Struct<{${this.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}var Uc=Symbol.toStringTag,Vc,Wc=Tc.prototype;Wc.children=null;Vc=Wc[Symbol.toStringTag]="Struct";Tc[Uc]=Vc;
class Xc extends D{constructor(a,b,c){super();this.mode=a;this.children=c;this.typeIds=b=Int32Array.from(b);this.typeIdToChildIndex=b.reduce((d,e,f)=>(d[e]=f)&&d||d,Object.create(null))}get typeId(){return B.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(a=>`${a.type}`).join(" | ")}>`}}var Yc=Symbol.toStringTag,Zc,$c=Xc.prototype;$c.mode=null;$c.typeIds=null;$c.children=null;$c.typeIdToChildIndex=null;$c.ArrayType=Int8Array;Zc=$c[Symbol.toStringTag]="Union";Xc[Yc]=Zc;
class ad extends Xc{constructor(a,b){super(x.Dense,a,b)}}class bd extends Xc{constructor(a,b){super(x.Sparse,a,b)}}class cd extends D{constructor(a){super();this.byteWidth=a}get typeId(){return B.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}var dd=Symbol.toStringTag,ed,fd=cd.prototype;fd.byteWidth=null;fd.ArrayType=Uint8Array;ed=fd[Symbol.toStringTag]="FixedSizeBinary";cd[dd]=ed;
class gd extends D{constructor(a,b){super();this.listSize=a;this.children=[b]}get typeId(){return B.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}var hd=Symbol.toStringTag,id,jd=gd.prototype;jd.children=null;jd.listSize=null;id=jd[Symbol.toStringTag]="FixedSizeList";gd[hd]=id;
class kd extends D{constructor(a,b=!1){super();this.children=[a];this.keysSorted=b;if(a){a.name="entries";let c;if(null==a?0:null==(c=a.type)?0:c.children){let d;(b=null==a?void 0:null==(d=a.type)?void 0:d.children[0])&&(b.name="key");let e;(a=null==a?void 0:null==(e=a.type)?void 0:e.children[1])&&(a.name="value")}}}get typeId(){return B.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(a=>
`${a.name}:${a.type}`).join(", ")}}>`}}var ld=Symbol.toStringTag,md,nd=kd.prototype;nd.children=null;nd.keysSorted=null;md=nd[Symbol.toStringTag]="Map_";kd[ld]=md;const od=(a=>()=>++a)(-1);
class pd extends D{constructor(a,b,c,d){super();this.indices=b;this.dictionary=a;this.isOrdered=d||!1;this.id=null==c?od():qb(c)}get typeId(){return B.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}var qd=Symbol.toStringTag,rd,sd=pd.prototype;sd.id=null;sd.indices=null;sd.isOrdered=null;sd.dictionary=null;rd=sd[Symbol.toStringTag]="Dictionary";
pd[qd]=rd;function td(a){switch(a.typeId){case B.Decimal:return a.bitWidth/32;case B.Timestamp:return 2;case B.Date:return 1+a.unit;case B.Interval:return 1+a.unit;case B.FixedSizeList:return a.listSize;case B.FixedSizeBinary:return a.byteWidth;default:return 1}};class ud{visitMany(a,...b){return a.map((c,d)=>this.visit(c,...b.map(e=>e[d])))}visit(...a){return this.getVisitFn(a[0],!1).apply(this,a)}getVisitFn(a,b=!0){return vd(this,a,b)}getVisitFnByTypeId(a,b=!0){return wd(this,a,b)}visitNull(){return null}visitBool(){return null}visitInt(){return null}visitFloat(){return null}visitUtf8(){return null}visitBinary(){return null}visitFixedSizeBinary(){return null}visitDate(){return null}visitTimestamp(){return null}visitTime(){return null}visitDecimal(){return null}visitList(){return null}visitStruct(){return null}visitUnion(){return null}visitDictionary(){return null}visitInterval(){return null}visitDuration(){return null}visitFixedSizeList(){return null}visitMap(){return null}}
function vd(a,b,c=!0){return"number"===typeof b?wd(a,b,c):"string"===typeof b&&b in B?wd(a,B[b],c):b&&b instanceof D?wd(a,xd(b),c):(null==b?0:b.type)&&b.type instanceof D?wd(a,xd(b.type),c):wd(a,B.NONE,c)}
function wd(a,b,c=!0){let d=null;switch(b){case B.Null:d=a.visitNull;break;case B.Bool:d=a.visitBool;break;case B.Int:d=a.visitInt;break;case B.Int8:d=a.visitInt8||a.visitInt;break;case B.Int16:d=a.visitInt16||a.visitInt;break;case B.Int32:d=a.visitInt32||a.visitInt;break;case B.Int64:d=a.visitInt64||a.visitInt;break;case B.Uint8:d=a.visitUint8||a.visitInt;break;case B.Uint16:d=a.visitUint16||a.visitInt;break;case B.Uint32:d=a.visitUint32||a.visitInt;break;case B.Uint64:d=a.visitUint64||a.visitInt;
break;case B.Float:d=a.visitFloat;break;case B.Float16:d=a.visitFloat16||a.visitFloat;break;case B.Float32:d=a.visitFloat32||a.visitFloat;break;case B.Float64:d=a.visitFloat64||a.visitFloat;break;case B.Utf8:d=a.visitUtf8;break;case B.Binary:d=a.visitBinary;break;case B.FixedSizeBinary:d=a.visitFixedSizeBinary;break;case B.Date:d=a.visitDate;break;case B.DateDay:d=a.visitDateDay||a.visitDate;break;case B.DateMillisecond:d=a.visitDateMillisecond||a.visitDate;break;case B.Timestamp:d=a.visitTimestamp;
break;case B.TimestampSecond:d=a.visitTimestampSecond||a.visitTimestamp;break;case B.TimestampMillisecond:d=a.visitTimestampMillisecond||a.visitTimestamp;break;case B.TimestampMicrosecond:d=a.visitTimestampMicrosecond||a.visitTimestamp;break;case B.TimestampNanosecond:d=a.visitTimestampNanosecond||a.visitTimestamp;break;case B.Time:d=a.visitTime;break;case B.TimeSecond:d=a.visitTimeSecond||a.visitTime;break;case B.TimeMillisecond:d=a.visitTimeMillisecond||a.visitTime;break;case B.TimeMicrosecond:d=
a.visitTimeMicrosecond||a.visitTime;break;case B.TimeNanosecond:d=a.visitTimeNanosecond||a.visitTime;break;case B.Decimal:d=a.visitDecimal;break;case B.List:d=a.visitList;break;case B.Struct:d=a.visitStruct;break;case B.Union:d=a.visitUnion;break;case B.DenseUnion:d=a.visitDenseUnion||a.visitUnion;break;case B.SparseUnion:d=a.visitSparseUnion||a.visitUnion;break;case B.Dictionary:d=a.visitDictionary;break;case B.Interval:d=a.visitInterval;break;case B.IntervalDayTime:d=a.visitIntervalDayTime||a.visitInterval;
break;case B.IntervalYearMonth:d=a.visitIntervalYearMonth||a.visitInterval;break;case B.Duration:d=a.visitDuration;break;case B.DurationSecond:d=a.visitDurationSecond||a.visitDuration;break;case B.DurationMillisecond:d=a.visitDurationMillisecond||a.visitDuration;break;case B.DurationMicrosecond:d=a.visitDurationMicrosecond||a.visitDuration;break;case B.DurationNanosecond:d=a.visitDurationNanosecond||a.visitDuration;break;case B.FixedSizeList:d=a.visitFixedSizeList;break;case B.Map:d=a.visitMap}if("function"===
typeof d)return d;if(!c)return()=>null;throw Error(`Unrecognized type '${B[b]}'`);}
function xd(a){switch(a.typeId){case B.Null:return B.Null;case B.Int:const b=a.isSigned;switch(a.bitWidth){case 8:return b?B.Int8:B.Uint8;case 16:return b?B.Int16:B.Uint16;case 32:return b?B.Int32:B.Uint32;case 64:return b?B.Int64:B.Uint64}return B.Int;case B.Float:switch(a.precision){case y.HALF:return B.Float16;case y.SINGLE:return B.Float32;case y.DOUBLE:return B.Float64}return B.Float;case B.Binary:return B.Binary;case B.Utf8:return B.Utf8;case B.Bool:return B.Bool;case B.Decimal:return B.Decimal;
case B.Time:switch(a.unit){case z.SECOND:return B.TimeSecond;case z.MILLISECOND:return B.TimeMillisecond;case z.MICROSECOND:return B.TimeMicrosecond;case z.NANOSECOND:return B.TimeNanosecond}return B.Time;case B.Timestamp:switch(a.unit){case z.SECOND:return B.TimestampSecond;case z.MILLISECOND:return B.TimestampMillisecond;case z.MICROSECOND:return B.TimestampMicrosecond;case z.NANOSECOND:return B.TimestampNanosecond}return B.Timestamp;case B.Date:switch(a.unit){case Wa.DAY:return B.DateDay;case Wa.MILLISECOND:return B.DateMillisecond}return B.Date;
case B.Interval:switch(a.unit){case Za.DAY_TIME:return B.IntervalDayTime;case Za.YEAR_MONTH:return B.IntervalYearMonth}return B.Interval;case B.Duration:switch(a.unit){case z.SECOND:return B.DurationSecond;case z.MILLISECOND:return B.DurationMillisecond;case z.MICROSECOND:return B.DurationMicrosecond;case z.NANOSECOND:return B.DurationNanosecond}return B.Duration;case B.Map:return B.Map;case B.List:return B.List;case B.Struct:return B.Struct;case B.Union:switch(a.mode){case x.Dense:return B.DenseUnion;
case x.Sparse:return B.SparseUnion}return B.Union;case B.FixedSizeBinary:return B.FixedSizeBinary;case B.FixedSizeList:return B.FixedSizeList;case B.Dictionary:return B.Dictionary}throw Error(`Unrecognized type '${B[a.typeId]}'`);}h=ud.prototype;h.visitInt8=null;h.visitInt16=null;h.visitInt32=null;h.visitInt64=null;h.visitUint8=null;h.visitUint16=null;h.visitUint32=null;h.visitUint64=null;h.visitFloat16=null;h.visitFloat32=null;h.visitFloat64=null;h.visitDateDay=null;h.visitDateMillisecond=null;
h.visitTimestampSecond=null;h.visitTimestampMillisecond=null;h.visitTimestampMicrosecond=null;h.visitTimestampNanosecond=null;h.visitTimeSecond=null;h.visitTimeMillisecond=null;h.visitTimeMicrosecond=null;h.visitTimeNanosecond=null;h.visitDenseUnion=null;h.visitSparseUnion=null;h.visitIntervalDayTime=null;h.visitIntervalYearMonth=null;h.visitDuration=null;h.visitDurationSecond=null;h.visitDurationMillisecond=null;h.visitDurationMicrosecond=null;h.visitDurationNanosecond=null;const yd=new Float64Array(1),zd=new Uint32Array(yd.buffer);function Ad(a){const b=(a&31744)>>10,c=(a&1023)/1024;a=Math.pow(-1,(a&32768)>>15);switch(b){case 31:return a*(c?Number.NaN:1/0);case 0:return a*(c?6.103515625E-5*c:0)}return a*Math.pow(2,b-15)*(1+c)}
function Bd(a){if(a!==a)return 32256;yd[0]=a;a=(zd[1]&2147483648)>>16&65535;let b=zd[1]&2146435072,c=0;1089470464<=b?0<zd[0]?b=31744:(b=(b&2080374784)>>16,c=(zd[1]&1048575)>>10):1056964608>=b?(c=1048576+(zd[1]&1048575),c=1048576+(c<<(b>>20)-998)>>21,b=0):(b=b-1056964608>>10,c=(zd[1]&1048575)+512>>10);return a|b|c&65535}var Cd={};Cd.float64ToUint16=Bd;Cd.uint16ToFloat64=Ad;class Dd extends ud{}function E(a){return(b,c,d)=>{if(b.setValid(c,null!=d))return a(b,c,d)}}
const Ed=(a,b,c)=>{a[b]=Math.trunc(c%4294967296);a[b+1]=Math.trunc(c/4294967296)},Fd=(a,b,c,d)=>{if(c+1<b.length){const {[c]:e,[c+1]:f}=b;a.set(d.subarray(0,f-e),e)}},Gd=({values:a},b,c)=>{a[b]=c},Hd=({values:a},b,c)=>{a[b]=c},Id=({values:a},b,c)=>{a[b]=Bd(c)},Jd=({values:a},b,c)=>{a[b]=Math.trunc(c.valueOf()/864E5)},Kd=({values:a},b,c)=>{Ed(a,2*b,c.valueOf())},Ld=({stride:a,values:b},c,d)=>{b.set(d.subarray(0,a),a*c)},Md=(a,b,c)=>{a.type.unit===Wa.DAY?Jd(a,b,c):Kd(a,b,c)},Nd=({values:a},b,c)=>Ed(a,
2*b,c/1E3),Od=({values:a},b,c)=>Ed(a,2*b,c),Pd=({values:a},b,c)=>{b*=2;a[b]=Math.trunc(1E3*c%4294967296);a[b+1]=Math.trunc(1E3*c/4294967296)},Qd=({values:a},b,c)=>{b*=2;a[b]=Math.trunc(1E6*c%4294967296);a[b+1]=Math.trunc(1E6*c/4294967296)},Rd=(a,b,c)=>{switch(a.type.unit){case z.SECOND:return Nd(a,b,c);case z.MILLISECOND:return Od(a,b,c);case z.MICROSECOND:return Pd(a,b,c);case z.NANOSECOND:return Qd(a,b,c)}},Sd=({values:a},b,c)=>{a[b]=c},Td=({values:a},b,c)=>{a[b]=c},Ud=({values:a},b,c)=>{a[b]=c},
Vd=({values:a},b,c)=>{a[b]=c},Wd=(a,b,c)=>{switch(a.type.unit){case z.SECOND:return Sd(a,b,c);case z.MILLISECOND:return Td(a,b,c);case z.MICROSECOND:return Ud(a,b,c);case z.NANOSECOND:return Vd(a,b,c)}},Xd=({values:a,stride:b},c,d)=>{a.set(d.subarray(0,b),b*c)},Yd=(a,b)=>(c,d,e,f)=>d&&c(d,a,b[f]),Zd=(a,b)=>(c,d,e,f)=>d&&c(d,a,b.get(f)),$d=(a,b)=>(c,d,e)=>d&&c(d,a,b.get(e.name)),ae=(a,b)=>(c,d,e)=>d&&c(d,a,b[e.name]),ce=(a,b,c)=>{be.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],a.valueOffsets[b],
c)},de=(a,b,c)=>{be.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],b,c)},ge=(a,b,c)=>{a.type.unit===Za.DAY_TIME?ee(a,b,c):fe(a,b,c)},ee=({values:a},b,c)=>{a.set(c.subarray(0,2),2*b)},fe=({values:a},b,c)=>{a[b]=12*c[0]+c[1]%12},he=({values:a},b,c)=>{a[b]=c},ie=({values:a},b,c)=>{a[b]=c},je=({values:a},b,c)=>{a[b]=c},ke=({values:a},b,c)=>{a[b]=c},le=(a,b,c)=>{switch(a.type.unit){case z.SECOND:return he(a,b,c);case z.MILLISECOND:return ie(a,b,c);case z.MICROSECOND:return je(a,b,c);case z.NANOSECOND:return ke(a,
b,c)}};h=Dd.prototype;h.visitBool=E(({offset:a,values:b},c,d)=>{a+=c;d?b[a>>3]|=1<<a%8:b[a>>3]&=~(1<<a%8)});h.visitInt=E(Gd);h.visitInt8=E(Gd);h.visitInt16=E(Gd);h.visitInt32=E(Gd);h.visitInt64=E(Gd);h.visitUint8=E(Gd);h.visitUint16=E(Gd);h.visitUint32=E(Gd);h.visitUint64=E(Gd);h.visitFloat=E((a,b,c)=>{switch(a.type.precision){case y.HALF:return Id(a,b,c);case y.SINGLE:case y.DOUBLE:return Hd(a,b,c)}});h.visitFloat16=E(Id);h.visitFloat32=E(Hd);h.visitFloat64=E(Hd);
h.visitUtf8=E(({values:a,valueOffsets:b},c,d)=>{Fd(a,b,c,xa.encode(d))});h.visitBinary=E(({values:a,valueOffsets:b},c,d)=>Fd(a,b,c,d));h.visitFixedSizeBinary=E(Ld);h.visitDate=E(Md);h.visitDateDay=E(Jd);h.visitDateMillisecond=E(Kd);h.visitTimestamp=E(Rd);h.visitTimestampSecond=E(Nd);h.visitTimestampMillisecond=E(Od);h.visitTimestampMicrosecond=E(Pd);h.visitTimestampNanosecond=E(Qd);h.visitTime=E(Wd);h.visitTimeSecond=E(Sd);h.visitTimeMillisecond=E(Td);h.visitTimeMicrosecond=E(Ud);
h.visitTimeNanosecond=E(Vd);h.visitDecimal=E(Xd);h.visitList=E((a,b,c)=>{const d=a.children[0];a=a.valueOffsets;const e=be.getVisitFn(d);if(Array.isArray(c))for(let f=-1,g=a[b],k=a[b+1];g<k;)e(d,g++,c[++f]);else for(let f=-1,g=a[b],k=a[b+1];g<k;)e(d,g++,c.get(++f))});h.visitStruct=E((a,b,c)=>{const d=a.type.children.map(f=>be.getVisitFn(f.type)),e=c instanceof Map?$d(b,c):c instanceof F?Zd(b,c):Array.isArray(c)?Yd(b,c):ae(b,c);a.type.children.forEach((f,g)=>e(d[g],a.children[g],f,g))});
h.visitUnion=E((a,b,c)=>{a.type.mode===x.Dense?ce(a,b,c):de(a,b,c)});h.visitDenseUnion=E(ce);h.visitSparseUnion=E(de);h.visitDictionary=E((a,b,c)=>{let d;null==(d=a.dictionary)||d.set(a.values[b],c)});h.visitInterval=E(ge);h.visitIntervalDayTime=E(ee);h.visitIntervalYearMonth=E(fe);h.visitDuration=E(le);h.visitDurationSecond=E(he);h.visitDurationMillisecond=E(ie);h.visitDurationMicrosecond=E(je);h.visitDurationNanosecond=E(ke);
h.visitFixedSizeList=E((a,b,c)=>{const d=a.stride;a=a.children[0];const e=be.getVisitFn(a);if(Array.isArray(c))for(let f=-1,g=b*d;++f<d;)e(a,g+f,c[f]);else for(let f=-1,g=b*d;++f<d;)e(a,g+f,c.get(f))});h.visitMap=E((a,b,c)=>{const d=a.children[0],e=a.valueOffsets;a=be.getVisitFn(d);let {[b]:f,[b+1]:g}=e;b=c instanceof Map?c.entries():Object.entries(c);for(const k of b)if(a(d,f,k),++f>=g)break});const be=new Dd;const me=Symbol.for("parent"),ne=Symbol.for("rowIndex");
class oe{constructor(a,b){this[me]=a;this[ne]=b;return new Proxy(this,new pe)}toArray(){return Object.values(this.toJSON())}toJSON(){const a=this[ne],b=this[me],c=b.type.children,d={};for(let e=-1,f=c.length;++e<f;)d[c[e].name]=qe.visit(b.children[e],a);return d}toString(){return`{${[...this].map(([a,b])=>`${db(a)}: ${db(b)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new re(this[me],this[ne])}}
class re{constructor(a,b){this.yb=0;this.children=a.children;this.rowIndex=b;this.xb=a.type.children;this.numChildren=this.xb.length}[Symbol.iterator](){return this}next(){const a=this.yb;return a<this.numChildren?(this.yb=a+1,{done:!1,value:[this.xb[a].name,qe.visit(this.children[a],this.rowIndex)]}):{done:!0,value:null}}}
Object.defineProperties(oe.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[me]:{writable:!0,enumerable:!1,configurable:!1,value:null},[ne]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});
class pe{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(a){return a[me].type.children.map(b=>b.name)}has(a,b){return-1!==a[me].type.children.findIndex(c=>c.name===b)}getOwnPropertyDescriptor(a,b){if(-1!==a[me].type.children.findIndex(c=>c.name===b))return{writable:!0,enumerable:!0,configurable:!0}}get(a,b){if(Reflect.has(a,b))return a[b];var c=a[me].type.children.findIndex(d=>d.name===b);if(-1!==c)return c=qe.visit(a[me].children[c],a[ne]),Reflect.set(a,b,c),
c}set(a,b,c){const d=a[me].type.children.findIndex(e=>e.name===b);return-1!==d?(be.visit(a[me].children[d],a[ne],c),Reflect.set(a,b,c)):Reflect.has(a,b)||"symbol"===typeof b?Reflect.set(a,b,c):!1}};class se extends ud{}function G(a){return(b,c)=>b.getValid(c)?a(b,c):null}
const te=(a,b)=>4294967296*a[b+1]+(a[b]>>>0),ue=({values:a},b)=>new Date(864E5*a[b]),ve=({values:a},b)=>new Date(te(a,2*b)),we=({stride:a,values:b},c)=>b[a*c],xe=({values:a},b)=>a[b],ye=({values:a},b)=>1E3*te(a,2*b),ze=({values:a},b)=>te(a,2*b),Ae=({values:a},b)=>{b*=2;return a[b+1]/1E3*4294967296+(a[b]>>>0)/1E3},Be=({values:a},b)=>{b*=2;return a[b+1]/1E6*4294967296+(a[b]>>>0)/1E6},Ce=({values:a},b)=>a[b],De=({values:a},b)=>a[b],Ee=({values:a},b)=>a[b],Fe=({values:a},b)=>a[b],Ge=(a,b)=>qe.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],
a.valueOffsets[b]),He=(a,b)=>qe.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],b),Ie=({values:a},b)=>a.subarray(2*b,2*(b+1)),Je=({values:a},b)=>{a=a[b];b=new Int32Array(2);b[0]=Math.trunc(a/12);b[1]=Math.trunc(a%12);return b},Ke=({values:a},b)=>a[b],Le=({values:a},b)=>a[b],Me=({values:a},b)=>a[b],Ne=({values:a},b)=>a[b];h=se.prototype;h.visitNull=G(()=>null);h.visitBool=G(({offset:a,values:b},c)=>{a+=c;return 0!==(b[a>>3]&1<<a%8)});h.visitInt=G(({values:a},b)=>a[b]);h.visitInt8=G(we);
h.visitInt16=G(we);h.visitInt32=G(we);h.visitInt64=G(xe);h.visitUint8=G(we);h.visitUint16=G(we);h.visitUint32=G(we);h.visitUint64=G(xe);h.visitFloat=G(({type:a,values:b},c)=>a.precision!==y.HALF?b[c]:Ad(b[c]));h.visitFloat16=G(({stride:a,values:b},c)=>Ad(b[a*c]));h.visitFloat32=G(we);h.visitFloat64=G(we);h.visitUtf8=G(({values:a,valueOffsets:b},c)=>{a=c+1>=b.length?null:a.subarray(b[c],b[c+1]);return null!==a?va.decode(a):null});
h.visitBinary=G(({values:a,valueOffsets:b},c)=>c+1>=b.length?null:a.subarray(b[c],b[c+1]));h.visitFixedSizeBinary=G(({stride:a,values:b},c)=>b.subarray(a*c,a*(c+1)));h.visitDate=G((a,b)=>a.type.unit===Wa.DAY?ue(a,b):ve(a,b));h.visitDateDay=G(ue);h.visitDateMillisecond=G(ve);h.visitTimestamp=G((a,b)=>{switch(a.type.unit){case z.SECOND:return ye(a,b);case z.MILLISECOND:return ze(a,b);case z.MICROSECOND:return Ae(a,b);case z.NANOSECOND:return Be(a,b)}});h.visitTimestampSecond=G(ye);
h.visitTimestampMillisecond=G(ze);h.visitTimestampMicrosecond=G(Ae);h.visitTimestampNanosecond=G(Be);h.visitTime=G((a,b)=>{switch(a.type.unit){case z.SECOND:return Ce(a,b);case z.MILLISECOND:return De(a,b);case z.MICROSECOND:return Ee(a,b);case z.NANOSECOND:return Fe(a,b)}});h.visitTimeSecond=G(Ce);h.visitTimeMillisecond=G(De);h.visitTimeMicrosecond=G(Ee);h.visitTimeNanosecond=G(Fe);h.visitDecimal=G(({values:a,stride:b},c)=>new mb(a.subarray(b*c,b*(c+1))));
h.visitList=G((a,b)=>{const c=a.stride,d=a.children,{[b*c]:e,[b*c+1]:f}=a.valueOffsets;a=d[0].slice(e,f-e);return new F([a])});h.visitStruct=G((a,b)=>new oe(a,b));h.visitUnion=G((a,b)=>a.type.mode===x.Dense?Ge(a,b):He(a,b));h.visitDenseUnion=G(Ge);h.visitSparseUnion=G(He);h.visitDictionary=G((a,b)=>{let c;return null==(c=a.dictionary)?void 0:c.get(a.values[b])});h.visitInterval=G((a,b)=>a.type.unit===Za.DAY_TIME?Ie(a,b):Je(a,b));h.visitIntervalDayTime=G(Ie);h.visitIntervalYearMonth=G(Je);
h.visitDuration=G((a,b)=>{switch(a.type.unit){case z.SECOND:return Ke(a,b);case z.MILLISECOND:return Le(a,b);case z.MICROSECOND:return Me(a,b);case z.NANOSECOND:return Ne(a,b)}});h.visitDurationSecond=G(Ke);h.visitDurationMillisecond=G(Le);h.visitDurationMicrosecond=G(Me);h.visitDurationNanosecond=G(Ne);h.visitFixedSizeList=G((a,b)=>{const c=a.stride;a=a.children[0].slice(b*c,c);return new F([a])});
h.visitMap=G((a,b)=>{const c=a.children,{[b]:d,[b+1]:e}=a.valueOffsets;return new Oe(c[0].slice(d,e-d))});const qe=new se;const Pe=Symbol.for("keys"),Qe=Symbol.for("vals");
class Oe{constructor(a){this[Pe]=(new F([a.children[0]])).memoize();this[Qe]=a.children[1];return new Proxy(this,new Re)}[Symbol.iterator](){return new Se(this[Pe],this[Qe])}get size(){return this[Pe].length}toArray(){return Object.values(this.toJSON())}toJSON(){const a=this[Pe],b=this[Qe],c={};for(let d=-1,e=a.length;++d<e;)c[a.get(d)]=qe.visit(b,d);return c}toString(){return`{${[...this].map(([a,b])=>`${db(a)}: ${db(b)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}
class Se{constructor(a,b){this.keys=a;this.$b=b;this.Cb=0;this.Xb=a.length}[Symbol.iterator](){return this}next(){const a=this.Cb;if(a===this.Xb)return{done:!0,value:null};this.Cb++;return{done:!1,value:[this.keys.get(a),qe.visit(this.$b,a)]}}}
class Re{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(a){return a[Pe].toArray().map(String)}has(a,b){return a[Pe].includes(b)}getOwnPropertyDescriptor(a,b){if(-1!==a[Pe].indexOf(b))return{writable:!0,enumerable:!0,configurable:!0}}get(a,b){if(Reflect.has(a,b))return a[b];var c=a[Pe].indexOf(b);if(-1!==c)return c=qe.visit(Reflect.get(a,Qe),c),Reflect.set(a,b,c),c}set(a,b,c){const d=a[Pe].indexOf(b);return-1!==d?(be.visit(Reflect.get(a,Qe),d,c),Reflect.set(a,
b,c)):Reflect.has(a,b)?Reflect.set(a,b,c):!1}}Object.defineProperties(Oe.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Pe]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Qe]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let Te;function Ue(a,b,c,d){const {length:e=0}=a;b="number"!==typeof b?0:b;c="number"!==typeof c?e:c;0>b&&(b=(b%e+e)%e);0>c&&(c=(c%e+e)%e);c<b&&(Te=b,b=c,c=Te);c>e&&(c=e);return d?d(a,b,c):[b,c]}const Ve=a=>a!==a;function We(a){if("object"!==typeof a||null===a)return a!==a?Ve:b=>b===a;if(a instanceof Date){const b=a.valueOf();return c=>c instanceof Date?c.valueOf()===b:!1}return ArrayBuffer.isView(a)?b=>b?Ja(a,b):!1:a instanceof Map?Xe(a):Array.isArray(a)?Ye(a):a instanceof F?Ze(a):$e(a)}
function Ye(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=We(a[c]);return af(b)}function Xe(a){let b=-1;const c=[];for(const d of a.values())c[++b]=We(d);return af(c)}function Ze(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=We(a.get(c));return af(b)}function $e(a){const b=Object.keys(a),c=[];for(let d=-1,e=b.length;++d<e;)c[d]=We(a[b[d]]);return af(c,b)}
function af(a,b){return c=>{if(!c||"object"!==typeof c)return!1;switch(c.constructor){case Array:a:{var d=a.length;if(c.length!==d)c=!1;else{for(var e=-1;++e<d;)if(!a[e](c[e])){c=!1;break a}c=!0}}return c;case Map:return bf(a,c,c.keys());case Oe:case oe:case Object:case void 0:return bf(a,c,b||Object.keys(c))}if(c instanceof F)a:if(d=a.length,c.length!==d)c=!1;else{for(e=-1;++e<d;)if(!a[e](c.get(e))){c=!1;break a}c=!0}else c=!1;return c}}
function bf(a,b,c){c=c[Symbol.iterator]();const d=b instanceof Map?b.keys():Object.keys(b)[Symbol.iterator]();b=b instanceof Map?b.values():Object.values(b)[Symbol.iterator]();let e=0;const f=a.length;let g=b.next(),k=c.next(),m=d.next();for(;e<f&&!k.done&&!m.done&&!g.done&&k.value===m.value&&a[e](g.value);++e,k=c.next(),m=d.next(),g=b.next());if(e===f&&k.done&&m.done&&g.done)return!0;c.return&&c.return();d.return&&d.return();b.return&&b.return();return!1}
var cf={clampIndex:function(a,b,c){const d=a.length;b=-1<b?b:d+b%d;return c?c(a,b):b}};cf.clampRange=Ue;cf.createElementComparator=We;function df(a,b,c,d){return 0!==(c&1<<d)}function ef(a,b,c,d){return(c&1<<d)>>d}function ff(a,b,c){const d=c.byteLength+7&-8;if(0<a||c.byteLength<d){const e=new Uint8Array(d);e.set(0===a%8?c.subarray(a>>3):gf(new hf(c,a,b,null,df)).subarray(0,d));return e}return c}function gf(a){const b=[];let c=0,d=0,e=0;for(const f of a)f&&(e|=1<<d),8===++d&&(b[c++]=e,e=d=0);if(0===c||0<d)b[c++]=e;a=new Uint8Array(b.length+7&-8);a.set(b);return a}
class hf{constructor(a,b,c,d,e){this.S=a;this.length=c;this.context=d;this.get=e;this.Xa=b%8;this.wb=b>>3;this.vb=a[this.wb++];this.index=0}next(){return this.index<this.length?(8===this.Xa&&(this.Xa=0,this.vb=this.S[this.wb++]),{value:this.get(this.context,this.index++,this.vb,this.Xa++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}
function jf(a,b,c){if(0>=c-b)return 0;if(8>c-b){var d=0;for(var e of new hf(a,b,c-b,a,ef))d+=e;return d}d=c>>3<<3;e=b+(0===b%8?0:8-b%8);return jf(a,b,e)+jf(a,d,c)+kf(a,e>>3,d-e>>3)}function kf(a,b,c){let d=0;b=Math.trunc(b);const e=new DataView(a.buffer,a.byteOffset,a.byteLength);for(a=void 0===c?a.byteLength:b+c;4<=a-b;)d+=lf(e.getUint32(b)),b+=4;for(;2<=a-b;)d+=lf(e.getUint16(b)),b+=2;for(;1<=a-b;)d+=lf(e.getUint8(b)),b+=1;return d}
function lf(a){a=Math.trunc(a);a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);return 16843009*(a+(a>>>4)&252645135)>>>24}var mf={};mf.BitIterator=hf;mf.getBit=ef;mf.getBool=df;mf.packBools=gf;mf.popcnt_array=kf;mf.popcnt_bit_range=jf;mf.popcnt_uint32=lf;mf.setBool=function(a,b,c){return c?!!(a[b>>3]|=1<<b%8)||!0:!(a[b>>3]&=~(1<<b%8))&&!1};mf.truncateBitmap=ff;function nf(a,b,c){return a.map(d=>d.slice(b,c))}function of(a,b){if(a.typeId===B.Null)return a.clone(a.type,0,b,0);const c=a.length,d=a.nullCount,e=(new Uint8Array((b+63&-64)>>3)).fill(255,0,c>>3);e[c>>3]=(1<<c-(c&-8))-1;0<d&&e.set(ff(a.offset,c,a.nullBitmap),0);const f=a.buffers;f[bb.VALIDITY]=e;return a.clone(a.type,0,b,d+(b-c),f)}
class H{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(0!==this.N){const a=this.type;return D.isSparseUnion(a)?this.children.some(b=>b.nullable):D.isDenseUnion(a)?this.children.some(b=>b.nullable):this.nullBitmap&&0<this.nullBitmap.byteLength}return!0}get byteLength(){let a=0;const b=this.valueOffsets,c=this.values,d=this.nullBitmap,e=this.typeIds;b&&(a+=b.byteLength);
c&&(a+=c.byteLength);d&&(a+=d.byteLength);e&&(a+=e.byteLength);return this.children.reduce((f,g)=>f+g.byteLength,a)}get nullCount(){if(D.isUnion(this.type))return this.children.reduce((c,d)=>c+d.nullCount,0);let a=this.N,b;-1>=a&&(b=this.nullBitmap)&&(this.N=a=this.length-jf(b,this.offset,this.offset+this.length));return a}constructor(a,b,c,d,e,f=[],g){this.type=a;this.children=f;this.dictionary=g;this.offset=Math.floor(Math.max(b||0,0));this.length=Math.floor(Math.max(c||0,0));this.N=Math.floor(Math.max(d||
0,-1));let k;e instanceof H?(this.stride=e.stride,this.values=e.values,this.typeIds=e.typeIds,this.nullBitmap=e.nullBitmap,this.valueOffsets=e.valueOffsets):(this.stride=td(a),e&&((k=e[0])&&(this.valueOffsets=k),(k=e[1])&&(this.values=k),(k=e[2])&&(this.nullBitmap=k),(k=e[3])&&(this.typeIds=k)))}getValid(a){const b=this.type;return D.isUnion(b)?this.children[b.typeIdToChildIndex[this.typeIds[a]]].getValid(b.mode===x.Dense?this.valueOffsets[a]:a):this.nullable&&0<this.nullCount?(a=this.offset+a,0!==
(this.nullBitmap[a>>3]&1<<a%8)):!0}setValid(a,b){var c=this.type;if(D.isUnion(c)){var d=this.children[c.typeIdToChildIndex[this.typeIds[a]]];a=c.mode===x.Dense?this.valueOffsets[a]:a;c=d.getValid(a);d.setValid(a,b)}else{({nullBitmap:d}=this);c=this.offset;var e=this.length,f=c+a;a=1<<f%8;f>>=3;if(!d||d.byteLength<=f)d=(new Uint8Array((c+e+63&-64)>>3)).fill(255),0<this.nullCount&&d.set(ff(c,e,this.nullBitmap),0),Object.assign(this,{nullBitmap:d,N:-1});e=d[f];c=0!==(e&a);b?d[f]=e|a:d[f]=e&~a}c!==!!b&&
(this.N=this.nullCount+(b?-1:1));return b}clone(a=this.type,b=this.offset,c=this.length,d=this.N,e=this,f=this.children){return new H(a,b,c,d,e,f,this.dictionary)}slice(a,b){const c=this.stride,d=this.typeId,e=this.children,f=+(0===this.N)-1,g=16===d?c:1;let k;const m=this.buffers;(k=m[bb.TYPE])&&(m[bb.TYPE]=k.subarray(a,a+b));(k=m[bb.OFFSET])&&(m[bb.OFFSET]=k.subarray(a,a+b+1))||(k=m[bb.DATA])&&(m[bb.DATA]=6===d?k:k.subarray(c*a,c*(a+b)));return this.clone(this.type,this.offset+a,b,f,m,0===e.length||
this.valueOffsets?e:nf(e,g*a,g*b))}}H.prototype.children=Object.freeze([]);
class pf extends ud{visit(a){return this.getVisitFn(a.type).call(this,a)}visitNull(a){const {type:b,offset:c=0,length:d=0}=a;return new H(b,c,d,d)}visitBool(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length>>3,nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,e,d])}visitInt(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,
e,d])}visitFloat(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,e,d])}visitUtf8(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.data),e=u(Uint8Array,a.nullBitmap),f=u(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new H(b,c,g,k,[f,d,e])}visitBinary(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.data),e=u(Uint8Array,a.nullBitmap),f=u(Int32Array,
a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new H(b,c,g,k,[f,d,e])}visitFixedSizeBinary(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/td(b),nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,e,d])}visitDate(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/td(b),nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,e,d])}visitTimestamp(a){const {type:b,
offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/td(b),nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,e,d])}visitTime(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/td(b),nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,e,d])}visitDecimal(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/td(b),nullCount:g=a.nullBitmap?-1:0}=a;
return new H(b,c,f,g,[void 0,e,d])}visitList(a){const {type:b,offset:c=0,child:d}=a,e=u(Uint8Array,a.nullBitmap),f=u(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new H(b,c,g,k,[f,void 0,e],[d])}visitStruct(a){const {type:b,offset:c=0,children:d=[]}=a,e=u(Uint8Array,a.nullBitmap),{length:f=d.reduce((k,{length:m})=>Math.max(k,m),0),nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,void 0,e],d)}visitUnion(a){const {type:b,offset:c=0,children:d=[]}=
a,e=u(b.ArrayType,a.typeIds),{length:f=e.length,nullCount:g=-1}=a;if(D.isSparseUnion(b))return new H(b,c,f,g,[void 0,void 0,void 0,e],d);a=u(Int32Array,a.valueOffsets);return new H(b,c,f,g,[a,void 0,void 0,e],d)}visitDictionary(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.indices.ArrayType,a.data),{dictionary:f=new F([(new pf).visit({type:b.dictionary})])}=a,{length:g=e.length,nullCount:k=a.nullBitmap?-1:0}=a;return new H(b,c,g,k,[void 0,e,d],[],f)}visitInterval(a){const {type:b,
offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length/td(b),nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,e,d])}visitDuration(a){const {type:b,offset:c=0}=a,d=u(Uint8Array,a.nullBitmap),e=u(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,e,d])}visitFixedSizeList(a){const {type:b,offset:c=0,child:d=(new pf).visit({type:b.valueType})}=a,e=u(Uint8Array,a.nullBitmap),{length:f=d.length/td(b),nullCount:g=
a.nullBitmap?-1:0}=a;return new H(b,c,f,g,[void 0,void 0,e],[d])}visitMap(a){const {type:b,offset:c=0,child:d=(new pf).visit({type:b.childType})}=a,e=u(Uint8Array,a.nullBitmap),f=u(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new H(b,c,g,k,[f,void 0,e],[d])}}const qf=new pf;function I(a){return qf.visit(a)};class rf{constructor(a=0,b){this.Db=a;this.Bb=b;this.$a=0;this.zb=this.Bb(0)}next(){for(;this.$a<this.Db;){const a=this.zb.next();if(!a.done)return a;++this.$a<this.Db&&(this.zb=this.Bb(this.$a))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function sf(a){return a.reduce((b,c)=>b+c.nullCount,0)}function tf(a){return a.reduce((b,c,d)=>{b[d+1]=b[d]+c.length;return b},new Uint32Array(a.length+1))}
function uf(a,b,c,d){const e=[];for(let f=-1,g=a.length;++f<g;){const k=a[f],m=b[f],p=k.length;if(m>=d)break;if(c>=m+p)continue;if(m>=c&&m+p<=d){e.push(k);continue}const r=Math.max(0,c-m);e.push(k.slice(r,Math.min(d-m,p)-r))}0===e.length&&e.push(a[0].slice(0,0));return e}function vf(a,b,c,d){let e=0,f,g=b.length-1;do{if(e>=g-1)return c<b[g]?d(a,e,c-b[e]):null;f=e+Math.trunc(.5*(g-e));c<b[f]?g=f:e=f}while(e<g)}function wf(a,b){return a.getValid(b)}
function xf(a){function b(c,d,e){return a(c[d],e)}return function(c){return vf(this.data,this.m,c,b)}}function yf(a){function b(d,e,f){return a(d[e],f,c)}let c;return function(d,e){const f=this.data;c=e;d=vf(f,this.m,d,b);c=void 0;return d}}function zf(a){function b(d,e,f){var g=f;f=0;for(let k=e-1,m=d.length;++k<m;){e=d[k];if(~(g=a(e,c,g)))return f+g;g=0;f+=e.length}return-1}let c;return function(d,e){c=d;d=this.data;e="number"!==typeof e?b(d,0,0):vf(d,this.m,e,b);c=void 0;return e}};class Af extends ud{}function J(a,b,c){if(void 0===b)return-1;if(null===b)switch(a.typeId){case B.Union:break;case B.Dictionary:break;default:a:{const e=a.nullBitmap;if(e&&!(0>=a.nullCount)){b=0;for(var d of new hf(e,a.offset+(c||0),a.length,e,df)){if(!d){a=b;break a}++b}}a=-1}return a}d=qe.getVisitFn(a);b=We(b);for(let e=(c||0)-1,f=a.length;++e<f;)if(b(d(a,e)))return e;return-1}
function Bf(a,b,c){const d=qe.getVisitFn(a);b=We(b);for(let e=(c||0)-1,f=a.length;++e<f;)if(b(d(a,e)))return e;return-1}h=Af.prototype;h.visitNull=function(a,b){return null===b&&0<a.length?0:-1};h.visitBool=J;h.visitInt=J;h.visitInt8=J;h.visitInt16=J;h.visitInt32=J;h.visitInt64=J;h.visitUint8=J;h.visitUint16=J;h.visitUint32=J;h.visitUint64=J;h.visitFloat=J;h.visitFloat16=J;h.visitFloat32=J;h.visitFloat64=J;h.visitUtf8=J;h.visitBinary=J;h.visitFixedSizeBinary=J;h.visitDate=J;h.visitDateDay=J;
h.visitDateMillisecond=J;h.visitTimestamp=J;h.visitTimestampSecond=J;h.visitTimestampMillisecond=J;h.visitTimestampMicrosecond=J;h.visitTimestampNanosecond=J;h.visitTime=J;h.visitTimeSecond=J;h.visitTimeMillisecond=J;h.visitTimeMicrosecond=J;h.visitTimeNanosecond=J;h.visitDecimal=J;h.visitList=J;h.visitStruct=J;h.visitUnion=J;h.visitDenseUnion=Bf;h.visitSparseUnion=Bf;h.visitDictionary=J;h.visitInterval=J;h.visitIntervalDayTime=J;h.visitIntervalYearMonth=J;h.visitDuration=J;
h.visitDurationSecond=J;h.visitDurationMillisecond=J;h.visitDurationMicrosecond=J;h.visitDurationNanosecond=J;h.visitFixedSizeList=J;h.visitMap=J;const Cf=new Af;class Df extends ud{}function K(a){const b=a.type;if(0===a.nullCount&&1===a.stride&&(b.typeId===B.Timestamp||b instanceof vb&&64!==b.bitWidth||b instanceof lc&&64!==b.bitWidth||b instanceof Jb&&b.precision!==y.HALF))return new rf(a.data.length,d=>{d=a.data[d];return d.values.subarray(0,d.length)[Symbol.iterator]()});let c=0;return new rf(a.data.length,d=>{d=a.data[d].length;const e=a.slice(c,c+d);c+=d;return new Ef(e)})}
class Ef{constructor(a){this.Eb=a;this.index=0}next(){return this.index<this.Eb.length?{value:this.Eb.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}h=Df.prototype;h.visitNull=K;h.visitBool=K;h.visitInt=K;h.visitInt8=K;h.visitInt16=K;h.visitInt32=K;h.visitInt64=K;h.visitUint8=K;h.visitUint16=K;h.visitUint32=K;h.visitUint64=K;h.visitFloat=K;h.visitFloat16=K;h.visitFloat32=K;h.visitFloat64=K;h.visitUtf8=K;h.visitBinary=K;h.visitFixedSizeBinary=K;h.visitDate=K;
h.visitDateDay=K;h.visitDateMillisecond=K;h.visitTimestamp=K;h.visitTimestampSecond=K;h.visitTimestampMillisecond=K;h.visitTimestampMicrosecond=K;h.visitTimestampNanosecond=K;h.visitTime=K;h.visitTimeSecond=K;h.visitTimeMillisecond=K;h.visitTimeMicrosecond=K;h.visitTimeNanosecond=K;h.visitDecimal=K;h.visitList=K;h.visitStruct=K;h.visitUnion=K;h.visitDenseUnion=K;h.visitSparseUnion=K;h.visitDictionary=K;h.visitInterval=K;h.visitIntervalDayTime=K;h.visitIntervalYearMonth=K;h.visitDuration=K;
h.visitDurationSecond=K;h.visitDurationMillisecond=K;h.visitDurationMicrosecond=K;h.visitDurationNanosecond=K;h.visitFixedSizeList=K;h.visitMap=K;const Ff=new Df;const Gf=(a,b)=>a+b;
class Hf extends ud{visitNull(){return 0}visitInt(a){return a.type.bitWidth/8}visitFloat(a){return a.type.ArrayType.BYTES_PER_ELEMENT}visitBool(){return.125}visitDecimal(a){return a.type.bitWidth/8}visitDate(a){return 4*(a.type.unit+1)}visitTime(a){return a.type.bitWidth/8}visitTimestamp(a){return a.type.unit===z.SECOND?4:8}visitInterval(a){return 4*(a.type.unit+1)}visitDuration(){return 8}visitStruct(a,b){return a.children.reduce((c,d)=>c+If.visit(d,b),0)}visitFixedSizeBinary(a){return a.type.byteWidth}visitMap(a,b){return 8+
a.children.reduce((c,d)=>c+If.visit(d,b),0)}visitDictionary(a,b){let c;return a.type.indices.bitWidth/8+((null==(c=a.dictionary)?void 0:c.getByteLength(a.values[b]))||0)}}const Jf=({type:a,children:b,typeIds:c,valueOffsets:d},e)=>8+If.visit(b[a.typeIdToChildIndex[c[e]]],d[e]),Kf=({children:a},b)=>4+If.visitMany(a,a.map(()=>b)).reduce(Gf,0);h=Hf.prototype;h.visitUtf8=({valueOffsets:a},b)=>8+(a[b+1]-a[b]);h.visitBinary=({valueOffsets:a},b)=>8+(a[b+1]-a[b]);
h.visitList=({valueOffsets:a,stride:b,children:c},d)=>{var e=c[0];({[d*b]:c}=a);({[d*b+1]:a}=a);b=If.getVisitFn(e.type);e=e.slice(c,a-c);d=8;for(let f=-1,g=a-c;++f<g;)d+=b(e,f);return d};h.visitFixedSizeList=({stride:a,children:b},c)=>{b=b[0];a=b.slice(c*a,a);c=If.getVisitFn(b.type);b=0;for(let d=-1,e=a.length;++d<e;)b+=c(a,d);return b};h.visitUnion=(a,b)=>a.type.mode===x.Dense?Jf(a,b):Kf(a,b);h.visitDenseUnion=Jf;h.visitSparseUnion=Kf;const If=new Hf;const Lf={},Mf={};
class F{constructor(a){a=a[0]instanceof F?a.flatMap(f=>f.data):a;if(0===a.length||a.some(f=>!(f instanceof H)))throw new TypeError("Vector constructor expects an Array of Data instances.");let b;const c=null==(b=a[0])?void 0:b.type;switch(a.length){case 0:this.m=[0];break;case 1:const {get:f,set:g,indexOf:k,byteLength:m}=Lf[c.typeId],p=a[0];this.isValid=r=>p.getValid(r);this.get=r=>f(p,r);this.set=(r,R)=>g(p,r,R);this.indexOf=r=>k(p,r);this.getByteLength=r=>m(p,r);this.m=[0,p.length];break;default:Object.setPrototypeOf(this,
Mf[c.typeId]),this.m=tf(a)}this.data=a;this.type=c;this.stride=td(c);let d,e;this.numChildren=null!=(e=null==(d=c.children)?void 0:d.length)?e:0;this.length=this.m.at(-1)}get byteLength(){return this.data.reduce((a,b)=>a+b.byteLength,0)}get nullCount(){return sf(this.data)}get ArrayType(){return this.type.ArrayType}get [Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${B[this.type.typeId]}Vector`}isValid(){return!1}get(){return null}set(){}indexOf(){return-1}includes(a,
b){return-1<this.indexOf(a,b)}getByteLength(){return 0}[Symbol.iterator](){return Ff.visit(this)}concat(...a){return new F(this.data.concat(a.flatMap(b=>b.data).flat(Number.POSITIVE_INFINITY)))}slice(a,b){return new F(Ue(this,a,b,({data:c,m:d},e,f)=>uf(c,d,e,f)))}toJSON(){return[...this]}toArray(){const a=this.data,b=this.length,c=this.stride,d=this.ArrayType;switch(this.type.typeId){case B.Int:case B.Float:case B.Decimal:case B.Time:case B.Timestamp:switch(a.length){case 0:return new d;case 1:return a[0].values.subarray(0,
b*c);default:return a.reduce((e,{values:f,length:g})=>{e.ub.set(f.subarray(0,g*c),e.offset);e.offset+=g*c;return e},{ub:new d(b*c),offset:0}).ub}}return[...this]}toString(){return`[${[...this].join()}]`}getChild(a){let b;return this.getChildAt(null==(b=this.type.children)?void 0:b.findIndex(c=>c.name===a))}getChildAt(a){return-1<a&&a<this.numChildren?new F(this.data.map(({children:b})=>b[a])):null}get isMemoized(){return D.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(D.isDictionary(this.type)){const a=
new Nf(this.data[0].dictionary),b=this.data.map(c=>{c=c.clone();c.dictionary=a;return c});return new F(b)}return new Nf(this)}unmemoize(){if(D.isDictionary(this.type)&&this.isMemoized){const a=this.data[0].dictionary.unmemoize(),b=this.data.map(c=>{c=c.clone();c.dictionary=a;return c});return new F(b)}return this}}
F[Symbol.toStringTag]=(a=>{a.type=D.prototype;a.data=[];a.length=0;a.stride=1;a.numChildren=0;a.m=new Uint32Array([0]);a[Symbol.isConcatSpreadable]=!0;var b=Object.keys(B).map(c=>B[c]).filter(c=>"number"===typeof c&&c!==B.NONE);for(const c of b){b=qe.getVisitFnByTypeId(c);const d=be.getVisitFnByTypeId(c),e=Cf.getVisitFnByTypeId(c),f=If.getVisitFnByTypeId(c);Lf[c]={get:b,set:d,indexOf:e,byteLength:f};Mf[c]=Object.create(a,{isValid:{value:xf(wf)},get:{value:xf(qe.getVisitFnByTypeId(c))},set:{value:yf(be.getVisitFnByTypeId(c))},
indexOf:{value:zf(Cf.getVisitFnByTypeId(c))},getByteLength:{value:xf(If.getVisitFnByTypeId(c))}})}return"Vector"})(F.prototype);
class Nf extends F{constructor(a){super(a.data);const b=this.get,c=this.set,d=this.slice,e=Array(this.length);Object.defineProperty(this,"get",{value(f){var g=e[f];if(void 0!==g)return g;g=b.call(this,f);return e[f]=g}});Object.defineProperty(this,"set",{value(f,g){c.call(this,f,g);e[f]=g}});Object.defineProperty(this,"slice",{value:(f,g)=>new Nf(d.call(this,f,g))});Object.defineProperty(this,"isMemoized",{value:!0});Object.defineProperty(this,"unmemoize",{value:()=>new F(this.data)});Object.defineProperty(this,
"memoize",{value:()=>this})}}
function Of(a){if(a){if(a instanceof H)return new F([a]);if(a instanceof F)return new F(a.data);if(a.type instanceof D)return new F([I(a)]);if(Array.isArray(a))return new F(a.flatMap(b=>b instanceof H?[b]:b instanceof F?b.data:Of(b).data));if(ArrayBuffer.isView(a)){a instanceof DataView&&(a=new Uint8Array(a.buffer));const b={offset:0,length:a.length,nullCount:0,data:a};if(a instanceof Int8Array)return new F([I(Object.assign({},b,{type:new zb}))]);if(a instanceof Int16Array)return new F([I(Object.assign({},b,
{type:new Ab}))]);if(a instanceof Int32Array)return new F([I(Object.assign({},b,{type:new Bb}))]);if(a instanceof BigInt64Array)return new F([I(Object.assign({},b,{type:new Cb}))]);if(a instanceof Uint8Array||a instanceof Uint8ClampedArray)return new F([I(Object.assign({},b,{type:new Db}))]);if(a instanceof Uint16Array)return new F([I(Object.assign({},b,{type:new Eb}))]);if(a instanceof Uint32Array)return new F([I(Object.assign({},b,{type:new Hb}))]);if(a instanceof BigUint64Array)return new F([I(Object.assign({},
b,{type:new Ib}))]);if(a instanceof Float32Array)return new F([I(Object.assign({},b,{type:new Ob}))]);if(a instanceof Float64Array)return new F([I(Object.assign({},b,{type:new Pb}))])}}throw Error("Unrecognized input");};function Pf(a){if(!a||0>=a.length)return function(){return!0};let b="";const c=a.filter(d=>d===d);0<c.length&&(b=`
    switch (x) {${c.map(d=>`
        case ${"bigint"!==typeof d?db(d):`${db(d)}n`}:`).join("")}
            return false;
    }`);a.length!==c.length&&(b=`if (x !== x) return false;\n${b}`);return new Function("x",`${b}\nreturn true;`)};const Qf=(a,b)=>(Math.ceil(a)*b+63&-64||64)/b,Rf=(a,b=0)=>a.length>=b?a.subarray(0,b):Da(new a.constructor(b),a,0);function Sf(a,b){a.buffer=Da(new a.ArrayType(b),a.buffer)}function Tf(a,b){if(0<b){a.length+=b;b=a.length*a.stride;const c=a.buffer.length;b>=c&&Sf(a,0===c?Qf(1*b,a.BYTES_PER_ELEMENT):Qf(2*b,a.BYTES_PER_ELEMENT))}return a}
class Uf{constructor(a,b=1){this.buffer=a;this.stride=b;this.BYTES_PER_ELEMENT=a.BYTES_PER_ELEMENT;this.ArrayType=a.constructor;Sf(this,this.length=Math.ceil(a.length/b))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(){return this}append(a){return this.set(this.length,a)}flush(a=this.length){a=Qf(a*this.stride,this.BYTES_PER_ELEMENT);a=Rf(this.buffer,
a);this.clear();return a}clear(){this.length=0;Sf(this,0);return this}}Uf.prototype.offset=0;class Vf extends Uf{get(a){return this.buffer[a]}set(a,b){Tf(this,a-this.length+1);this.buffer[a*this.stride]=b;return this}}
class Wf extends Vf{constructor(){super(new Uint8Array(0),.125);this.Ka=0}get Wb(){return this.length-this.Ka}get(a){return this.buffer[a>>3]>>a%8&1}set(a,b){const {buffer:c}=Tf(this,a-this.length+1),d=a>>3;a%=8;const e=c[d]>>a&1;b?0===e&&(c[d]|=1<<a,++this.Ka):1===e&&(c[d]&=~(1<<a),--this.Ka);return this}clear(){this.Ka=0;return super.clear()}}
class Xf extends Vf{constructor(){super(new Int32Array(1),1)}append(a){return this.set(this.length-1,a)}set(a,b){const c=this.length-1,d=Tf(this,a-c+1).buffer;c<a++&&d.fill(d[c],c,a);d[a]=d[a-1]+b;return this}flush(a=this.length-1){a>this.length&&this.set(a-1,0);return super.flush(a+1)}};class Yf{static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}constructor({type:a,nullValues:b}){this.length=0;this.finished=!1;this.type=a;this.children=[];this.nullValues=b;this.stride=td(a);this.I=new Wf;b&&0<b.length&&(this.ob=Pf(b))}toVector(){return new F([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this.I.Wb}get numChildren(){return this.children.length}get byteLength(){let a=
0;const b=this.m,c=this.v,d=this.I,e=this.Y,f=this.children;b&&(a+=b.byteLength);c&&(a+=c.byteLength);d&&(a+=d.byteLength);e&&(a+=e.byteLength);return f.reduce((g,k)=>g+k.byteLength,a)}get reservedLength(){return this.I.reservedLength}get reservedByteLength(){let a=0;this.m&&(a+=this.m.reservedByteLength);this.v&&(a+=this.v.reservedByteLength);this.I&&(a+=this.I.reservedByteLength);this.Y&&(a+=this.Y.reservedByteLength);return this.children.reduce((b,c)=>b+c.reservedByteLength,a)}get valueOffsets(){return this.m?
this.m.buffer:null}get values(){return this.v?this.v.buffer:null}get nullBitmap(){return this.I?this.I.buffer:null}get typeIds(){return this.Y?this.Y.buffer:null}append(a){return this.set(this.length,a)}isValid(a){return this.ob(a)}set(a,b){this.setValid(a,this.isValid(b))&&this.setValue(a,b);return this}setValue(a,b){this.A(this,a,b)}setValid(a,b){this.length=this.I.set(a,+b).length;return b}addChild(){throw Error(`Cannot append children to non-nested type "${this.type}"`);}getChildAt(a){return this.children[a]||
null}flush(){let a,b,c,d;const e=this.type,f=this.length,g=this.nullCount;var k=this.m;const m=this.v,p=this.I;let r;(b=null==(r=this.Y)?void 0:r.flush(f))?d=null==k?void 0:k.flush(f):a=(d=null==k?void 0:k.flush(f))?null==m?void 0:m.flush(k.get(k.length-1)):null==m?void 0:m.flush(f);0<g&&(c=null==p?void 0:p.flush(f));k=this.children.map(R=>R.flush());this.clear();return I({type:e,length:f,nullCount:g,children:k,child:k[0],data:a,typeIds:b,nullBitmap:c,valueOffsets:d})}finish(){this.finished=!0;for(const a of this.children)a.finish();
return this}clear(){this.length=0;let a;null==(a=this.I)||a.clear();let b;null==(b=this.v)||b.clear();let c;null==(c=this.m)||c.clear();let d;null==(d=this.Y)||d.clear();for(const e of this.children)e.clear();return this}}h=Yf.prototype;h.length=1;h.stride=1;h.children=null;h.finished=!1;h.nullValues=null;h.ob=()=>!0;class Zf extends Yf{constructor(a){super(a);this.v=new Vf(new this.ArrayType(0),this.stride)}setValue(a,b){const c=this.v;Tf(c,a-c.length+1);return super.setValue(a,b)}}
function $f(a){const b=a.D,c=a.M;a.M=0;a.D=void 0;b&&0<b.size&&a.fa(b,c)}class ag extends Yf{constructor(a){super(a);this.M=0;this.m=new Xf}setValue(a,b){const c=this.D||(this.D=new Map),d=c.get(a);d&&(this.M-=d.length);this.M+=b instanceof Oe?b[Pe].length:b.length;c.set(a,b)}setValid(a,b){return super.setValid(a,b)?!0:((this.D||(this.D=new Map)).set(a,void 0),!1)}clear(){this.M=0;this.D=void 0;return super.clear()}flush(){$f(this);return super.flush()}finish(){$f(this);return super.finish()}};class bg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return cg(this.g,this.h)}ab(){return this.g.s(this.h+8)}bodyLength(){return cg(this.g,this.h+16)}};const dg=new Int32Array(2);new Float32Array(dg.buffer);new Float64Array(dg.buffer);new Uint16Array((new Uint8Array([1,0])).buffer);var eg,fg=eg||(eg={});fg[fg.UTF8_BYTES=1]="UTF8_BYTES";fg[fg.UTF16_STRING=2]="UTF16_STRING";function cg(a,b){return BigInt.asIntN(64,BigInt(a.s(b)>>>0)+(BigInt(a.s(b+4)>>>0)<<BigInt(32)))}function gg(a,b){return(a.j[b]|a.j[b+1]<<8)<<16>>16}function L(a,b,c){b-=a.s(b);return c<gg(a,b)?gg(a,b+c):0}function hg(a,b,c){b.h=c+a.s(c);b.g=a;return b}function ig(a,b,c){b+=a.s(b);const d=a.s(b);b+=4;b=a.j.subarray(b,b+d);return c===eg.UTF8_BYTES?b:a.Yb.decode(b)}function jg(a,b){return b+a.s(b)}function kg(a,b){return b+a.s(b)+4}function lg(a,b){return a.s(b+a.s(b))}
class mg{constructor(a){this.j=a;this.eb=0;this.Yb=new TextDecoder}clear(){this.eb=0}S(){return this.j}position(){return this.eb}setPosition(a){this.eb=a}s(a){return this.j[a]|this.j[a+1]<<8|this.j[a+2]<<16|this.j[a+3]<<24}la(a,b){this.j[a]=b}jb(a,b){this.j[a]=b;this.j[a+1]=b>>8}W(a,b){this.j[a]=b;this.j[a+1]=b>>8;this.j[a+2]=b>>16;this.j[a+3]=b>>24}$(a,b){this.W(a,Number(BigInt.asIntN(32,b)));this.W(a+4,Number(BigInt.asIntN(32,b>>BigInt(32))))}};function ng(a,b,c){b>a.va&&(a.va=b);const d=~(a.g.j.length-a.B+c)+1&b-1;for(;a.B<d+b+c;){const g=a.g.j.length;var e=a,f=a.g;const k=f.j.length;if(k&3221225472)throw Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const m=k<<1,p=new mg(new Uint8Array(m));p.setPosition(m-k);p.S().set(f.S(),m-k);e.g=p;a.B+=a.g.j.length-g}og(a,d)}function og(a,b){for(let c=0;c<b;c++)a.g.la(--a.B,0)}function pg(a){return a.g.S().subarray(a.g.position(),a.g.position()+a.offset())}
function qg(a,b){ng(a,2,0);a.jb(b)}function rg(a,b){ng(a,4,0);a.W(b)}function sg(a,b,c,d){if(a.ga||c!=d)ng(a,1,0),a.la(c),a.slot(b)}function tg(a,b,c){if(a.ga||b!=c)qg(a,b),a.slot(0)}function ug(a,b,c,d){if(a.ga||c!=d)rg(a,c),a.slot(b)}function vg(a,b,c){var d=BigInt("0");if(a.ga||c!==d)ng(a,8,0),a.$(c),a.slot(b)}function wg(a,b){ng(a,4,0);a.W(a.offset()-b+4)}function M(a,b,c){if(a.ga||0!=c)wg(a,c),a.slot(b)}
function xg(a){if(a.ua)throw new TypeError("FlatBuffers: object serialization must not be nested.");}function N(a,b){xg(a);null==a.V&&(a.V=[]);a.ib=b;for(let c=0;c<b;c++)a.V[c]=0;a.ua=!0;a.cb=a.offset()}
function O(a){if(null==a.V||!a.ua)throw Error("FlatBuffers: endObject called without startObject");rg(a,0);const b=a.offset();let c=a.ib-1;for(;0<=c&&0==a.V[c];c--);for(var d=c+1;0<=c;c--)qg(a,0!=a.V[c]?b-a.V[c]:0);qg(a,b-a.cb);d=2*(d+2);qg(a,d);let e=0;const f=a.B;c=0;a:for(;c<a.wa.length;c++){const g=a.g.j.length-a.wa[c];if(d==gg(a.g,g)){for(let k=2;k<d;k+=2)if(gg(a.g,f+k)!=gg(a.g,g+k))continue a;e=a.wa[c];break}}e?(a.B=a.g.j.length-b,a.g.W(a.B,e-b)):(a.wa.push(a.offset()),a.g.W(a.g.j.length-b,
a.offset()-b));a.ua=!1;return b}function yg(a,b,c,d){xg(a);a.hb=c;ng(a,4,b*c);ng(a,d,b*c)}function zg(a){a.W(a.hb);return a.offset()}function Ag(a,b){if(null===b||void 0===b)return 0;b=b instanceof Uint8Array?b:a.Zb.encode(b);ng(a,1,0);a.la(0);yg(a,1,b.length,1);a.g.setPosition(a.B-=b.length);for(let c=0,d=a.B,e=a.g.S();c<b.length;c++)e[d++]=b[c];return zg(a)}
class Bg{constructor(){this.va=1;this.V=null;this.ib=0;this.ua=!1;this.cb=0;this.wa=[];this.hb=0;this.ga=!1;this.Zb=new TextEncoder;this.g=new mg(new Uint8Array(1024));this.B=1024}clear(){this.g.clear();this.B=this.g.j.length;this.va=1;this.V=null;this.ib=0;this.ua=!1;this.cb=0;this.wa=[];this.hb=0;this.ga=!1}la(a){this.g.la(--this.B,a)}jb(a){this.g.jb(this.B-=2,a)}W(a){this.g.W(this.B-=4,a)}$(a){this.g.$(this.B-=8,a)}slot(a){null!==this.V&&(this.V[a]=this.offset())}offset(){return this.g.j.length-
this.B}finish(a,b,c){c=c?4:0;if(b){ng(this,this.va,8+c);if(4!=b.length)throw new TypeError("FlatBuffers: file identifier must be length 4");for(let d=3;0<=d;d--)this.la(b.charCodeAt(d))}ng(this,this.va,4+c);wg(this,a);c&&rg(this,this.g.j.length-this.B);this.g.setPosition(this.B)}};class Cg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}key(a){const b=L(this.g,this.h,4);return b?ig(this.g,this.h+b,a):null}value(a){const b=L(this.g,this.h,6);return b?ig(this.g,this.h+b,a):null}};var Dg,Eg=Dg||(Dg={});Eg[Eg.V1=0]="V1";Eg[Eg.V2=1]="V2";Eg[Eg.V3=2]="V3";Eg[Eg.V4=3]="V4";Eg[Eg.V5=4]="V5";var Fg,Gg=Fg||(Fg={});Gg[Gg.Little=0]="Little";Gg[Gg.Big=1]="Big";var Hg,Ig=Hg||(Hg={});Ig[Ig.DenseArray=0]="DenseArray";class Jg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}bitWidth(){const a=L(this.g,this.h,4);return a?this.g.s(this.h+a):0}isSigned(){const a=L(this.g,this.h,6);return a?!!(this.g.j[this.h+a]<<24>>24):!1}};function Kg(a){const b=L(a.g,a.h,6);return b?(new Jg).i(jg(a.g,a.h+b),a.g):null}class Lg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=L(this.g,this.h,4);return a?cg(this.g,this.h+a):BigInt("0")}isOrdered(){const a=L(this.g,this.h,8);return a?!!(this.g.j[this.h+a]<<24>>24):!1}};var Mg,Ng=Mg||(Mg={});Ng[Ng.DAY=0]="DAY";Ng[Ng.MILLISECOND=1]="MILLISECOND";class Og{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):Mg.MILLISECOND}};class Pg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=L(this.g,this.h,4);return a?this.g.s(this.h+a):0}scale(){const a=L(this.g,this.h,6);return a?this.g.s(this.h+a):0}bitWidth(){const a=L(this.g,this.h,8);return a?this.g.s(this.h+a):128}};var Qg,Rg=Qg||(Qg={});Rg[Rg.SECOND=0]="SECOND";Rg[Rg.MILLISECOND=1]="MILLISECOND";Rg[Rg.MICROSECOND=2]="MICROSECOND";Rg[Rg.NANOSECOND=3]="NANOSECOND";class Sg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):Qg.MILLISECOND}};class Tg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}byteWidth(){const a=L(this.g,this.h,4);return a?this.g.s(this.h+a):0}};class Ug{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}listSize(){const a=L(this.g,this.h,4);return a?this.g.s(this.h+a):0}};var Vg,Wg=Vg||(Vg={});Wg[Wg.HALF=0]="HALF";Wg[Wg.SINGLE=1]="SINGLE";Wg[Wg.DOUBLE=2]="DOUBLE";class Xg{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):Vg.HALF}};var Yg,Zg=Yg||(Yg={});Zg[Zg.YEAR_MONTH=0]="YEAR_MONTH";Zg[Zg.DAY_TIME=1]="DAY_TIME";Zg[Zg.MONTH_DAY_NANO=2]="MONTH_DAY_NANO";class $g{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):Yg.YEAR_MONTH}};class ah{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}keysSorted(){const a=L(this.g,this.h,4);return a?!!(this.g.j[this.h+a]<<24>>24):!1}};class bh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):Qg.MILLISECOND}bitWidth(){const a=L(this.g,this.h,6);return a?this.g.s(this.h+a):32}};class ch{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):Qg.SECOND}timezone(a){const b=L(this.g,this.h,6);return b?ig(this.g,this.h+b,a):null}};var dh,eh=dh||(dh={});eh[eh.Sparse=0]="Sparse";eh[eh.Dense=1]="Dense";class fh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}mode(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):dh.Sparse}typeIds(a){const b=L(this.g,this.h,6);return b?this.g.s(kg(this.g,this.h+b)+4*a):0}};var P,Q=P||(P={});Q[Q.NONE=0]="NONE";Q[Q.Null=1]="Null";Q[Q.Int=2]="Int";Q[Q.FloatingPoint=3]="FloatingPoint";Q[Q.Binary=4]="Binary";Q[Q.Utf8=5]="Utf8";Q[Q.Bool=6]="Bool";Q[Q.Decimal=7]="Decimal";Q[Q.Date=8]="Date";Q[Q.Time=9]="Time";Q[Q.Timestamp=10]="Timestamp";Q[Q.Interval=11]="Interval";Q[Q.List=12]="List";Q[Q.Struct_=13]="Struct_";Q[Q.Union=14]="Union";Q[Q.FixedSizeBinary=15]="FixedSizeBinary";Q[Q.FixedSizeList=16]="FixedSizeList";Q[Q.Map=17]="Map";Q[Q.Duration=18]="Duration";
Q[Q.LargeBinary=19]="LargeBinary";Q[Q.LargeUtf8=20]="LargeUtf8";Q[Q.LargeList=21]="LargeList";Q[Q.RunEndEncoded=22]="RunEndEncoded";function gh(a,b){yg(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)wg(a,b[c]);return zg(a)}function hh(a,b){yg(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)wg(a,b[c]);return zg(a)}function ih(a){const b=L(a.g,a.h,14);return b?lg(a.g,a.h+b):0}
class jh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}name(a){const b=L(this.g,this.h,4);return b?ig(this.g,this.h+b,a):null}nullable(){const a=L(this.g,this.h,6);return a?!!(this.g.j[this.h+a]<<24>>24):!1}type(a){const b=L(this.g,this.h,10);return b?hg(this.g,a,this.h+b):null}dictionary(a){const b=L(this.g,this.h,12);return b?(a||new Lg).i(jg(this.g,this.h+b),this.g):null}children(a,b){const c=L(this.g,this.h,14);return c?(b||new jh).i(jg(this.g,kg(this.g,this.h+c)+4*a),
this.g):null}Fa(a){const b=L(this.g,this.h,16);return b?(new Cg).i(jg(this.g,kg(this.g,this.h+b)+4*a),this.g):null}Ga(){const a=L(this.g,this.h,16);return a?lg(this.g,this.h+a):0}};function kh(a,b){yg(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)wg(a,b[c]);return zg(a)}function lh(a,b){yg(a,4,b.length,4);for(let c=b.length-1;0<=c;c--)wg(a,b[c]);return zg(a)}function mh(a){const b=L(a.g,a.h,6);return b?lg(a.g,a.h+b):0}
class nh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}fields(a,b){const c=L(this.g,this.h,6);return c?(b||new jh).i(jg(this.g,kg(this.g,this.h+c)+4*a),this.g):null}Fa(a){const b=L(this.g,this.h,8);return b?(new Cg).i(jg(this.g,kg(this.g,this.h+b)+4*a),this.g):null}Ga(){const a=L(this.g,this.h,8);return a?lg(this.g,this.h+a):0}features(a){const b=L(this.g,this.h,10);return b?cg(this.g,kg(this.g,this.h+b)+8*a):BigInt(0)}};class oh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):Dg.V1}schema(a){const b=L(this.g,this.h,6);return b?(a||new nh).i(jg(this.g,this.h+b),this.g):null}dictionaries(a,b){const c=L(this.g,this.h,8);return c?(b||new bg).i(kg(this.g,this.h+c)+24*a,this.g):null}gb(a){const b=L(this.g,this.h,10);return b?(new bg).i(kg(this.g,this.h+b)+24*a,this.g):null}Fa(a){const b=L(this.g,this.h,12);return b?(new Cg).i(jg(this.g,
kg(this.g,this.h+b)+4*a),this.g):null}Ga(){const a=L(this.g,this.h,12);return a?lg(this.g,this.h+a):0}};class S{constructor(a=[],b,c,d=w.V5){this.fields=a||[];this.metadata=b||new Map;c||(c=ph(a));this.dictionaries=c;this.Ja=d}get [Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(a=>a.name)}toString(){return`Schema<{ ${this.fields.map((a,b)=>`${b}: ${a}`).join(", ")} }>`}select(a){const b=new Set(a);a=this.fields.filter(c=>b.has(c.name));return new S(a,this.metadata)}selectAt(a){a=a.map(b=>this.fields[b]).filter(Boolean);return new S(a,this.metadata)}assign(...a){var b=a[0]instanceof
S?a[0]:Array.isArray(a[0])?new S(a[0]):new S(a);const c=[...this.fields];a=qh(qh(new Map,this.metadata),b.metadata);b=b.fields.filter(e=>{const f=c.findIndex(g=>g.name===e.name);return~f?(c[f]=e.clone({metadata:qh(qh(new Map,c[f].metadata),e.metadata)}))&&!1:!0});const d=ph(b,new Map);return new S([...c,...b],a,new Map([...this.dictionaries,...d]))}}S.prototype.fields=null;S.prototype.metadata=null;S.prototype.dictionaries=null;
class T{static new(...a){let [b,c,d,e]=a;a[0]&&"object"===typeof a[0]&&({name:b}=a[0],void 0===c&&(c=a[0].type),void 0===d&&(d=a[0].nullable),void 0===e&&(e=a[0].metadata));return new T(`${b}`,c,d,e)}constructor(a,b,c=!1,d){this.name=a;this.type=b;this.nullable=c;this.metadata=d||new Map}get typeId(){return this.type.typeId}get [Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...a){let [b,c,d,e]=a;a[0]&&"object"===typeof a[0]?{name:b=this.name,type:c=this.type,
nullable:d=this.nullable,metadata:e=this.metadata}=a[0]:[b=this.name,c=this.type,d=this.nullable,e=this.metadata]=a;return T.new(b,c,d,e)}}T.prototype.type=null;T.prototype.name=null;T.prototype.nullable=null;T.prototype.metadata=null;function qh(a,b){return new Map([...(a||new Map),...(b||new Map)])}
function ph(a,b=new Map){for(let c=-1,d=a.length;++c<d;){const e=a[c].type;if(D.isDictionary(e))if(!b.has(e.id))b.set(e.id,e.dictionary);else if(b.get(e.id)!==e.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id");e.children&&0<e.children.length&&ph(e.children,b)}return b};function*rh(a){for(let b,c=-1,d=a.numDictionaries;++c<d;)if(b=a.Ha(c))yield b}
class sh{static decode(a){a=new mg(u(Uint8Array,a));a=(new oh).i(a.s(a.position())+a.position(),a);const b=S.decode(a.schema(),new Map,a.version());return new th(b,a)}static encode(a){const b=new Bg;var c=S.encode(b,a.schema);yg(b,24,a.numRecordBatches,8);for(var d of[...a.gb()].slice().reverse())uh.encode(b,d);d=zg(b);yg(b,24,a.numDictionaries,8);for(const e of[...rh(a)].slice().reverse())uh.encode(b,e);a=zg(b);N(b,5);M(b,1,c);tg(b,w.V5,Dg.V1);M(b,3,d);M(b,2,a);c=O(b);b.finish(c);return pg(b)}get numRecordBatches(){return this.aa.length}get numDictionaries(){return this.mb.length}constructor(a,
b=w.V5,c,d){this.schema=a;this.version=b;c&&(this.aa=c);d&&(this.mb=d)}*gb(){for(let a,b=-1,c=this.numRecordBatches;++b<c;)if(a=this.ha(b))yield a}ha(a){return 0<=a&&a<this.numRecordBatches&&this.aa[a]||null}Ha(a){return 0<=a&&a<this.numDictionaries&&this.mb[a]||null}}
class th extends sh{get numRecordBatches(){var a=this.l;const b=L(a.g,a.h,10);return b?lg(a.g,a.h+b):0}get numDictionaries(){var a=this.l;const b=L(a.g,a.h,8);return b?lg(a.g,a.h+b):0}constructor(a,b){super(a,b.version());this.l=b}ha(a){return 0<=a&&a<this.numRecordBatches&&(a=this.l.gb(a))?uh.decode(a):null}Ha(a){return 0<=a&&a<this.numDictionaries&&(a=this.l.dictionaries(a))?uh.decode(a):null}}
class uh{static decode(a){return new uh(a.ab(),a.bodyLength(),a.offset())}static encode(a,b){var c=BigInt(b.offset),d=b.ab;b=BigInt(b.bodyLength);ng(a,8,24);a.$(BigInt(null!=b?b:0));og(a,4);a.W(d);a.$(BigInt(null!=c?c:0));return a.offset()}constructor(a,b,c){this.ab=a;this.offset=qb(c);this.bodyLength=qb(b)}};const U=Object.freeze({done:!0,value:void 0});class vh{constructor(a){this.pa=a}get schema(){return this.pa.schema}get batches(){return this.pa.batches||[]}get dictionaries(){return this.pa.dictionaries||[]}}function wh(a){return a.kb||(a.kb=a.toDOMStream())}function xh(a,b,c){return xh(a.qb||(a.qb=a.toNodeStream()),b,c)}class yh{tee(){return wh(this).tee()}pipeTo(a,b){return wh(this).pipeTo(a,b)}pipeThrough(a,b){return wh(this).pipeThrough(a,b)}}
class zh extends yh{constructor(){super();this.v=[];this.ka=[];this.Na=new Promise(a=>this.K=a)}get closed(){return this.Na}cancel(a){const b=this;return l(function*(){yield b.return(a)})}write(a){if(!this.K)throw Error("AsyncQueue is closed");0>=this.ka.length?this.v.push(a):this.ka.shift().resolve({done:!1,value:a})}abort(a){this.K&&(0>=this.ka.length?this.Pa={error:a}:this.ka.shift().reject({done:!0,value:a}))}close(){if(this.K){const a=this.ka;for(;0<a.length;)a.shift().resolve(U);this.K();this.K=
void 0}}[Symbol.asyncIterator](){return this}toDOMStream(a){return Ka(this.K||this.Pa?this:this.v,a)}toNodeStream(){return La()}throw(a){const b=this;return l(function*(){yield b.abort(a);return U})}return(){const a=this;return l(function*(){yield a.close();return U})}read(a){const b=this;return l(function*(){return(yield b.next(a,"read")).value})}peek(a){const b=this;return l(function*(){return(yield b.next(a,"peek")).value})}next(){return 0<this.v.length?Promise.resolve({done:!1,value:this.v.shift()}):
this.Pa?Promise.reject({done:!0,value:this.Pa.error}):this.K?new Promise((a,b)=>{this.ka.push({resolve:a,reject:b})}):Promise.resolve(U)}};class Ah extends zh{write(a){if(0<(a=u(Uint8Array,a)).byteLength)return super.write(a)}toString(a=!1){return a?va.decode(this.toUint8Array(!0)):this.toUint8Array(!1).then(wa)}toUint8Array(a=!1){return a?Ea(this.v)[0]:(()=>{const b=this;return l(function*(){const c=[];let d=0;var e;try{for(var f=ia(b);;){var g=yield f.next();if(g.done)break;const m=g.value;c.push(m);d+=m.byteLength}}catch(m){var k={error:m}}finally{try{g&&!g.done&&(e=f.return)&&(yield e.call(f))}finally{if(k)throw k.error;}}return Ea(c,
d)[0]})})()}}class Bh{constructor(a){a&&(this.source=new Ch(Ma(Na(a))))}[Symbol.iterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class Dh{constructor(a){a instanceof Dh?this.source=a.source:a instanceof Ah?this.source=new Eh(Ma(Oa(a))):Aa(a)?this.source=new Eh(Ma(Sa(a))):za(a)?this.source=new Eh(Ma(Pa(a))):t(a)&&za(a.body)?this.source=new Eh(Ma(Pa(a.body))):t(a)&&q(a[Symbol.iterator])?this.source=new Eh(Ma(Na(a))):t(a)&&q(a.then)?this.source=new Eh(Ma(Oa(a))):t(a)&&q(a[Symbol.asyncIterator])&&(this.source=new Eh(Ma(Oa(a))))}[Symbol.asyncIterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}get closed(){return this.source.closed}cancel(a){return this.source.cancel(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class Ch{constructor(a){this.source=a}cancel(a){this.return(a)}peek(a){return this.next(a,"peek").value}read(a){return this.next(a,"read").value}next(a,b="read"){return this.source.next({Z:b,size:a})}throw(a){return Object.create(this.source.throw&&this.source.throw(a)||U)}return(a){return Object.create(this.source.return&&this.source.return(a)||U)}}
class Eh{constructor(a){this.source=a;this.Na=new Promise(b=>this.K=b)}cancel(a){const b=this;return l(function*(){yield b.return(a)})}get closed(){return this.Na}read(a){const b=this;return l(function*(){return(yield b.next(a,"read")).value})}peek(a){const b=this;return l(function*(){return(yield b.next(a,"peek")).value})}next(a,b="read"){const c=this;return l(function*(){return yield c.source.next({Z:b,size:a})})}throw(a){const b=this;return l(function*(){const c=b.source.throw&&(yield b.source.throw(a))||
U;b.K&&b.K();b.K=void 0;return Object.create(c)})}return(a){const b=this;return l(function*(){const c=b.source.return&&(yield b.source.return(a))||U;b.K&&b.K();b.K=void 0;return Object.create(c)})}};class Fh extends Bh{constructor(a){super();this.position=0;this.buffer=u(Uint8Array,a);this.size=this.buffer.byteLength}s(a){const {buffer:b,byteOffset:c}=this.ia(a,4);return(new DataView(b,c)).getInt32(0,!0)}seek(a){this.position=Math.min(a,this.size);return a<this.size}read(a){const b=this.buffer,c=this.size,d=this.position;return b&&d<c?("number"!==typeof a&&(a=Number.POSITIVE_INFINITY),this.position=Math.min(c,d+Math.min(c-d,a)),b.subarray(d,this.position)):null}ia(a,b){const c=this.buffer,d=
Math.min(this.size,a+b);return c?c.subarray(a,d):new Uint8Array(b)}close(){this.buffer&&(this.buffer=null)}throw(a){this.close();return{done:!0,value:a}}return(a){this.close();return{done:!0,value:a}}}
class Gh extends Dh{constructor(a,b){super();this.position=0;this.H=a;"number"===typeof b?this.size=b:this.D=(()=>{const c=this;return l(function*(){c.size=(yield a.stat()).size;delete c.D})})()}s(a){const b=this;return l(function*(){const {buffer:c,byteOffset:d}=yield b.ia(a,4);return(new DataView(c,d)).getInt32(0,!0)})}seek(a){const b=this;return l(function*(){b.D&&(yield b.D);b.position=Math.min(a,b.size);return a<b.size})}read(a){const b=this;return l(function*(){b.D&&(yield b.D);const c=b.H;
var d=b.size,e=b.position;if(c&&e<d){"number"!==typeof a&&(a=Number.POSITIVE_INFINITY);let f=0,g=0;d=Math.min(d,e+Math.min(d-e,a));const k=new Uint8Array(Math.max(0,(b.position=d)-e));for(;(e+=g)<d&&(f+=g)<k.byteLength;)({cc:g}=yield c.read(k,f,k.byteLength-f,e));return k}return null})}ia(a,b){const c=this;return l(function*(){c.D&&(yield c.D);const d=c.H;var e=c.size;return d&&a+b<e?(e=new Uint8Array(Math.min(e,a+b)-a),(yield d.read(e,0,b,a)).buffer):new Uint8Array(b)})}close(){const a=this;return l(function*(){const b=
a.H;a.H=null;b&&(yield b.close())})}throw(a){const b=this;return l(function*(){yield b.close();return{done:!0,value:a}})}return(a){const b=this;return l(function*(){yield b.close();return{done:!0,value:a}})}};function Hh(a){0>a&&(a=4294967295+a+1);return`0x${a.toString(16)}`}const Ih=[1,10,100,1E3,1E4,1E5,1E6,1E7,1E8];
function Jh(a,b){const c=new Uint32Array([a.buffer[1]>>>16,a.buffer[1]&65535,a.buffer[0]>>>16,a.buffer[0]&65535]);b=new Uint32Array([b.buffer[1]>>>16,b.buffer[1]&65535,b.buffer[0]>>>16,b.buffer[0]&65535]);let d=c[3]*b[3];a.buffer[0]=d&65535;let e=d>>>16;d=c[2]*b[3];e+=d;d=c[3]*b[2]>>>0;e+=d;a.buffer[0]+=e<<16;a.buffer[1]=e>>>0<d?65536:0;a.buffer[1]+=e>>>16;a.buffer[1]+=c[1]*b[3]+c[2]*b[2]+c[3]*b[1];a.buffer[1]+=c[0]*b[3]+c[1]*b[2]+c[2]*b[1]+c[3]*b[0]<<16}
function Kh(a,b){const c=a.buffer[0]+b.buffer[0]>>>0;a.buffer[1]+=b.buffer[1];c<a.buffer[0]>>>0&&++a.buffer[1];a.buffer[0]=c}class Lh{constructor(a){this.buffer=a}high(){return this.buffer[1]}low(){return this.buffer[0]}lessThan(a){return this.buffer[1]<a.buffer[1]||this.buffer[1]===a.buffer[1]&&this.buffer[0]<a.buffer[0]}equals(a){return this.buffer[1]===a.buffer[1]&&this.buffer[0]==a.buffer[0]}greaterThan(a){return a.lessThan(this)}hex(){return`${Hh(this.buffer[1])} ${Hh(this.buffer[0])}`}}
class V extends Lh{times(a){Jh(this,a);return this}plus(a){Kh(this,a);return this}static from(a,b=new Uint32Array(2)){return V.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return V.fromString(a.toString(),b)}static fromString(a,b=new Uint32Array(2)){const c=a.length;b=new V(b);for(let d=0;d<c;){const e=8<c-d?8:c-d,f=new V(new Uint32Array([Number.parseInt(a.slice(d,d+e),10),0])),g=new V(new Uint32Array([Ih[e],0]));b.times(g);b.plus(f);d+=e}return b}static convertArray(a){const b=
new Uint32Array(2*a.length);for(let c=-1,d=a.length;++c<d;)V.from(a[c],new Uint32Array(b.buffer,b.byteOffset+8*c,2));return b}static multiply(a,b){return(new V(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new V(new Uint32Array(a.buffer))).plus(b)}}
class Mh extends Lh{negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];0==this.buffer[0]&&++this.buffer[1];return this}times(a){Jh(this,a);return this}plus(a){Kh(this,a);return this}lessThan(a){const b=this.buffer[1]<<0,c=a.buffer[1]<<0;return b<c||b===c&&this.buffer[0]<a.buffer[0]}static from(a,b=new Uint32Array(2)){return Mh.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return Mh.fromString(a.toString(),b)}static fromString(a,b=
new Uint32Array(2)){const c=a.startsWith("-"),d=a.length;b=new Mh(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,g=new Mh(new Uint32Array([Number.parseInt(a.slice(e,e+f),10),0])),k=new Mh(new Uint32Array([Ih[f],0]));b.times(k);b.plus(g);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(2*a.length);for(let c=-1,d=a.length;++c<d;)Mh.from(a[c],new Uint32Array(b.buffer,b.byteOffset+8*c,2));return b}static multiply(a,b){return(new Mh(new Uint32Array(a.buffer))).times(b)}static add(a,
b){return(new Mh(new Uint32Array(a.buffer))).plus(b)}}
class Nh{constructor(a){this.buffer=a}high(){return new Mh(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Mh(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];this.buffer[2]=~this.buffer[2];this.buffer[3]=~this.buffer[3];0==this.buffer[0]&&++this.buffer[1];0==this.buffer[1]&&++this.buffer[2];0==this.buffer[2]&&++this.buffer[3];return this}times(a){const b=new V(new Uint32Array([this.buffer[3],
0])),c=new V(new Uint32Array([this.buffer[2],0])),d=new V(new Uint32Array([this.buffer[1],0])),e=new V(new Uint32Array([this.buffer[0],0])),f=new V(new Uint32Array([a.buffer[3],0])),g=new V(new Uint32Array([a.buffer[2],0])),k=new V(new Uint32Array([a.buffer[1],0]));a=new V(new Uint32Array([a.buffer[0],0]));let m=V.multiply(e,a);this.buffer[0]=m.low();const p=new V(new Uint32Array([m.high(),0]));m=V.multiply(d,a);p.plus(m);m=V.multiply(e,k);p.plus(m);this.buffer[1]=p.low();this.buffer[3]=p.lessThan(m)?
1:0;this.buffer[2]=p.high();(new V(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))).plus(V.multiply(c,a)).plus(V.multiply(d,k)).plus(V.multiply(e,g));this.buffer[3]+=V.multiply(b,a).plus(V.multiply(c,k)).plus(V.multiply(d,g)).plus(V.multiply(e,f)).low();return this}plus(a){const b=new Uint32Array(4);b[3]=this.buffer[3]+a.buffer[3]>>>0;b[2]=this.buffer[2]+a.buffer[2]>>>0;b[1]=this.buffer[1]+a.buffer[1]>>>0;b[0]=this.buffer[0]+a.buffer[0]>>>0;b[0]<this.buffer[0]>>>0&&++b[1];b[1]<this.buffer[1]>>>
0&&++b[2];b[2]<this.buffer[2]>>>0&&++b[3];this.buffer[3]=b[3];this.buffer[2]=b[2];this.buffer[1]=b[1];this.buffer[0]=b[0];return this}hex(){return`${Hh(this.buffer[3])} ${Hh(this.buffer[2])} ${Hh(this.buffer[1])} ${Hh(this.buffer[0])}`}static multiply(a,b){return(new Nh(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new Nh(new Uint32Array(a.buffer))).plus(b)}static from(a,b=new Uint32Array(4)){return Nh.fromString("string"===typeof a?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(4)){return Nh.fromString(a.toString(),
b)}static fromString(a,b=new Uint32Array(4)){const c=a.startsWith("-"),d=a.length;b=new Nh(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,g=new Nh(new Uint32Array([Number.parseInt(a.slice(e,e+f),10),0,0,0])),k=new Nh(new Uint32Array([Ih[f],0,0,0]));b.times(k);b.plus(g);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(4*a.length);for(let c=-1,d=a.length;++c<d;)Nh.from(a[c],new Uint32Array(b.buffer,b.byteOffset+16*c,4));return b}}var Oh={};Oh.BaseInt64=Lh;Oh.Int128=Nh;
Oh.Int64=Mh;Oh.Uint64=V;function W(a){return a.L[++a.Vb]}function Ph(a){return a.buffers[++a.Ub]}
class Qh extends ud{constructor(a,b,c,d,e=w.V5){super();this.Ub=this.Vb=-1;this.S=a;this.L=b;this.buffers=c;this.dictionaries=d;this.Ja=e}visit(a){return super.visit(a instanceof T?a.type:a)}visitNull(a,{length:b}=W(this)){return I({type:a,length:b})}visitBool(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitInt(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitFloat(a,
{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitUtf8(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),valueOffsets:this.ja(a),data:this.F(a)})}visitBinary(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),valueOffsets:this.ja(a),data:this.F(a)})}visitFixedSizeBinary(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,
c),data:this.F(a)})}visitDate(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitTimestamp(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitTime(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitDecimal(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitList(a,
{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),valueOffsets:this.ja(a),child:this.visit(a.children[0])})}visitStruct(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),children:this.visitMany(a.children)})}visitUnion(a,{length:b,nullCount:c}=W(this)){this.Ja<w.V5&&this.C(a,c);return a.mode===x.Sparse?this.visitSparseUnion(a,{length:b,nullCount:c}):this.visitDenseUnion(a,{length:b,nullCount:c})}visitDenseUnion(a,
{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,typeIds:this.fb(a),valueOffsets:this.ja(a),children:this.visitMany(a.children)})}visitSparseUnion(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,typeIds:this.fb(a),children:this.visitMany(a.children)})}visitDictionary(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a.indices),dictionary:this.dictionaries.get(a.id)})}visitInterval(a,{length:b,nullCount:c}=
W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitDuration(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),data:this.F(a)})}visitFixedSizeList(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),child:this.visit(a.children[0])})}visitMap(a,{length:b,nullCount:c}=W(this)){return I({type:a,length:b,nullCount:c,nullBitmap:this.C(a,c),valueOffsets:this.ja(a),child:this.visit(a.children[0])})}C(a,
b){var c=Ph(this);return 0<b&&this.F(a,c)||new Uint8Array(0)}ja(a){return this.F(a)}fb(a){return this.F(a)}F(a,{length:b,offset:c}=Ph(this)){return this.S.subarray(c,c+b)}}
class Rh extends Qh{constructor(a,b,c,d,e){super(new Uint8Array(0),b,c,d,e);this.sources=a}C(a,b){({offset:a}=Ph(this));return 0>=b?new Uint8Array(0):gf(this.sources[a])}ja(){var {offset:a}=Ph(this);return u(Uint8Array,u(Int32Array,this.sources[a]))}fb(a){var {offset:b}=Ph(this);return u(Uint8Array,u(a.ArrayType,this.sources[b]))}F(a,{offset:b}=Ph(this)){const c=this.sources;return D.isTimestamp(a)||(D.isInt(a)||D.isTime(a))&&64===a.bitWidth||D.isDuration(a)||D.isDate(a)&&a.unit===Wa.MILLISECOND?
u(Uint8Array,Mh.convertArray(c[b])):D.isDecimal(a)?u(Uint8Array,Nh.convertArray(c[b])):D.isBinary(a)||D.isFixedSizeBinary(a)?Sh(c[b]):D.isBool(a)?gf(c[b]):D.isUtf8(a)?xa.encode(c[b].join("")):u(Uint8Array,u(a.ArrayType,c[b].map(d=>+d)))}}function Sh(a){a=a.join("");const b=new Uint8Array(a.length/2);for(let c=0;c<a.length;c+=2)b[c>>1]=Number.parseInt(a.slice(c,c+2),16);return b};class Th extends ag{constructor(a){super(a);this.v=new Uf(new Uint8Array(0))}get byteLength(){let a=this.M+4*this.length;this.m&&(a+=this.m.byteLength);this.v&&(a+=this.v.byteLength);this.I&&(a+=this.I.byteLength);return a}setValue(a,b){return super.setValue(a,u(Uint8Array,b))}fa(a,b){const c=this.m;b=Tf(this.v,b).buffer;let d=0;for(const [e,f]of a)void 0===f?c.set(e,0):(a=f.length,b.set(f,d),c.set(e,a),d+=a)}};class Uh extends Yf{constructor(a){super(a);this.v=new Wf}setValue(a,b){this.v.set(a,+b)}};class Vh extends Zf{}Vh.prototype.A=Md;class Wh extends Vh{}Wh.prototype.A=Jd;class Xh extends Vh{}Xh.prototype.A=Kd;class Yh extends Zf{}Yh.prototype.A=Xd;class Zh extends Yf{constructor({type:a,nullValues:b,dictionaryHashFunction:c}){super({type:new pd(a.dictionary,a.indices,a.id,a.isOrdered)});this.I=null;this.Aa=0;this.pb=Object.create(null);this.indices=$h({type:this.type.indices,nullValues:b});this.dictionary=$h({type:this.type.dictionary,nullValues:null});"function"===typeof c&&(this.valueToKey=c)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+
this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(a){return this.indices.isValid(a)}setValid(a,b){const c=this.indices;b=c.setValid(a,b);this.length=c.length;return b}setValue(a,b){const c=this.pb,d=this.valueToKey(b);let e=c[d];void 0===e&&(c[d]=e=this.Aa+this.dictionary.append(b).length-1);return this.indices.setValue(a,e)}flush(){var a=
this.type;const b=this.Lb,c=this.dictionary.toVector();a=this.indices.flush().clone(a);a.dictionary=b?b.concat(c):c;this.finished||(this.Aa+=c.length);this.Lb=a.dictionary;this.clear();return a}finish(){this.indices.finish();this.dictionary.finish();this.Aa=0;this.pb=Object.create(null);return super.finish()}clear(){this.indices.clear();this.dictionary.clear();return super.clear()}valueToKey(a){return"string"===typeof a?a:`${a}`}};class ai extends Zf{}ai.prototype.A=Ld;class bi extends Yf{setValue(a,b){const [c]=this.children;a*=this.stride;for(let d=-1,e=b.length;++d<e;)c.set(a+d,b[d])}addChild(a,b="0"){if(0<this.numChildren)throw Error("FixedSizeListBuilder can only have one child.");const c=this.children.push(a);this.type=new gd(this.type.listSize,new T(b,a.type,!0));return c}};class ci extends Zf{setValue(a,b){this.v.set(a,b)}}class di extends ci{setValue(a,b){super.setValue(a,Bd(b))}}class ei extends ci{}class fi extends ci{};class gi extends Zf{}gi.prototype.A=ge;class hi extends gi{}hi.prototype.A=ee;class ii extends gi{}ii.prototype.A=fe;class ji extends Zf{}ji.prototype.A=le;class ki extends ji{}ki.prototype.A=he;class li extends ji{}li.prototype.A=ie;class mi extends ji{}mi.prototype.A=je;class ni extends ji{}ni.prototype.A=ke;class oi extends Zf{setValue(a,b){this.v.set(a,b)}}class pi extends oi{}class qi extends oi{}class ri extends oi{}class si extends oi{}class ti extends oi{}class ui extends oi{}class vi extends oi{}class wi extends oi{};class xi extends ag{constructor(a){super(a);this.m=new Xf}addChild(a,b="0"){if(0<this.numChildren)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new Pc(new T(b,a.type,!0));return this.numChildren-1}fa(a){const b=this.m,[c]=this.children;for(const [d,e]of a)if("undefined"===typeof e)b.set(d,0);else{a=e;const f=a.length,g=b.set(d,f).buffer[d];for(let k=-1;++k<f;)c.set(g+k,a[k])}}};class yi extends ag{set(a,b){return super.set(a,b)}setValue(a,b){b=b instanceof Map?b:new Map(Object.entries(b));const c=this.D||(this.D=new Map),d=c.get(a);d&&(this.M-=d.size);this.M+=b.size;c.set(a,b)}addChild(a,b=`${this.numChildren}`){if(0<this.numChildren)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new kd(new T(b,a.type,!0),this.type.keysSorted);return this.numChildren-1}fa(a){const b=this.m,[c]=this.children;for(const [d,e]of a)if(void 0===
e)b.set(d,0);else{let {[d]:f,[d+1]:g}=b.set(d,e.size).buffer;for(const k of e.entries())if(c.set(f,k),++f>=g)break}}};class zi extends Yf{setValue(){}setValid(a,b){this.length=Math.max(a+1,this.length);return b}};class Ai extends Yf{setValue(a,b){const c=this.children,d=this.type;switch(Array.isArray(b)||b.constructor){case !0:return d.children.forEach((e,f)=>c[f].set(a,b[f]));case Map:return d.children.forEach((e,f)=>c[f].set(a,b.get(e.name)));default:return d.children.forEach((e,f)=>c[f].set(a,b[e.name]))}}setValid(a,b){super.setValid(a,b)||this.children.forEach(c=>c.setValid(a,b));return b}addChild(a,b=`${this.numChildren}`){const c=this.children.push(a);this.type=new Tc([...this.type.children,new T(b,
a.type,!0)]);return c}};class Bi extends Zf{}Bi.prototype.A=Rd;class Ci extends Bi{}Ci.prototype.A=Nd;class Di extends Bi{}Di.prototype.A=Od;class Ei extends Bi{}Ei.prototype.A=Pd;class Fi extends Bi{}Fi.prototype.A=Qd;class Gi extends Zf{}Gi.prototype.A=Wd;class Hi extends Gi{}Hi.prototype.A=Sd;class Ii extends Gi{}Ii.prototype.A=Td;class Ji extends Gi{}Ji.prototype.A=Ud;class Ki extends Gi{}Ki.prototype.A=Vd;class Li extends Yf{constructor(a){super(a);this.Y=new Vf(new Int8Array(0),1);"function"===typeof a.valueToChildTypeId&&(this.rb=a.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(a,b){return this.set(this.length,a,b)}set(a,b,c){void 0===c&&(c=this.rb(this,b,a));this.setValue(a,b,c);return this}setValue(a,b,c){this.Y.set(a,c);let d;null==(d=this.children[this.type.typeIdToChildIndex[c]])||d.set(a,b)}addChild(a,b=`${this.children.length}`){const c=this.children.push(a),
d=this.type,e=d.mode,f=d.typeIds;a=[...d.children,new T(b,a.type)];this.type=new Xc(e,[...f,c],a);return c}rb(){throw Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.");}}class Mi extends Li{}
class Ni extends Li{constructor(a){super(a);this.m=new Vf(new Int32Array(0))}setValue(a,b,c){c=this.Y.set(a,c).buffer[a];c=this.getChildAt(this.type.typeIdToChildIndex[c]);a=this.m.set(a,c.length).buffer[a];null==c||c.set(a,b)}};class Oi extends ag{constructor(a){super(a);this.v=new Uf(new Uint8Array(0))}get byteLength(){let a=this.M+4*this.length;this.m&&(a+=this.m.byteLength);this.v&&(a+=this.v.byteLength);this.I&&(a+=this.I.byteLength);return a}setValue(a,b){return super.setValue(a,xa.encode(b))}fa(){}}Oi.prototype.fa=Th.prototype.fa;class Pi extends ud{visitNull(){return zi}visitBool(){return Uh}visitInt(){return oi}visitInt8(){return pi}visitInt16(){return qi}visitInt32(){return ri}visitInt64(){return si}visitUint8(){return ti}visitUint16(){return ui}visitUint32(){return vi}visitUint64(){return wi}visitFloat(){return ci}visitFloat16(){return di}visitFloat32(){return ei}visitFloat64(){return fi}visitUtf8(){return Oi}visitBinary(){return Th}visitFixedSizeBinary(){return ai}visitDate(){return Vh}visitDateDay(){return Wh}visitDateMillisecond(){return Xh}visitTimestamp(){return Bi}visitTimestampSecond(){return Ci}visitTimestampMillisecond(){return Di}visitTimestampMicrosecond(){return Ei}visitTimestampNanosecond(){return Fi}visitTime(){return Gi}visitTimeSecond(){return Hi}visitTimeMillisecond(){return Ii}visitTimeMicrosecond(){return Ji}visitTimeNanosecond(){return Ki}visitDecimal(){return Yh}visitList(){return xi}visitStruct(){return Ai}visitUnion(){return Li}visitDenseUnion(){return Ni}visitSparseUnion(){return Mi}visitDictionary(){return Zh}visitInterval(){return gi}visitIntervalDayTime(){return hi}visitIntervalYearMonth(){return ii}visitDuration(){return ji}visitDurationSecond(){return ki}visitDurationMillisecond(){return li}visitDurationMicrosecond(){return mi}visitFixedSizeList(){return bi}visitMap(){return yi}}
const Qi=new Pi;function Ri(a,b,c){return b===c||Array.isArray(b)&&Array.isArray(c)&&b.length===c.length&&b.every((d,e)=>a.compareFields(d,c[e]))}class Si extends ud{compareSchemas(a,b){return a===b||b instanceof a.constructor&&Ri(this,a.fields,b.fields)}compareFields(a,b){return a===b||b instanceof a.constructor&&a.name===b.name&&a.nullable===b.nullable&&this.visit(a.type,b.type)}}function Ti(a,b){return b instanceof a.constructor}function Ui(a,b){return a===b||Ti(a,b)}
function Vi(a,b){return a===b||Ti(a,b)&&a.bitWidth===b.bitWidth&&a.isSigned===b.isSigned}function Wi(a,b){return a===b||Ti(a,b)&&a.precision===b.precision}function Xi(a,b){return a===b||Ti(a,b)&&a.unit===b.unit}function Yi(a,b){return a===b||Ti(a,b)&&a.unit===b.unit&&a.timezone===b.timezone}function Zi(a,b){return a===b||Ti(a,b)&&a.unit===b.unit&&a.bitWidth===b.bitWidth}
function $i(a,b){return a===b||Ti(a,b)&&a.mode===b.mode&&a.typeIds.every((c,d)=>c===b.typeIds[d])&&Ri(aj,a.children,b.children)}function bj(a,b){return a===b||Ti(a,b)&&a.unit===b.unit}function cj(a,b){return a===b||Ti(a,b)&&a.unit===b.unit}h=Si.prototype;h.visitNull=Ui;h.visitBool=Ui;h.visitInt=Vi;h.visitInt8=Vi;h.visitInt16=Vi;h.visitInt32=Vi;h.visitInt64=Vi;h.visitUint8=Vi;h.visitUint16=Vi;h.visitUint32=Vi;h.visitUint64=Vi;h.visitFloat=Wi;h.visitFloat16=Wi;h.visitFloat32=Wi;h.visitFloat64=Wi;
h.visitUtf8=Ui;h.visitBinary=Ui;h.visitFixedSizeBinary=function(a,b){return a===b||Ti(a,b)&&a.byteWidth===b.byteWidth};h.visitDate=Xi;h.visitDateDay=Xi;h.visitDateMillisecond=Xi;h.visitTimestamp=Yi;h.visitTimestampSecond=Yi;h.visitTimestampMillisecond=Yi;h.visitTimestampMicrosecond=Yi;h.visitTimestampNanosecond=Yi;h.visitTime=Zi;h.visitTimeSecond=Zi;h.visitTimeMillisecond=Zi;h.visitTimeMicrosecond=Zi;h.visitTimeNanosecond=Zi;h.visitDecimal=Ui;
h.visitList=function(a,b){return a===b||Ti(a,b)&&a.children.length===b.children.length&&Ri(aj,a.children,b.children)};h.visitStruct=function(a,b){return a===b||Ti(a,b)&&a.children.length===b.children.length&&Ri(aj,a.children,b.children)};h.visitUnion=$i;h.visitDenseUnion=$i;h.visitSparseUnion=$i;h.visitDictionary=function(a,b){return a===b||Ti(a,b)&&a.id===b.id&&a.isOrdered===b.isOrdered&&aj.visit(a.indices,b.indices)&&aj.visit(a.dictionary,b.dictionary)};h.visitInterval=bj;
h.visitIntervalDayTime=bj;h.visitIntervalYearMonth=bj;h.visitDuration=cj;h.visitDurationSecond=cj;h.visitDurationMillisecond=cj;h.visitDurationMicrosecond=cj;h.visitDurationNanosecond=cj;h.visitFixedSizeList=function(a,b){return a===b||Ti(a,b)&&a.listSize===b.listSize&&a.children.length===b.children.length&&Ri(aj,a.children,b.children)};h.visitMap=function(a,b){return a===b||Ti(a,b)&&a.keysSorted===b.keysSorted&&a.children.length===b.children.length&&Ri(aj,a.children,b.children)};const aj=new Si;
function dj(a,b){return aj.compareSchemas(a,b)}function ej(a,b){return aj.visit(a,b)};function $h(a){var b=a.type;const c=new (Qi.getVisitFn(b)())(a);if(b.children&&0<b.children.length){const d=a.children||[],e={nullValues:a.nullValues};a=Array.isArray(d)?(f,g)=>d[g]||e:({name:f})=>d[f]||e;for(const [f,g]of b.children.entries()){b=g.type;const k=a(g,f);c.children.push($h(Object.assign({},k,{type:b})))}}return c}
function fj(a,b){if(a instanceof H||a instanceof F||a.type instanceof D||ArrayBuffer.isView(a))return Of(a);b={type:null!=b?b:gj(a),nullValues:[null]};a=[...hj(b)(a)];a=1===a.length?a[0]:a.reduce((c,d)=>c.concat(d));return D.isDictionary(a.type)?a.memoize():a}
function gj(a){if(0===a.length)return new ub;var b=0;let c=0,d=0,e=0,f=0,g=0,k=0,m=0;for(const p of a)if(null==p)++b;else{switch(typeof p){case "bigint":++g;continue;case "boolean":++k;continue;case "number":++e;continue;case "string":++f;continue;case "object":Array.isArray(p)?++c:"[object Date]"===Object.prototype.toString.call(p)?++m:++d;continue}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.");}if(e+b===a.length)return new Pb;if(f+b===a.length)return new pd(new Ub,
new Bb);if(g+b===a.length)return new Cb;if(k+b===a.length)return new Yb;if(m+b===a.length)return new kc;if(c+b===a.length){const p=gj(a[a.findIndex(r=>null!=r)]);if(a.every(r=>null==r||ej(p,gj(r))))return new Pc(new T("",p,!0))}else if(d+b===a.length){b=new Map;for(const p of a)for(const r of Object.keys(p))b.has(r)||null==p[r]||b.set(r,new T(r,gj([p[r]]),!0));return new Tc([...b.values()])}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.");}
function hj(a){const {queueingStrategy:b="count"}=a,{highWaterMark:c="bytes"!==b?Number.POSITIVE_INFINITY:Math.pow(2,14)}=a,d="bytes"!==b?"length":"byteLength";return function*(e){let f=0;const g=$h(a);for(const k of e)g.append(k)[d]>=c&&++f&&(yield g.toVector());if(0<g.finish().length||0===f)yield g.toVector()}};function ij(a,b){return jj(a,b.map(c=>c.data.concat()))}function jj(a,b){const c=[...a.fields],d=[],e={bb:b.reduce((R,qa)=>Math.max(R,qa.length),0)};let f=0,g=0,k=-1;const m=b.length;let p,r=[];for(;0<e.bb--;){g=Number.POSITIVE_INFINITY;for(k=-1;++k<m;)r[k]=p=b[k].shift(),g=Math.min(g,p?p.length:g);Number.isFinite(g)&&(r=kj(c,g,r,b,e),0<g&&(d[f++]=I({type:new Tc(c),length:g,nullCount:0,children:r.slice()})))}return[a=a.assign(c),d.map(R=>new X(a,R))]}
function kj(a,b,c,d,e){const f=(b+63&-64)>>3;for(let k=-1,m=d.length;++k<m;){const p=c[k];let r;var g=null==(r=p)?void 0:r.length;if(g>=b)g===b?c[k]=p:(c[k]=p.slice(0,b),e.bb=Math.max(e.bb,d[k].unshift(p.slice(b,g-b))));else{g=a[k];a[k]=g.clone({nullable:!0});let R,qa;c[k]=null!=(qa=null==(R=p)?void 0:of(R,b))?qa:I({type:g.type,length:b,nullCount:b,nullBitmap:new Uint8Array(f)})}}return c};class oj{constructor(...a){if(0===a.length)return this.batches=[],this.schema=new S([]),this.m=[0],this;let b,c;a[0]instanceof S&&(b=a.shift());a.at(-1)instanceof Uint32Array&&(c=a.pop());const d=m=>{if(m){if(m instanceof X)return[m];if(m instanceof oj)return m.batches;if(m instanceof H){if(m.type instanceof Tc)return[new X(new S(m.type.children),m)]}else{if(Array.isArray(m))return m.flatMap(r=>d(r));if("function"===typeof m[Symbol.iterator])return[...m].flatMap(r=>d(r));if("object"===typeof m){var p=
Object.keys(m);const r=p.map(R=>new F([m[R]]));p=new S(p.map((R,qa)=>new T(String(R),r[qa].type)));[,p]=ij(p,r);return 0===p.length?[new X(m)]:p}}}return[]};a=a.flatMap(m=>d(m));let e,f,g;b=null!=(g=null!=(f=b)?f:null==(e=a[0])?void 0:e.schema)?g:new S([]);if(!(b instanceof S))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const m of a){if(!(m instanceof X))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!dj(b,m.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.");
}this.schema=b;this.batches=a;let k;this.m=null!=(k=c)?k:tf(this.data)}get data(){return this.batches.map(({data:a})=>a)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((a,b)=>a+b.length,0)}get nullCount(){-1===this.N&&(this.N=sf(this.data));return this.N}isValid(){return!1}get(){return null}set(){}indexOf(){return-1}getByteLength(){return 0}[Symbol.iterator](){return 0<this.batches.length?Ff.visit(new F(this.data)):[][Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...a){const b=
this.schema;a=this.data.concat(a.flatMap(({data:c})=>c));return new oj(b,a.map(c=>new X(b,c)))}slice(a,b){const c=this.schema;[a,b]=Ue({length:this.numRows},a,b);a=uf(this.data,this.m,a,b);return new oj(c,a.map(d=>new X(c,d)))}getChild(a){return this.getChildAt(this.schema.fields.findIndex(b=>b.name===a))}getChildAt(a){if(-1<a&&a<this.schema.fields.length){const c=this.data.map(d=>d.children[a]);if(0===c.length){var {type:b}=this.schema.fields[a];b=I({type:b,length:0,nullCount:0});c.push(of(b,this.numRows))}return new F(c)}return null}setChild(a,
b){let c;return this.setChildAt(null==(c=this.schema.fields)?void 0:c.findIndex(d=>d.name===a),b)}setChildAt(a,b){let c=this.schema;var d=[...this.batches];if(-1<a&&a<this.numCols){b||(b=new F([I({type:new ub,length:this.numRows})]));d=c.fields.slice();const e=d[a].clone({type:b.type}),f=this.schema.fields.map((g,k)=>this.getChildAt(k));[d[a],f[a]]=[e,b];[c,d]=ij(c,f)}return new oj(c,d)}select(a){const b=this.schema.fields.reduce((c,d,e)=>c.set(d.name,e),new Map);return this.selectAt(a.map(c=>b.get(c)).filter(c=>
-1<c))}selectAt(a){const b=this.schema.selectAt(a),c=this.batches.map(d=>d.selectAt(a));return new oj(b,c)}assign(a){const b=this.schema.fields,[c,d]=a.schema.fields.reduce((g,k,m)=>{const [p,r]=g,R=b.findIndex(qa=>qa.name===k.name);~R?r[R]=m:p.push(m);return g},[[],[]]),e=this.schema.assign(a.schema),f=[...b.map((g,k)=>[k,d[k]]).map(([g,k])=>void 0===k?this.getChildAt(g):a.getChildAt(k)),...c.map(g=>a.getChildAt(g))].filter(Boolean);return new oj(...ij(e,f))}}var pj=Symbol.toStringTag,qj=oj.prototype;
qj.schema=null;qj.batches=[];qj.m=new Uint32Array([0]);qj.N=-1;qj[Symbol.isConcatSpreadable]=!0;qj.isValid=xf(wf);qj.get=xf(qe.getVisitFn(B.Struct));qj.set=yf(be.getVisitFn(B.Struct));qj.indexOf=zf(Cf.getVisitFn(B.Struct));qj.getByteLength=xf(If.getVisitFn(B.Struct));oj[pj]="Table";class X{constructor(...a){switch(a.length){case 2:[this.schema]=a;if(!(this.schema instanceof S))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[,this.data=I({nullCount:0,type:new Tc(this.schema.fields),children:this.schema.fields.map(g=>I({type:g.type,nullCount:0}))})]=a;if(!(this.data instanceof H))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=rj(this.schema,this.data.children);break;case 1:const [b]=a,{fields:c,
children:d,length:e}=Object.keys(b).reduce((g,k,m)=>{g.children[m]=b[k];g.length=Math.max(g.length,b[k].length);g.fields[m]=T.new({name:k,type:b[k].type,nullable:!0});return g},{length:0,fields:[],children:[]});a=new S(c);const f=I({type:new Tc(c),length:e,children:d,nullCount:0});[this.schema,this.data]=rj(a,f.children,e);break;default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.");}}get dictionaries(){return this.da||(this.da=
sj(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(a){return this.data.getValid(a)}get(a){return qe.visit(this.data,a)}set(a,b){return be.visit(this.data,a,b)}indexOf(a,b){return Cf.visit(this.data,a,b)}getByteLength(a){return If.visit(this.data,a)}[Symbol.iterator](){return Ff.visit(new F([this.data]))}toArray(){return[...this]}concat(...a){return new oj(this.schema,[this,
...a])}slice(a,b){[a]=(new F([this.data])).slice(a,b).data;return new X(this.schema,a)}getChild(a){let b;return this.getChildAt(null==(b=this.schema.fields)?void 0:b.findIndex(c=>c.name===a))}getChildAt(a){return-1<a&&a<this.schema.fields.length?new F([this.data.children[a]]):null}setChild(a,b){let c;return this.setChildAt(null==(c=this.schema.fields)?void 0:c.findIndex(d=>d.name===a),b)}setChildAt(a,b){var c=this.schema,d=this.data;if(-1<a&&a<this.numCols){b||(b=new F([I({type:new ub,length:this.numRows})]));
const e=c.fields.slice();d=d.children.slice();c=e[a].clone({type:b.type});[e[a],d[a]]=[c,b.data[0]];c=new S(e,new Map(this.schema.metadata));d=I({type:new Tc(e),children:d})}return new X(c,d)}select(a){const b=this.schema.select(a),c=new Tc(b.fields),d=[];for(const e of a)a=this.schema.fields.findIndex(f=>f.name===e),~a&&(d[a]=this.data.children[a]);return new X(b,I({type:c,length:this.numRows,children:d}))}selectAt(a){const b=this.schema.selectAt(a);a=a.map(c=>this.data.children[c]).filter(Boolean);
a=I({type:new Tc(b.fields),length:this.numRows,children:a});return new X(b,a)}}var tj=Symbol.toStringTag,uj=X.prototype;uj.N=-1;uj[Symbol.isConcatSpreadable]=!0;X[tj]="RecordBatch";
function rj(a,b,c=b.reduce((d,e)=>Math.max(d,e.length),0)){const d=[...a.fields],e=[...b],f=(c+63&-64)>>3;for(const [g,k]of a.fields.entries()){const m=b[g];if(!m||m.length!==c){d[g]=k.clone({nullable:!0});let p,r;e[g]=null!=(r=null==(p=m)?void 0:of(p,c))?r:I({type:k.type,length:c,nullCount:c,nullBitmap:new Uint8Array(f)})}}return[a.assign(d),I({type:new Tc(d),length:c,children:e})]}
function sj(a,b,c=new Map){var d;if(0<(null!=(d=null==a?void 0:a.length)?d:0)&&(null==a?void 0:a.length)===(null==b?void 0:b.length))for(let f=-1,g=a.length;++f<g;){var {type:e}=a[f];d=b[f];let k,m;for(const p of[d,...((null==(k=d)?void 0:null==(m=k.dictionary)?void 0:m.data)||[])]){let r;sj(e.children,null==(r=p)?void 0:r.children,c)}if(D.isDictionary(e))if(e=e.id,!c.has(e)){let p;(null==(p=d)?0:p.dictionary)&&c.set(e,d.dictionary)}else if(c.get(e)!==d.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id");
}return c}class vj extends X{constructor(a){var b=a.fields.map(c=>I({type:c.type}));b=I({type:new Tc(a.fields),nullCount:0,children:b});super(a,b)}};var wj,xj=wj||(wj={});xj[xj.BUFFER=0]="BUFFER";var yj,zj=yj||(yj={});zj[zj.LZ4_FRAME=0]="LZ4_FRAME";zj[zj.ZSTD=1]="ZSTD";class Aj{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}method(){const a=L(this.g,this.h,6);return a?this.g.j[this.h+a]<<24>>24:wj.ac}};class Bj{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return cg(this.g,this.h)}length(){return cg(this.g,this.h+8)}};class Cj{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){return cg(this.g,this.h)}nullCount(){return cg(this.g,this.h+8)}};function Dj(a){const b=L(a.g,a.h,6);return b?lg(a.g,a.h+b):0}function Ej(a){const b=L(a.g,a.h,8);return b?lg(a.g,a.h+b):0}class Fj{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){const a=L(this.g,this.h,4);return a?cg(this.g,this.h+a):BigInt("0")}L(a,b){const c=L(this.g,this.h,6);return c?(b||new Cj).i(kg(this.g,this.h+c)+16*a,this.g):null}buffers(a,b){const c=L(this.g,this.h,8);return c?(b||new Bj).i(kg(this.g,this.h+c)+16*a,this.g):null}};class Gj{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=L(this.g,this.h,4);return a?cg(this.g,this.h+a):BigInt("0")}data(a){const b=L(this.g,this.h,6);return b?(a||new Fj).i(jg(this.g,this.h+b),this.g):null}Ia(){const a=L(this.g,this.h,8);return a?!!(this.g.j[this.h+a]<<24>>24):!1}};var Hj,Ij=Hj||(Hj={});Ij[Ij.Row=0]="Row";Ij[Ij.Column=1]="Column";var Jj,Kj=Jj||(Jj={});Kj[Kj.NONE=0]="NONE";Kj[Kj.SparseTensorIndexCOO=1]="SparseTensorIndexCOO";Kj[Kj.SparseMatrixIndexCSX=2]="SparseMatrixIndexCSX";Kj[Kj.SparseTensorIndexCSF=3]="SparseTensorIndexCSF";var Lj,Mj=Lj||(Lj={});Mj[Mj.NONE=0]="NONE";Mj[Mj.Schema=1]="Schema";Mj[Mj.DictionaryBatch=2]="DictionaryBatch";Mj[Mj.RecordBatch=3]="RecordBatch";Mj[Mj.Tensor=4]="Tensor";Mj[Mj.SparseTensor=5]="SparseTensor";class Nj{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=L(this.g,this.h,4);return a?gg(this.g,this.h+a):Dg.V1}headerType(){const a=L(this.g,this.h,6);return a?this.g.j[this.h+a]:Lj.NONE}header(a){const b=L(this.g,this.h,8);return b?hg(this.g,a,this.h+b):null}bodyLength(){const a=L(this.g,this.h,10);return a?cg(this.g,this.h+a):BigInt("0")}Fa(a){const b=L(this.g,this.h,12);return b?(new Cg).i(jg(this.g,kg(this.g,this.h+b)+4*a),this.g):null}Ga(){const a=L(this.g,
this.h,12);return a?lg(this.g,this.h+a):0}};class Oj extends ud{visit(a,b){return null==a||null==b?void 0:super.visit(a,b)}visitNull(a,b){N(b,0);return O(b)}visitInt(a,b){N(b,2);ug(b,0,a.bitWidth,0);sg(b,1,+a.isSigned,0);return O(b)}visitFloat(a,b){N(b,1);tg(b,a.precision,Vg.HALF);return O(b)}visitBinary(a,b){N(b,0);return O(b)}visitBool(a,b){N(b,0);return O(b)}visitUtf8(a,b){N(b,0);return O(b)}visitDecimal(a,b){N(b,3);ug(b,1,a.scale,0);ug(b,0,a.precision,0);ug(b,2,a.bitWidth,128);return O(b)}visitDate(a,b){N(b,1);tg(b,a.unit,Mg.MILLISECOND);
return O(b)}visitTime(a,b){N(b,2);tg(b,a.unit,Qg.MILLISECOND);ug(b,1,a.bitWidth,32);return O(b)}visitTimestamp(a,b){const c=a.timezone&&Ag(b,a.timezone)||void 0;N(b,2);tg(b,a.unit,Qg.SECOND);void 0!==c&&M(b,1,c);return O(b)}visitInterval(a,b){N(b,1);tg(b,a.unit,Yg.YEAR_MONTH);return O(b)}visitDuration(a,b){N(b,1);tg(b,a.unit,Qg.MILLISECOND);return O(b)}visitList(a,b){N(b,0);return O(b)}visitStruct(a,b){N(b,0);return O(b)}visitUnion(a,b){yg(b,4,a.typeIds.length,4);var c=a.typeIds;yg(b,4,c.length,4);
for(let d=c.length-1;0<=d;d--)rg(b,c[d]);c=zg(b);N(b,2);tg(b,a.mode,dh.Sparse);M(b,1,c);return O(b)}visitDictionary(a,b){const c=this.visit(a.indices,b);N(b,4);vg(b,0,BigInt(a.id));sg(b,2,+a.isOrdered,0);void 0!==c&&M(b,1,c);return O(b)}visitFixedSizeBinary(a,b){N(b,1);ug(b,0,a.byteWidth,0);return O(b)}visitFixedSizeList(a,b){N(b,1);ug(b,0,a.listSize,0);return O(b)}visitMap(a,b){N(b,1);sg(b,0,+a.keysSorted,0);return O(b)}}const Pj=new Oj;function Qj(a){return new Rj(a.count,Sj(a.columns),Tj(a.columns))}function Uj(a,b){return(a.fields||[]).filter(Boolean).map(c=>T.fromJSON(c,b))}function Vj(a,b){return(a.children||[]).filter(Boolean).map(c=>T.fromJSON(c,b))}function Sj(a){return(a||[]).reduce((b,c)=>[...b,new Wj(c.count,Xj(c.VALIDITY)),...Sj(c.children)],[])}
function Tj(a,b=[]){for(let c=-1,d=(a||[]).length;++c<d;){const e=a[c];e.VALIDITY&&b.push(new Yj(b.length,e.VALIDITY.length));e.TYPE_ID&&b.push(new Yj(b.length,e.TYPE_ID.length));e.OFFSET&&b.push(new Yj(b.length,e.OFFSET.length));e.DATA&&b.push(new Yj(b.length,e.DATA.length));b=Tj(e.children,b)}return b}function Xj(a){return(a||[]).reduce((b,c)=>b+ +(0===c),0)}function Zj(a=[]){return new Map(a.map(({key:b,value:c})=>[b,c]))}function ak(a){return new vb(a.isSigned,a.bitWidth)}
function bk(a,b){const c=a.type.name;switch(c){case "NONE":return new ub;case "null":return new ub;case "binary":return new Qb;case "utf8":return new Ub;case "bool":return new Yb;case "list":return new Pc((b||[])[0]);case "struct":return new Tc(b||[]);case "struct_":return new Tc(b||[])}switch(c){case "int":return b=a.type,new vb(b.isSigned,b.bitWidth);case "floatingpoint":return new Jb(y[a.type.precision]);case "decimal":return b=a.type,new bc(b.scale,b.precision,b.bitWidth);case "date":return new fc(Wa[a.type.unit]);
case "time":return b=a.type,new lc(z[b.unit],b.bitWidth);case "timestamp":return b=a.type,new tc(z[b.unit],b.timezone);case "interval":return new Bc(Za[a.type.unit]);case "duration":return new Hc(z[a.type.unit]);case "union":a=a.type;const [d,...e]=(a.mode+"").toLowerCase();return new Xc(x[d.toUpperCase()+e.join("")],a.typeIds||[],b||[]);case "fixedsizebinary":return new cd(a.type.byteWidth);case "fixedsizelist":return new gd(a.type.listSize,(b||[])[0]);case "map":return new kd((b||[])[0],a.type.keysSorted)}throw Error(`Unrecognized type: "${c}"`);
};class ck{static fromJSON(a,b){const c=new ck(0,w.V5,b);c.Oa=dk(a,b);return c}static decode(a){a=new mg(u(Uint8Array,a));a=(new Nj).i(a.s(a.position())+a.position(),a);var b=a.bodyLength();const c=a.version(),d=a.headerType();b=new ck(b,c,d);b.Oa=ek(a,d);return b}static encode(a){const b=new Bg;let c=-1;a.isSchema()?c=S.encode(b,a.header()):a.isRecordBatch()?c=Rj.encode(b,a.header()):a.isDictionaryBatch()&&(c=fk.encode(b,a.header()));N(b,5);tg(b,w.V5,Dg.V1);M(b,2,c);sg(b,1,a.headerType,Lj.NONE);vg(b,
3,BigInt(a.bodyLength));a=O(b);b.finish(a);return pg(b)}static from(a,b=0){if(a instanceof S)return new ck(0,w.V5,A.Schema,a);if(a instanceof Rj)return new ck(b,w.V5,A.RecordBatch,a);if(a instanceof fk)return new ck(b,w.V5,A.DictionaryBatch,a);throw Error(`Unrecognized Message header: ${a}`);}get type(){return this.headerType}get version(){return this.Rb}get headerType(){return this.Nb}get bodyLength(){return this.Ib}header(){return this.Oa()}isSchema(){return this.headerType===A.Schema}isRecordBatch(){return this.headerType===
A.RecordBatch}isDictionaryBatch(){return this.headerType===A.DictionaryBatch}constructor(a,b,c,d){this.Rb=b;this.Nb=c;this.body=new Uint8Array(0);d&&(this.Oa=()=>d);this.Ib=qb(a)}}class Rj{get L(){return this.Ra}get length(){return this.Qb}get buffers(){return this.Ma}constructor(a,b,c){this.Ra=b;this.Ma=c;this.Qb=qb(a)}}
class fk{get id(){return this.Ob}get data(){return this.Kb}get Ia(){return this.Pb}get length(){return this.data.length}get L(){return this.data.L}get buffers(){return this.data.buffers}constructor(a,b,c=!1){this.Kb=a;this.Pb=c;this.Ob=qb(b)}}class Yj{constructor(a,b){this.offset=qb(a);this.length=qb(b)}}class Wj{constructor(a,b){this.length=qb(a);this.nullCount=qb(b)}}
function dk(a,b){return()=>{switch(b){case A.Schema:return S.fromJSON(a);case A.RecordBatch:return Rj.fromJSON(a);case A.DictionaryBatch:return fk.fromJSON(a)}throw Error(`Unrecognized Message type: { name: ${A[b]}, type: ${b} }`);}}
function ek(a,b){return()=>{switch(b){case A.Schema:return S.decode(a.header(new nh),new Map,a.version());case A.RecordBatch:return Rj.decode(a.header(new Fj),a.version());case A.DictionaryBatch:return fk.decode(a.header(new Gj),a.version())}throw Error(`Unrecognized Message type: { name: ${A[b]}, type: ${b} }`);}}T.encode=gk;T.decode=hk;
T.fromJSON=function(a,b){var c;let d,e;b&&(e=a.dictionary)?(b.has(c=e.id)?(d=(d=e.indexType)?ak(d):new Bb,c=new pd(b.get(c),d,c,e.isOrdered)):(d=(d=e.indexType)?ak(d):new Bb,b.set(c,b=bk(a,Vj(a,b))),c=new pd(b,d,c,e.isOrdered)),a=new T(a.name,c,a.nullable,Zj(a.metadata))):(b=bk(a,Vj(a,b)),a=new T(a.name,b,a.nullable,Zj(a.metadata)));return a||null};S.encode=ik;S.decode=jk;S.fromJSON=function(a,b=new Map){return new S(Uj(a,b),Zj(a.metadata),b)};Rj.encode=kk;Rj.decode=lk;Rj.fromJSON=Qj;fk.encode=mk;
fk.decode=nk;fk.fromJSON=function(a){return new fk(Qj(a.data),a.id,a.isDelta)};Wj.encode=ok;Wj.decode=pk;Yj.encode=qk;Yj.decode=rk;function jk(a,b=new Map,c=w.V5){const d=[];for(let e,f=-1,g=-1,k=mh(a);++f<k;)if(e=a.fields(f))d[++g]=T.decode(e,b);return new S(d,sk(a),b,c)}
function lk(a,b=w.V5){var c=L(a.g,a.h,10);if(null!==(c?(new Aj).i(jg(a.g,a.h+c),a.g):null))throw Error("Record batch compression not implemented");c=a.length();const d=[];for(let f,g=-1,k=-1,m=Dj(a);++g<m;)if(f=a.L(g))d[++k]=Wj.decode(f);const e=[];for(let f,g=-1,k=-1,m=Ej(a);++g<m;)if(f=a.buffers(g))b<w.V4&&(f.h+=8*(g+1)),e[++k]=Yj.decode(f);return new Rj(c,d,e)}function nk(a,b=w.V5){return new fk(Rj.decode(a.data(),b),a.id(),a.Ia())}function rk(a){return new Yj(a.offset(),a.length())}
function pk(a){return new Wj(a.length(),a.nullCount())}function tk(a,b){const c=[];for(let d,e=-1,f=-1,g=ih(a);++e<g;)if(d=a.children(e))c[++f]=T.decode(d,b);return c}function hk(a,b){var c;let d,e;b&&(e=a.dictionary())?(b.has(c=qb(e.id()))?(d=(d=Kg(e))?uk(d):new Bb,c=new pd(b.get(c),d,c,e.isOrdered())):(d=(d=Kg(e))?uk(d):new Bb,b.set(c,b=vk(a,tk(a,b))),c=new pd(b,d,c,e.isOrdered())),a=new T(a.name(),c,a.nullable(),sk(a))):(b=vk(a,tk(a,b)),a=new T(a.name(),b,a.nullable(),sk(a)));return a||null}
function sk(a){const b=new Map;if(a)for(let c,d,e=-1,f=Math.trunc(a.Ga());++e<f;)(c=a.Fa(e))&&null!=(d=c.key())&&b.set(d,c.value());return b}function uk(a){return new vb(a.isSigned(),a.bitWidth())}
function vk(a,b){var c=(c=L(a.g,a.h,8))?a.g.j[a.h+c]:P.NONE;switch(c){case P.NONE:return new ub;case P.Null:return new ub;case P.Binary:return new Qb;case P.Utf8:return new Ub;case P.Bool:return new Yb;case P.List:return new Pc((b||[])[0]);case P.Struct_:return new Tc(b||[])}switch(c){case P.Int:return b=a.type(new Jg),new vb(b.isSigned(),b.bitWidth());case P.FloatingPoint:return b=a.type(new Xg),new Jb(b.precision());case P.Decimal:return b=a.type(new Pg),new bc(b.scale(),b.precision(),b.bitWidth());
case P.Date:return b=a.type(new Og),new fc(b.unit());case P.Time:return b=a.type(new bh),new lc(b.unit(),b.bitWidth());case P.Timestamp:return b=a.type(new ch),new tc(b.unit(),b.timezone());case P.Interval:return b=a.type(new $g),new Bc(b.unit());case P.Duration:return b=a.type(new Sg),new Hc(b.unit());case P.Union:c=a.type(new fh);a=c.mode();const d=L(c.g,c.h,6);c=d?new Int32Array(c.g.S().buffer,c.g.S().byteOffset+kg(c.g,c.h+d),lg(c.g,c.h+d)):null;return new Xc(a,c||[],b||[]);case P.FixedSizeBinary:return b=
a.type(new Tg),new cd(b.byteWidth());case P.FixedSizeList:return a=a.type(new Ug),new gd(a.listSize(),(b||[])[0]);case P.Map:return a=a.type(new ah),new kd((b||[])[0],a.keysSorted())}throw Error(`Unrecognized type: "${P[c]}" (${c})`);}
function ik(a,b){var c=b.fields.map(d=>T.encode(a,d));yg(a,4,c.length,4);c=kh(a,c);b=b.metadata&&0<b.metadata.size?lh(a,[...b.metadata].map(([d,e])=>{d=Ag(a,`${d}`);e=Ag(a,`${e}`);N(a,2);M(a,0,d);M(a,1,e);return O(a)})):-1;N(a,4);M(a,1,c);tg(a,wk?Fg.Hb:Fg.bc,Fg.Hb);-1!==b&&M(a,2,b);return O(a)}
function gk(a,b){let c=-1,d=-1,e=-1;var f=b.type;let g=b.typeId;D.isDictionary(f)?(g=f.dictionary.typeId,e=Pj.visit(f,a),d=Pj.visit(f.dictionary,a)):d=Pj.visit(f,a);f=(f.children||[]).map(m=>T.encode(a,m));f=gh(a,f);const k=b.metadata&&0<b.metadata.size?hh(a,[...b.metadata].map(([m,p])=>{m=Ag(a,`${m}`);p=Ag(a,`${p}`);N(a,2);M(a,0,m);M(a,1,p);return O(a)})):-1;b.name&&(c=Ag(a,b.name));N(a,7);M(a,3,d);sg(a,2,g,P.NONE);M(a,5,f);sg(a,1,+!!b.nullable,0);-1!==c&&M(a,0,c);-1!==e&&M(a,4,e);-1!==k&&M(a,6,
k);return O(a)}function kk(a,b){var c=b.L||[],d=b.buffers||[];yg(a,16,c.length,8);for(const e of c.slice().reverse())Wj.encode(a,e);c=zg(a);yg(a,16,d.length,8);for(const e of d.slice().reverse())Yj.encode(a,e);d=zg(a);N(a,4);vg(a,0,BigInt(b.length));M(a,1,c);M(a,2,d);return O(a)}function mk(a,b){const c=Rj.encode(a,b.data);N(a,3);vg(a,0,BigInt(b.id));sg(a,2,+b.Ia,0);M(a,1,c);return O(a)}
function ok(a,b){var c=BigInt(b.length);b=BigInt(b.nullCount);ng(a,8,16);a.$(BigInt(null!=b?b:0));a.$(BigInt(null!=c?c:0));return a.offset()}function qk(a,b){var c=BigInt(b.offset);b=BigInt(b.length);ng(a,8,16);a.$(BigInt(null!=b?b:0));a.$(BigInt(null!=c?c:0));return a.offset()}const xk=new ArrayBuffer(2);(new DataView(xk)).setInt16(0,256,!0);const wk=256===(new Int16Array(xk))[0];const yk=a=>`Expected ${A[a]} Message in stream, but was null or length 0.`,zk=a=>`Header pointer of flatbuffer-encoded ${A[a]} Message is null or length 0.`,Ak=(a,b)=>`Expected to read ${a} metadata bytes, but only read ${b}.`,Bk=(a,b)=>`Expected to read ${a} bytes for message body, but only read ${b}.`;
class Ck{constructor(a){this.source=a instanceof Bh?a:new Bh(a)}[Symbol.iterator](){return this}next(){let a;return(a=this.readMetadataLength()).done||-1===a.value&&(a=this.readMetadataLength()).done||(a=this.readMetadata(a.value)).done?U:a}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}readMessage(a){let b;if((b=this.next()).done)return null;if(null!=a&&b.value.headerType!==a)throw Error(yk(a));return b.value}readMessageBody(a){if(0>=a)return new Uint8Array(0);const b=
u(Uint8Array,this.source.read(a));if(b.byteLength<a)throw Error(Bk(a,b.byteLength));return 0===b.byteOffset%8&&b.byteOffset+b.byteLength<=b.buffer.byteLength?b:b.slice()}readSchema(a=!1){const b=A.Schema;let c;const d=null==(c=this.readMessage(b))?void 0:c.header();if(a&&!d)throw Error(zk(b));return d}readMetadataLength(){var a=this.source.read(4);let b;a=(null==(b=a&&new mg(a))?void 0:b.s(0))||0;return{done:0===a,value:a}}readMetadata(a){const b=this.source.read(a);if(!b)return U;if(b.byteLength<
a)throw Error(Ak(a,b.byteLength));return{done:!1,value:ck.decode(b)}}}
class Dk{constructor(a,b){this.source=a instanceof Dh?a:t(a)&&q(a.stat)&&"number"===typeof a.fd?new Gh(a,b):new Dh(a)}[Symbol.asyncIterator](){return this}next(){const a=this;return l(function*(){let b;return(b=yield a.readMetadataLength()).done||-1===b.value&&(b=yield a.readMetadataLength()).done||(b=yield a.readMetadata(b.value)).done?U:b})}throw(a){const b=this;return l(function*(){return yield b.source.throw(a)})}return(a){const b=this;return l(function*(){return yield b.source.return(a)})}readMessage(a){const b=
this;return l(function*(){let c;if((c=yield b.next()).done)return null;if(null!=a&&c.value.headerType!==a)throw Error(yk(a));return c.value})}readMessageBody(a){const b=this;return l(function*(){if(0>=a)return new Uint8Array(0);const c=u(Uint8Array,yield b.source.read(a));if(c.byteLength<a)throw Error(Bk(a,c.byteLength));return 0===c.byteOffset%8&&c.byteOffset+c.byteLength<=c.buffer.byteLength?c:c.slice()})}readSchema(a=!1){const b=this;return l(function*(){const c=A.Schema;let d;const e=null==(d=
yield b.readMessage(c))?void 0:d.header();if(a&&!e)throw Error(zk(c));return e})}readMetadataLength(){const a=this;return l(function*(){var b=yield a.source.read(4);let c;b=(null==(c=b&&new mg(b))?void 0:c.s(0))||0;return{done:0===b,value:b}})}readMetadata(a){const b=this;return l(function*(){const c=yield b.source.read(a);if(!c)return U;if(c.byteLength<a)throw Error(Ak(a,c.byteLength));return{done:!1,value:ck.decode(c)}})}}
class Ek extends Ck{constructor(a){super(new Uint8Array(0));this.R=!1;this.ya=[];this.X=this.lb=0;this.pa=a instanceof vh?a:new vh(a)}next(){var a=this.pa;if(!this.R)return this.R=!0,{done:!1,value:ck.fromJSON(a.schema,A.Schema)};if(this.X<a.dictionaries.length)return a=a.dictionaries[this.X++],this.ya=a.data.columns,{done:!1,value:ck.fromJSON(a,A.DictionaryBatch)};if(this.lb<a.batches.length)return a=a.batches[this.lb++],this.ya=a.columns,{done:!1,value:ck.fromJSON(a,A.RecordBatch)};this.ya=[];return U}readMessageBody(){function a(b){return(b||
[]).reduce((c,d)=>[...c,...(d.VALIDITY&&[d.VALIDITY]||[]),...(d.TYPE_ID&&[d.TYPE_ID]||[]),...(d.OFFSET&&[d.OFFSET]||[]),...(d.DATA&&[d.DATA]||[]),...a(d.children)],[])}return a(this.ya)}readMessage(a){let b;if((b=this.next()).done)return null;if(null!=a&&b.value.headerType!==a)throw Error(yk(a));return b.value}readSchema(){const a=A.Schema,b=this.readMessage(a),c=null==b?void 0:b.header();if(!b||!c)throw Error(zk(a));return c}}const Fk=new Uint8Array(6);for(let a=0;6>a;a+=1)Fk[a]="ARROW1".codePointAt(a);
function Gk(a){for(let b=-1,c=Fk.length;++b<c;)if(Fk[b]!==a[0+b])return!1;return!0}const Hk=Fk.length,Ik=Hk+4,Jk=2*Hk+4;class Kk extends yh{constructor(a){super();this.o=a}get closed(){return this.o.closed}get schema(){return this.o.schema}get autoDestroy(){return this.o.autoDestroy}get dictionaries(){return this.o.dictionaries}get numDictionaries(){return this.o.numDictionaries}get numRecordBatches(){return this.o.numRecordBatches}get footer(){return this.o.isFile()?this.o.footer:null}isSync(){return this.o.isSync()}isAsync(){return this.o.isAsync()}isFile(){return this.o.isFile()}isStream(){return this.o.isStream()}next(){return this.o.next()}throw(a){return this.o.throw(a)}return(a){return this.o.return(a)}cancel(){return this.o.cancel()}reset(a){this.o.reset(a);
this.qb=this.kb=void 0;return this}open(a){a=this.o.open(a);return t(a)&&q(a.then)?a.then(()=>this):this}readRecordBatch(a){return this.o.isFile()?this.o.readRecordBatch(a):null}[Symbol.iterator](){return this.o[Symbol.iterator]()}[Symbol.asyncIterator](){return this.o[Symbol.asyncIterator]()}toDOMStream(){return Ka(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return La(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}static throughNode(){throw Error('"throughNode" not available in this environment');
}static throughDOM(){throw Error('"throughDOM" not available in this environment');}static from(a){return a instanceof Kk?a:t(a)&&t(a.schema)?new Lk(new Mk(a)):t(a)&&q(a.stat)&&"number"===typeof a.fd?Nk(a):t(a)&&q(a.then)?(()=>l(function*(){return yield Kk.from(yield a)}))():t(a)&&za(a.body)||za(a)||Aa(a)||t(a)&&q(a[Symbol.asyncIterator])?Ok(new Dh(a)):Pk(new Bh(a))}static readAll(a){return a instanceof Kk?a.isSync()?Qk(a):Rk(a):t(a)&&t(a.schema)||ArrayBuffer.isView(a)||t(a)&&q(a[Symbol.iterator])||
t(a)&&"done"in a&&"value"in a?Qk(a):Rk(a)}}class Lk extends Kk{constructor(a){super(a);this.o=a}readAll(){return[...this]}[Symbol.iterator](){return this.o[Symbol.iterator]()}[Symbol.asyncIterator](){const a=this;return new oa(function*(){yield new n(1,a[Symbol.iterator]())}())}}
class Sk extends Kk{constructor(a){super(a);this.o=a}readAll(){const a=this;return l(function*(){const b=[];var c;try{for(var d=ia(a);;){var e=yield d.next();if(e.done)break;b.push(e.value)}}catch(g){var f={error:g}}finally{try{e&&!e.done&&(c=d.return)&&(yield c.call(d))}finally{if(f)throw f.error;}}return b})}[Symbol.iterator](){throw Error("AsyncRecordBatchStreamReader is not Iterable");}[Symbol.asyncIterator](){return this.o[Symbol.asyncIterator]()}}
class Tk extends Lk{constructor(a){super(a);this.o=a}}class Uk extends Sk{constructor(a){super(a);this.o=a}}function Vk(a,b,c){c=a.Qa(b,c,a.schema.fields);b=I({type:new Tc(a.schema.fields),length:b.length,children:c});return new X(a.schema,b)}function Wk(a,b,c){var d=b.id;const e=b.Ia,f=a.schema,g=a.dictionaries.get(d);return e||!g?(d=f.dictionaries.get(d),a=a.Qa(b.data,c,[d]),(g&&e?g.concat(new F(a)):new F(a)).memoize()):g.memoize()}
class Xk{get numDictionaries(){return this.X}get numRecordBatches(){return this.O}constructor(a=new Map){this.closed=!1;this.autoDestroy=!0;this.O=this.X=0;this.dictionaries=a}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(a){this.O=this.X=0;this.schema=a;this.dictionaries=new Map;return this}Qa(a,b,c){return(new Qh(b,a.L,a.buffers,this.dictionaries,this.schema.Ja)).visitMany(c)}}
class Yk extends Xk{constructor(a){super();this.u=t(a)&&t(a.schema)?new Ek(this.H=a):new Ck(this.H=a)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset().u.return(),this.dictionaries=this.u=null)}open(a){this.closed||(this.autoDestroy=Zk(this,a),this.schema||(this.schema=this.u.readSchema())||this.cancel());return this}throw(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset().u.throw(a):U}return(a){return!this.closed&&
this.autoDestroy&&(this.closed=!0)?this.reset().u.return(a):U}next(){if(this.closed)return U;for(var a,b=this.u;a=this.ra();)if(a.isSchema())this.reset(a.header());else{if(a.isRecordBatch()){this.O++;var c=a.header();b=b.readMessageBody(a.bodyLength);return{done:!1,value:Vk(this,c,b)}}a.isDictionaryBatch()&&(this.X++,c=a.header(),a=b.readMessageBody(a.bodyLength),a=Wk(this,c,a),this.dictionaries.set(c.id,a))}return this.schema&&0===this.O?(this.O++,{done:!1,value:new vj(this.schema)}):this.return()}ra(){return this.u.readMessage(void 0)}}
class $k extends Xk{constructor(a,b){super(b);this.u=new Dk(this.H=a)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){const a=this;return l(function*(){!a.closed&&(a.closed=!0)&&(yield a.reset().u.return(),a.u=null,a.dictionaries=null)})}open(a){const b=this;return l(function*(){b.closed||(b.autoDestroy=Zk(b,a),b.schema||(b.schema=yield b.u.readSchema())||(yield b.cancel()));return b})}throw(a){const b=this;return l(function*(){return!b.closed&&b.autoDestroy&&
(b.closed=!0)?yield b.reset().u.throw(a):U})}return(a){const b=this;return l(function*(){return!b.closed&&b.autoDestroy&&(b.closed=!0)?yield b.reset().u.return(a):U})}next(){const a=this;return l(function*(){if(a.closed)return U;for(var b,c=a.u;b=yield a.ra();)if(b.isSchema())yield a.reset(b.header());else{if(b.isRecordBatch()){a.O++;var d=b.header();c=yield c.readMessageBody(b.bodyLength);return{done:!1,value:Vk(a,d,c)}}b.isDictionaryBatch()&&(a.X++,d=b.header(),b=yield c.readMessageBody(b.bodyLength),
b=Wk(a,d,b),a.dictionaries.set(d.id,b))}return a.schema&&0===a.O?(a.O++,{done:!1,value:new vj(a.schema)}):yield a.return()})}ra(){const a=this;return l(function*(){return yield a.u.readMessage(void 0)})}}
class al extends Yk{get footer(){return this.l}get numDictionaries(){return this.l?this.l.numDictionaries:0}get numRecordBatches(){return this.l?this.l.numRecordBatches:0}constructor(a){super(a instanceof Fh?a:new Fh(a))}isSync(){return!0}isFile(){return!0}open(a){if(!this.closed&&!this.l){this.schema=(this.l=this.Ua()).schema;for(const b of rh(this.l))b&&this.Ta(this.X++)}return super.open(a)}readRecordBatch(a){if(this.closed)return null;this.l||this.open();var b;const c=null==(b=this.l)?void 0:
b.ha(a);return c&&this.H.seek(c.offset)&&(b=this.u.readMessage(A.RecordBatch),null==b?0:b.isRecordBatch())?(a=b.header(),b=this.u.readMessageBody(b.bodyLength),Vk(this,a,b)):null}Ta(a){var b;const c=null==(b=this.l)?void 0:b.Ha(a);c&&this.H.seek(c.offset)&&(b=this.u.readMessage(A.DictionaryBatch),null==b?0:b.isDictionaryBatch())&&(a=b.header(),b=this.u.readMessageBody(b.bodyLength),b=Wk(this,a,b),this.dictionaries.set(a.id,b))}Ua(){var a=this.H;const b=a.size-Ik,c=a.s(b);a=a.ia(b-c,c);return sh.decode(a)}ra(){this.l||
this.open();if(this.l&&this.O<this.numRecordBatches){let a;const b=null==(a=this.l)?void 0:a.ha(this.O);if(b&&this.H.seek(b.offset))return this.u.readMessage(void 0)}return null}}
class bl extends $k{get footer(){return this.l}get numDictionaries(){return this.l?this.l.numDictionaries:0}get numRecordBatches(){return this.l?this.l.numRecordBatches:0}constructor(a){var b=[];const c="number"!==typeof b[0]?b.shift():void 0;b=b[0]instanceof Map?b.shift():void 0;super(a instanceof Gh?a:new Gh(a,c),b)}isFile(){return!0}isAsync(){return!0}open(a){const b=this,c=()=>super.open;return l(function*(){if(!b.closed&&!b.l){b.schema=(b.l=yield b.Ua()).schema;for(const d of rh(b.l))d&&(yield b.Ta(b.X++))}return yield c().call(b,
a)})}readRecordBatch(a){const b=this;return l(function*(){if(b.closed)return null;b.l||(yield b.open());var c,d=null==(c=b.l)?void 0:c.ha(a);return d&&(yield b.H.seek(d.offset))&&(d=yield b.u.readMessage(A.RecordBatch),null==d?0:d.isRecordBatch())?(c=d.header(),d=yield b.u.readMessageBody(d.bodyLength),Vk(b,c,d)):null})}Ta(a){const b=this;return l(function*(){var c,d=null==(c=b.l)?void 0:c.Ha(a);d&&(yield b.H.seek(d.offset))&&(d=yield b.u.readMessage(A.DictionaryBatch),null==d?0:d.isDictionaryBatch())&&
(c=d.header(),d=yield b.u.readMessageBody(d.bodyLength),d=Wk(b,c,d),b.dictionaries.set(c.id,d))})}Ua(){const a=this;return l(function*(){var b=a.H;b.D&&(yield b.D);const c=b.size-Ik,d=yield b.s(c);b=yield b.ia(c-d,d);return sh.decode(b)})}ra(){const a=this;return l(function*(){a.l||(yield a.open());if(a.l&&a.O<a.numRecordBatches){const b=a.l.ha(a.O);if(b&&(yield a.H.seek(b.offset)))return yield a.u.readMessage(void 0)}return null})}}
class Mk extends Yk{Qa(a,b,c){return(new Rh(b,a.L,a.buffers,this.dictionaries,this.schema.Ja)).visitMany(c)}}function Zk(a,b){return b&&"boolean"===typeof b.autoDestroy?b.autoDestroy:a.autoDestroy}function*Qk(a){a=Kk.from(a);try{if(!a.open({autoDestroy:!1}).closed){do yield a;while(!a.reset().open().closed)}}finally{a.cancel()}}
function Rk(a){return new oa(function*(){const b=yield new n(2,Kk.from(a));try{if(!(yield new n(2,b.open({autoDestroy:!1}))).closed){do yield new n(0,b);while(!(yield new n(2,b.reset().open())).closed)}}finally{yield new n(2,b.cancel())}}())}function Pk(a){const b=a.peek(Hk+7&-8);return b&&4<=b.byteLength?Gk(b)?new Tk(new al(a.read())):new Lk(new Yk(a)):new Lk(new Yk(function*(){}()))}
function Ok(a){return l(function*(){const b=yield a.peek(Hk+7&-8);return b&&4<=b.byteLength?Gk(b)?new Tk(new al(yield a.read())):new Sk(new $k(a)):new Sk(new $k(function(){return new oa(function*(){}())}()))})}function Nk(a){return l(function*(){const {size:b}=yield a.stat(),c=new Gh(a,b);return b>=Jk&&Gk(yield c.ia(0,Hk+7&-8))?new Uk(new bl(c)):new Sk(new $k(c))})};class cl extends ud{static ta(...a){const b=d=>d.flatMap(e=>Array.isArray(e)?b(e):e instanceof X?e.data.children:e.data),c=new cl;c.visitMany(b(a));return c}constructor(){super();this.za=0;this.Ra=[];this.Ma=[];this.Jb=[]}visit(a){if(a instanceof F)return this.visitMany(a.data),this;const b=a.type;if(!D.isDictionary(b)){const c=a.length;if(2147483647<c)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(D.isUnion(b))this.L.push(new Wj(c,0));else{const d=a.nullCount;D.isNull(b)||
dl.call(this,0>=d?new Uint8Array(0):ff(a.offset,c,a.nullBitmap));this.L.push(new Wj(c,d))}}return super.visit(a)}visitNull(){return this}visitDictionary(a){return this.visit(a.clone(a.type.indices))}get L(){return this.Ra}get buffers(){return this.Ma}get byteLength(){return this.za}get Za(){return this.Jb}}function dl(a){const b=a.byteLength+7&-8;this.buffers.push(a);this.Za.push(new Yj(this.za,b));this.za+=b;return this}function el(a){return dl.call(this,a.values.subarray(0,a.length*a.stride))}
function fl(a){const b=a.length,c=a.values;a=a.valueOffsets;const {[0]:d,[b]:e}=a,f=Math.min(e-d,c.byteLength-d);dl.call(this,Ia(-d,b+1,a));dl.call(this,c.subarray(d,d+f));return this}function gl(a){const b=a.length,c=a.valueOffsets;if(c){const {[0]:d,[b]:e}=c;dl.call(this,Ia(-d,b+1,c));return this.visit(a.children[0].slice(d,e-d))}return this.visit(a.children[0])}function hl(a){return this.visitMany(a.type.children.map((b,c)=>a.children[c]).filter(Boolean))[0]}h=cl.prototype;
h.visitBool=function(a){let b;return a.nullCount>=a.length?dl.call(this,new Uint8Array(0)):(b=a.values)instanceof Uint8Array?dl.call(this,ff(a.offset,a.length,b)):dl.call(this,gf(a.values))};h.visitInt=el;h.visitFloat=el;h.visitUtf8=fl;h.visitBinary=fl;h.visitFixedSizeBinary=el;h.visitDate=el;h.visitTimestamp=el;h.visitTime=el;h.visitDecimal=el;h.visitList=gl;h.visitStruct=hl;
h.visitUnion=function(a){const b=a.type,c=a.length,d=a.typeIds,e=a.valueOffsets;dl.call(this,d);if(b.mode===x.Sparse)return hl.call(this,a);if(b.mode===x.Dense){if(0>=a.offset)return dl.call(this,e),hl.call(this,a);const f=new Int32Array(c),g=Object.create(null),k=Object.create(null);for(let m,p,r=-1;++r<c;){if(void 0===(m=d[r]))continue;void 0===(p=g[m])&&(p=g[m]=e[r]);f[r]=e[r]-p;let R;k[m]=(null!=(R=k[m])?R:0)+1}dl.call(this,f);this.visitMany(a.children.map((m,p)=>{p=b.typeIds[p];return m.slice(g[p],
Math.min(c,k[p]))}))}return this};h.visitInterval=el;h.visitDuration=el;h.visitFixedSizeList=gl;h.visitMap=gl;class il extends ud{visit(a){return null==a?void 0:super.visit(a)}visitNull({typeId:a}){return{name:P[a].toLowerCase()}}visitInt({typeId:a,bitWidth:b,isSigned:c}){return{name:P[a].toLowerCase(),bitWidth:b,isSigned:c}}visitFloat({typeId:a,precision:b}){return{name:P[a].toLowerCase(),precision:y[b]}}visitBinary({typeId:a}){return{name:P[a].toLowerCase()}}visitBool({typeId:a}){return{name:P[a].toLowerCase()}}visitUtf8({typeId:a}){return{name:P[a].toLowerCase()}}visitDecimal({typeId:a,scale:b,precision:c,
bitWidth:d}){return{name:P[a].toLowerCase(),scale:b,precision:c,bitWidth:d}}visitDate({typeId:a,unit:b}){return{name:P[a].toLowerCase(),unit:Wa[b]}}visitTime({typeId:a,unit:b,bitWidth:c}){return{name:P[a].toLowerCase(),unit:z[b],bitWidth:c}}visitTimestamp({typeId:a,timezone:b,unit:c}){return{name:P[a].toLowerCase(),unit:z[c],timezone:b}}visitInterval({typeId:a,unit:b}){return{name:P[a].toLowerCase(),unit:Za[b]}}visitDuration({typeId:a,unit:b}){return{name:P[a].toLocaleLowerCase(),unit:z[b]}}visitList({typeId:a}){return{name:P[a].toLowerCase()}}visitStruct({typeId:a}){return{name:P[a].toLowerCase()}}visitUnion({typeId:a,
mode:b,typeIds:c}){return{name:P[a].toLowerCase(),mode:x[b].toUpperCase(),typeIds:[...c]}}visitDictionary(a){return this.visit(a.dictionary)}visitFixedSizeBinary({typeId:a,byteWidth:b}){return{name:P[a].toLowerCase(),byteWidth:b}}visitFixedSizeList({typeId:a,listSize:b}){return{name:P[a].toLowerCase(),listSize:b}}visitMap({typeId:a,keysSorted:b}){return{name:P[a].toLowerCase(),keysSorted:b}}};class jl extends ud{static ta(...a){const b=new jl;return a.map(({schema:c,data:d})=>b.visitMany(c.fields,d.children))}visit({name:a},b){const c=b.length,d=b.offset,e=b.nullCount,f=b.nullBitmap,g=D.isDictionary(b.type)?b.type.indices:b.type,k=Object.assign([],b.buffers,{[bb.VALIDITY]:void 0});return Object.assign({},{name:a,count:c,VALIDITY:D.isNull(g)||D.isUnion(g)?void 0:0>=e?Array.from({length:c},()=>1):[...(new hf(f,d,c,null,ef))]},super.visit(b.clone(g,d,c,0,k)))}visitNull(){return{}}visitBool({values:a,
offset:b,length:c}){return{DATA:[...(new hf(a,b,c,null,df))]}}visitInt(a){return{DATA:64>a.type.bitWidth?[...a.values]:[...kl(a.values,2)]}}visitFloat(a){return{DATA:[...a.values]}}visitUtf8(a){return{DATA:[...(new F([a]))],OFFSET:[...a.valueOffsets]}}visitBinary(a){return{DATA:[...ll(new F([a]))],OFFSET:[...a.valueOffsets]}}visitFixedSizeBinary(a){return{DATA:[...ll(new F([a]))]}}visitDate(a){return{DATA:a.type.unit===Wa.DAY?[...a.values]:[...kl(a.values,2)]}}visitTimestamp(a){return{DATA:[...kl(a.values,
2)]}}visitTime(a){return{DATA:a.type.unit<z.MICROSECOND?[...a.values]:[...kl(a.values,2)]}}visitDecimal(a){return{DATA:[...kl(a.values,4)]}}visitList(a){return{OFFSET:[...a.valueOffsets],children:this.visitMany(a.type.children,a.children)}}visitStruct(a){return{children:this.visitMany(a.type.children,a.children)}}visitUnion(a){return{TYPE_ID:[...a.typeIds],OFFSET:a.type.mode===x.Dense?[...a.valueOffsets]:void 0,children:this.visitMany(a.type.children,a.children)}}visitInterval(a){return{DATA:[...a.values]}}visitDuration(a){return{DATA:[...kl(a.values,
2)]}}visitFixedSizeList(a){return{children:this.visitMany(a.type.children,a.children)}}visitMap(a){return{OFFSET:[...a.valueOffsets],children:this.visitMany(a.type.children,a.children)}}}function*ll(a){for(const b of a)yield b.reduce((c,d)=>`${c}${("0"+(d&255).toString(16)).slice(-2)}`,"").toUpperCase()}function*kl(a,b){a=new Uint32Array(a.buffer);for(let c=-1,d=a.length/b;++c<d;)yield`${ob.new(a.subarray((c+0)*b,(c+1)*b),!1)}`};function Y(a,b){a.sa&&(b=u(Uint8Array,b))&&0<b.byteLength&&(a.G.write(b),a.qa+=b.byteLength);return a}function ml(a,b){return 0<b?Y(a,new Uint8Array(b)):a}function nl(a,b){let c,d,e;for(let f=-1,g=b.length;++f<g;)(c=b[f])&&0<(d=c.byteLength)&&(Y(a,c),0<(e=(d+7&-8)-d)&&ml(a,e))}
class ol extends yh{static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}constructor(a){super();this.qa=0;this.sa=!1;this.G=new Ah;this.R=null;this.oa=[];this.Ba=[];this.ea=new Map;t(a)||(a={autoDestroy:!0,Fb:!1});this.xa="boolean"===typeof a.autoDestroy?a.autoDestroy:!0;this.Va="boolean"===typeof a.Fb?a.Fb:!1}toString(a=!1){return this.G.toString(a)}toUint8Array(a=!1){return this.G.toUint8Array(a)}writeAll(a){return t(a)&&
q(a.then)?a.then(b=>this.writeAll(b)):t(a)&&q(a[Symbol.asyncIterator])?pl(this,a):ql(this,a)}get closed(){return this.G.closed}[Symbol.asyncIterator](){return this.G[Symbol.asyncIterator]()}toDOMStream(a){return this.G.toDOMStream(a)}toNodeStream(a){return this.G.toNodeStream(a)}close(){return this.reset().G.close()}abort(a){return this.reset().G.abort(a)}finish(){this.xa?this.close():this.reset(this.G,this.R);return this}reset(a=this.G,b=null){a===this.G||a instanceof Ah?this.G=a:(this.G=new Ah,
a&&t(a)&&q(a.abort)&&q(a.getWriter)&&!ya(a)?this.toDOMStream({type:"bytes"}).pipeTo(a):a&&t(a)&&q(a.end)&&q(a.write)&&"boolean"===typeof a.writable&&!ya(a)&&xh(this.toNodeStream({dc:!1}),a));this.sa&&this.R&&this.Da(this.R);this.sa=!1;this.oa=[];this.Ba=[];this.ea=new Map;b&&dj(b,this.R)||(null==b?(this.qa=0,this.R=null):(this.sa=!0,this.R=b,this.Wa(b)));return this}write(a){let b=null;if(this.G){if(null==a||a instanceof oj&&!(b=a.schema)||a instanceof X&&!(b=a.schema))return this.finish()&&void 0}else throw Error("RecordBatchWriter is closed");
if(b&&!dj(b,this.R)){if(this.sa&&this.xa)return this.close();this.reset(this.G,b)}a instanceof X?a instanceof vj||this.tb(a):a instanceof oj?this.writeAll(a.batches):t(a)&&q(a[Symbol.iterator])&&this.writeAll(a)}Ea(a){const b=ck.encode(a),c=b.byteLength,d=this.Va?4:8,e=c+d+7&-8,f=e-c-d;a.headerType===A.RecordBatch?this.Ba.push(new uh(e,a.bodyLength,this.qa)):a.headerType===A.DictionaryBatch&&this.oa.push(new uh(e,a.bodyLength,this.qa));this.Va||Y(this,Int32Array.of(-1));Y(this,Int32Array.of(e-d));
0<c&&Y(this,b);return ml(this,f)}Wa(a){this.Ea(ck.from(a))}Da(){return this.Va?Y(this,Int32Array.of(0)):Y(this,Int32Array.of(-1,0))}tb(a){const {byteLength:b,L:c,Za:d,buffers:e}=cl.ta(a);var f=new Rj(a.numRows,c,d);f=ck.from(f,b);nl(this.Ca(a).Ea(f),e)}sb(a,b,c=!1){this.ea.set(b,a.length+(this.ea.get(b)||0));const {byteLength:d,L:e,Za:f,buffers:g}=cl.ta(new F([a]));a=new Rj(a.length,e,f);b=new fk(a,b,c);b=ck.from(b,d);nl(this.Ea(b),g)}Ca(a){for(let [b,c]of a.dictionaries){a=this.ea.get(b)||0;let d;
if(0===a||0<(c=null==(d=c)?void 0:d.slice(a)).length)for(const e of c.data)this.sb(e,b,0<a),a+=e.length}return this}}class rl extends ol{static writeAll(a,b){const c=new rl(b);return t(a)&&q(a.then)?a.then(d=>c.writeAll(d)):t(a)&&q(a[Symbol.asyncIterator])?pl(c,a):ql(c,a)}}
class sl extends ol{static writeAll(a){const b=new sl;return t(a)&&q(a.then)?a.then(c=>b.writeAll(c)):t(a)&&q(a[Symbol.asyncIterator])?pl(b,a):ql(b,a)}constructor(){super();this.xa=!0}Wa(){ml(Y(this,Fk),2)}Da(a){const b=sh.encode(new sh(a,w.V5,this.Ba,this.oa));return Y(Y(Y(super.Da(a),b),Int32Array.of(b.byteLength)),Fk)}}
class tl extends ol{static writeAll(a){return(new tl).writeAll(a)}constructor(){super();this.xa=!0;this.aa=[];this.da=[]}Ea(){return this}Da(){return this}Wa(a){Y(this,`{\n  "schema": ${JSON.stringify({fields:a.fields.map(b=>ul(b))},null,2)}`)}Ca(a){0<a.dictionaries.size&&this.da.push(a);return this}sb(a,b,c=!1){this.ea.set(b,a.length+(this.ea.get(b)||0));Y(this,0===this.oa.length?"    ":",\n    ");Y(this,`${vl(a,b,c)}`);this.oa.push(new uh(0,0,0))}tb(a){this.Ca(a);this.aa.push(a)}close(){if(0<this.da.length){Y(this,
',\n  "dictionaries": [\n');for(var a of this.da)super.Ca(a);Y(this,"\n  ]")}if(0<this.aa.length){for(let b=-1,c=this.aa.length;++b<c;){Y(this,0===b?',\n  "batches": [\n    ':",\n    ");a=this.aa[b];const [d]=jl.ta(a);a=JSON.stringify({count:a.numRows,columns:d},null,2);Y(this,`${a}`);this.Ba.push(new uh(0,0,0))}Y(this,"\n  ]")}this.R&&Y(this,"\n}");this.da=[];this.aa=[];return super.close()}}
function ql(a,b){let c=b;b instanceof oj&&(c=b.batches,a.reset(void 0,b.schema));for(const d of c)a.write(d);return a.finish()}function pl(a,b){return l(function*(){var c;try{for(var d=ia(b);;){var e=yield d.next();if(e.done)break;a.write(e.value)}}catch(g){var f={error:g}}finally{try{e&&!e.done&&(c=d.return)&&(yield c.call(d))}finally{if(f)throw f.error;}}return a.finish()})}
function ul({name:a,type:b,nullable:c}){const d=new il;return{name:a,nullable:c,type:d.visit(b),children:(b.children||[]).map(e=>ul(e)),dictionary:D.isDictionary(b)?{id:b.id,isOrdered:b.isOrdered,indexType:d.visit(b.indices)}:void 0}}function vl(a,b,c=!1){const [d]=jl.ta(new X({[b]:a}));return JSON.stringify({id:b,isDelta:c,data:{count:a.length,columns:d}},null,2)};function wl(a,b){function c(g,k){let m,p,r=g.desiredSize||null;for(;!(p=k.next(e?r:null)).done;)if(ArrayBuffer.isView(p.value)&&(m=u(Uint8Array,p.value))&&(null!=r&&e&&(r=r-m.byteLength+1),p.value=m),g.enqueue(p.value),null!=r&&0>=--r)return;g.close()}let d=null;const e="bytes"===(null==b?void 0:b.type)||!1,f=(null==b?void 0:b.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign({},b,{start(g){c(g,d||(d=a[Symbol.iterator]()))},pull(g){d?c(g,d):g.close()},cancel(){let g;(null==(g=
d)?0:g.return)&&d.return();d=null}}),Object.assign({},{highWaterMark:e?f:void 0},b))}
function xl(a,b){function c(g,k){return l(function*(){let m,p,r=g.desiredSize||null;for(;!(p=yield k.next(e?r:null)).done;)if(ArrayBuffer.isView(p.value)&&(m=u(Uint8Array,p.value))&&(null!=r&&e&&(r=r-m.byteLength+1),p.value=m),g.enqueue(p.value),null!=r&&0>=--r)return;g.close()})}let d=null;const e="bytes"===(null==b?void 0:b.type)||!1,f=(null==b?void 0:b.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign({},b,{start(g){return l(function*(){yield c(g,d||(d=a[Symbol.asyncIterator]()))})},
pull(g){return l(function*(){d?yield c(g,d):g.close()})},cancel(){return l(function*(){let g;(null==(g=d)?0:g.return)&&(yield d.return());d=null})}}),Object.assign({},{highWaterMark:e?f:void 0},b))};function yl(a,b,c){null!=c&&(a.ma>=c.desiredSize&&++a.Sa&&zl(a,c,b.toVector()),b.finished&&((0<b.length||0===a.Sa)&&++a.Sa&&zl(a,c,b.toVector()),!a.nb&&(a.nb=!0)&&zl(a,c,null)))}function zl(a,b,c){a.ma=0;a.na=null;null==c?b.close():b.enqueue(c)}
class Al{constructor(a){this.Sa=0;this.nb=!1;this.ma=0;var b=Object.assign({},a),c=a.readableStrategy,d=a.writableStrategy;a=a.queueingStrategy;a=void 0===a?"count":a;b=(delete b.readableStrategy,delete b.writableStrategy,delete b.queueingStrategy,b);this.na=null;this.ba=$h(b);this.Mb="bytes"!==a?Bl:Cl;({highWaterMark:c="bytes"===a?Math.pow(2,14):1E3}=Object.assign({},c));({highWaterMark:d="bytes"===a?Math.pow(2,14):1E3}=Object.assign({},d));this.readable=new ReadableStream({cancel:()=>{this.ba.clear()},
pull:e=>{yl(this,this.ba,this.na=e)},start:e=>{yl(this,this.ba,this.na=e)}},{highWaterMark:c,size:"bytes"!==a?Bl:Cl});this.writable=new WritableStream({abort:()=>{this.ba.clear()},write:()=>{yl(this,this.ba,this.na)},close:()=>{yl(this,this.ba.finish(),this.na)}},{highWaterMark:d,size:e=>{const f=this.ma;this.ma=this.Mb(this.ba.append(e));return this.ma-f}})}}const Bl=a=>{let b;return null!=(b=null==a?void 0:a.length)?b:0},Cl=a=>{let b;return null!=(b=null==a?void 0:a.byteLength)?b:0};function Dl(a,b){function c(){return l(function*(){return yield(yield Kk.from(e)).open(b)})}function d(k,m){return l(function*(){let p=k.desiredSize,r;for(;!(r=yield m.next()).done;)if(k.enqueue(r.value),null!=p&&0>=--p)return;k.close()})}const e=new Ah;let f=null;const g=new ReadableStream({cancel(){return l(function*(){yield e.close()})},start(k){return l(function*(){yield d(k,f||(f=yield c()))})},pull(k){return l(function*(){f?yield d(k,f):k.close()})}});return{writable:new WritableStream(e,Object.assign({},
{highWaterMark:Math.pow(2,14)},a)),readable:g}};function El(a,b){function c(f){return l(function*(){let g,k=f.desiredSize;for(;g=yield e.read(k||null);)if(f.enqueue(g),null!=k&&0>=(k-=g.byteLength))return;f.close()})}const d=new this(a),e=new Dh(d);b=new ReadableStream({cancel(){return l(function*(){yield e.cancel()})},pull(f){return l(function*(){yield c(f)})},start(f){return l(function*(){yield c(f)})}},Object.assign({},{highWaterMark:Math.pow(2,14)},b));return{writable:new WritableStream(d,a),readable:b}};function Fl(a){a=Kk.from(a);return t(a)&&q(a.then)?a.then(b=>Fl(b)):a.isAsync()?a.readAll().then(b=>new oj(b)):new oj(a.readAll())};const Gl=Object.assign({},pb,Oh,mf,Cd,v,cf,eb,{compareSchemas:dj,compareFields:function(a,b){return aj.compareFields(a,b)},compareTypes:ej});Ka=function(a,b){if(t(a)&&q(a[Symbol.asyncIterator]))return xl(a,b);if(t(a)&&q(a[Symbol.iterator]))return wl(a,b);throw Error("toDOMStream() must be called with an Iterable or AsyncIterable");};Yf.throughDOM=function(a){return new Al(a)};Kk.throughDOM=Dl;Tk.throughDOM=Dl;Lk.throughDOM=Dl;ol.throughDOM=El;sl.throughDOM=El;rl.throughDOM=El;var Z={};Z.AsyncByteQueue=Ah;Z.AsyncByteStream=Dh;Z.AsyncMessageReader=Dk;Z.AsyncRecordBatchFileReader=Uk;Z.AsyncRecordBatchStreamReader=Sk;Z.Binary=Qb;
Z.BinaryBuilder=Th;Z.Bool=Yb;Z.BoolBuilder=Uh;Z.BufferType=bb;Z.Builder=Yf;Z.ByteStream=Bh;Z.Data=H;Z.DataType=D;Z.DateBuilder=Vh;Z.DateDay=jc;Z.DateDayBuilder=Wh;Z.DateMillisecond=kc;Z.DateMillisecondBuilder=Xh;Z.DateUnit=Wa;Z.Date_=fc;Z.Decimal=bc;Z.DecimalBuilder=Yh;Z.DenseUnion=ad;Z.DenseUnionBuilder=Ni;Z.Dictionary=pd;Z.DictionaryBuilder=Zh;Z.Duration=Hc;Z.DurationBuilder=ji;Z.DurationMicrosecond=Nc;Z.DurationMicrosecondBuilder=mi;Z.DurationMillisecond=Mc;Z.DurationMillisecondBuilder=li;
Z.DurationNanosecond=Oc;Z.DurationNanosecondBuilder=ni;Z.DurationSecond=Lc;Z.DurationSecondBuilder=ki;Z.Field=T;Z.FixedSizeBinary=cd;Z.FixedSizeBinaryBuilder=ai;Z.FixedSizeList=gd;Z.FixedSizeListBuilder=bi;Z.Float=Jb;Z.Float16=Nb;Z.Float16Builder=di;Z.Float32=Ob;Z.Float32Builder=ei;Z.Float64=Pb;Z.Float64Builder=fi;Z.FloatBuilder=ci;Z.Int=vb;Z.Int16=Ab;Z.Int16Builder=qi;Z.Int32=Bb;Z.Int32Builder=ri;Z.Int64=Cb;Z.Int64Builder=si;Z.Int8=zb;Z.Int8Builder=pi;Z.IntBuilder=oi;Z.Interval=Bc;
Z.IntervalBuilder=gi;Z.IntervalDayTime=Fc;Z.IntervalDayTimeBuilder=hi;Z.IntervalUnit=Za;Z.IntervalYearMonth=Gc;Z.IntervalYearMonthBuilder=ii;Z.JSONMessageReader=Ek;Z.List=Pc;Z.ListBuilder=xi;Z.MapBuilder=yi;Z.MapRow=Oe;Z.Map_=kd;Z.Message=ck;Z.MessageHeader=Lj;Z.MessageReader=Ck;Z.MetadataVersion=w;Z.Null=ub;Z.NullBuilder=zi;Z.Precision=y;Z.RecordBatch=X;Z.RecordBatchFileReader=Tk;Z.RecordBatchFileWriter=sl;Z.RecordBatchJSONWriter=tl;Z.RecordBatchReader=Kk;Z.RecordBatchStreamReader=Lk;
Z.RecordBatchStreamWriter=rl;Z.RecordBatchWriter=ol;Z.Schema=S;Z.SparseUnion=bd;Z.SparseUnionBuilder=Mi;Z.Struct=Tc;Z.StructBuilder=Ai;Z.StructRow=oe;Z.Table=oj;Z.Time=lc;Z.TimeBuilder=Gi;Z.TimeMicrosecond=rc;Z.TimeMicrosecondBuilder=Ji;Z.TimeMillisecond=qc;Z.TimeMillisecondBuilder=Ii;Z.TimeNanosecond=sc;Z.TimeNanosecondBuilder=Ki;Z.TimeSecond=pc;Z.TimeSecondBuilder=Hi;Z.TimeUnit=z;Z.Timestamp=tc;Z.TimestampBuilder=Bi;Z.TimestampMicrosecond=zc;Z.TimestampMicrosecondBuilder=Ei;
Z.TimestampMillisecond=yc;Z.TimestampMillisecondBuilder=Di;Z.TimestampNanosecond=Ac;Z.TimestampNanosecondBuilder=Fi;Z.TimestampSecond=xc;Z.TimestampSecondBuilder=Ci;Z.Type=B;Z.Uint16=Eb;Z.Uint16Builder=ui;Z.Uint32=Hb;Z.Uint32Builder=vi;Z.Uint64=Ib;Z.Uint64Builder=wi;Z.Uint8=Db;Z.Uint8Builder=ti;Z.Union=Xc;Z.UnionBuilder=Li;Z.UnionMode=x;Z.Utf8=Ub;Z.Utf8Builder=Oi;Z.Vector=F;Z.Visitor=ud;
Z.builderThroughAsyncIterable=function(a){const {queueingStrategy:b="count"}=a,{highWaterMark:c="bytes"!==b?Number.POSITIVE_INFINITY:Math.pow(2,14)}=a,d="bytes"!==b?"length":"byteLength";return function(e){return new oa(function*(){let f=0;const g=$h(a);var k;try{for(var m=ia(e);;){var p=yield new n(2,m.next());if(p.done)break;g.append(p.value)[d]>=c&&++f&&(yield new n(0,g.toVector()))}}catch(R){var r={error:R}}finally{try{p&&!p.done&&(k=m.return)&&(yield new n(2,k.call(m)))}finally{if(r)throw r.error;
}}if(0<g.finish().length||0===f)yield new n(0,g.toVector())}())}};Z.builderThroughIterable=hj;Z.makeBuilder=$h;Z.makeData=I;Z.makeTable=function(a){const b={};a=Object.entries(a);for(const [c,d]of a)b[c]=Of(d);return new oj(b)};Z.makeVector=Of;Z.tableFromArrays=function(a){const b={};a=Object.entries(a);for(const [c,d]of a)b[c]=fj(d);return new oj(b)};Z.tableFromIPC=Fl;Z.tableFromJSON=function(a){a=fj(a);a=new X(new S(a.type.children),a.data[0]);return new oj(a)};
Z.tableToIPC=function(a,b="stream"){return("stream"===b?rl:sl).writeAll(a).toUint8Array(!0)};Z.util=Gl;Z.vectorFromArray=fj;Object.assign(arguments[0],Z);}.bind(this))));

//# sourceMappingURL=Arrow.es2015.min.js.map
